09:35:54.952 [go] Job Started: 2015-11-25 09:35:54 CST

09:35:54.953 [go] Start to prepare Tiger.Core/6289/Smoke-IE-By-Dispatching/4/deploy-regression on WIN-JHPGRBK8N0M [C:\go-agent]
09:35:55.183 [go] Keeping folder pipelines\Tiger.Core\cruise-output
09:35:55.183 [go] Keeping folder pipelines\Tiger.Core\tiger
09:35:55.183 [go] Start to update materials.

09:35:55.183 [go] Start updating tiger at revision 4ecd0193c83202a5c3c626643a9783866244ae06 from git://10.18.8.31/tiger-git
09:35:55.269 [GIT] Fetch and reset in working directory pipelines\Tiger.Core\tiger
09:35:55.269 [GIT] Cleaning all unversioned files in working copy
09:35:55.940 [GIT] Cleaning submodule configurations in .git/config
09:35:55.979 [GIT] Fetching changes
09:35:56.283 [GIT] Performing git gc
09:35:56.301 [GIT] Updating working copy to revision 4ecd0193c83202a5c3c626643a9783866244ae06
09:35:57.423 HEAD is now at 4ecd019 [taotao] #6897 fix 'Reminders' setting section style in IE
09:35:57.427 [GIT] Removing modified files in submodules
09:35:58.358 [GIT] Cleaning all unversioned files in working copy
09:35:58.622 [go] Done.

09:35:59.033 [go] Start to build Tiger.Core/6289/Smoke-IE-By-Dispatching/4/deploy-regression on WIN-JHPGRBK8N0M [C:\go-agent]
09:35:59.033 [go] Current job status: passed.

09:35:59.033 [go] Start to execute task: <fetchartifact pipeline="Tiger.Core" stage="Compile-UT-JT-Package-Stage" job="Package" srcfile="payload/pkgs.txt" dest="tiger/tmp/nupkgs" />.
09:35:59.033 [go] Fetching artifact [payload/pkgs.txt] from [Tiger.Core/6289/Compile-UT-JT-Package-Stage/latest/Package]
09:35:59.052 [go] Artifact is not modified, skipped fetching it
09:35:59.052 [go] Current job status: passed.

09:35:59.052 [go] Start to execute task: <exec command="powershell" args="-file reset-ci-agent.ps1" workingdir="tiger" />.
09:35:59.052 [go] setting environment variable 'GO_SERVER_URL' to value 'https://10.18.7.153:8154/go/'
09:35:59.052 [go] setting environment variable 'GO_TRIGGER_USER' to value 'Tanny619'
09:35:59.052 [go] setting environment variable 'GO_PIPELINE_NAME' to value 'Tiger.Core'
09:35:59.053 [go] setting environment variable 'GO_PIPELINE_COUNTER' to value '6289'
09:35:59.053 [go] setting environment variable 'GO_PIPELINE_LABEL' to value '6289'
09:35:59.053 [go] setting environment variable 'GO_STAGE_NAME' to value 'Smoke-IE-By-Dispatching'
09:35:59.053 [go] setting environment variable 'GO_STAGE_COUNTER' to value '4'
09:35:59.053 [go] setting environment variable 'GO_JOB_NAME' to value 'deploy-regression'
09:35:59.053 [go] setting environment variable 'GO_REVISION_TIGER' to value '4ecd0193c83202a5c3c626643a9783866244ae06'
09:35:59.053 [go] setting environment variable 'GO_TO_REVISION_TIGER' to value '4ecd0193c83202a5c3c626643a9783866244ae06'
09:35:59.053 [go] setting environment variable 'GO_FROM_REVISION_TIGER' to value '0ff50a1fc42d68097a49f23dc52f3d8f4d01232d'
09:35:59.053 [go] setting environment variable 'LC_ALL' to value 'en_US.UTF-8'
09:35:59.053 [go] setting environment variable 'LANG' to value 'en_US.UTF-8'
09:35:59.534 Restarting IIS and SQL Server....
09:36:08.907 
09:36:08.907 Attempting stop...
09:36:08.907 
09:36:08.908 Internet services successfully stopped
09:36:08.908 
09:36:08.908 Attempting start...
09:36:08.908 
09:36:08.908 Internet services successfully restarted
09:36:08.908 
09:36:10.554 Configuring PS Remoting....
09:36:10.753 WinRM is already set up to receive requests on this computer.
09:36:10.779 WinRM is already set up for remote management on this computer.
09:36:26.968 WARNING: The updated configuration might affect the operation of the plugins 
09:36:26.969 having a per plugin quota value greater than 512. Verify the configuration of 
09:36:26.969 all the registered plugins and change the per plugin quota values for the 
09:36:26.970 affected plugins.
09:36:26.976 Disabling IE slow script dialog....
09:36:27.011 Cleaning up temporary deployment directories....
09:36:27.041 Cleaning up previously deployed environments....
09:36:27.148 Start deleting PwCNSBDistributorDaemon
09:36:27.157 Start deleting all web sites except default
09:36:31.461 Start deleting local and int app pools
09:36:38.191 Start drop all db
09:36:38.960 Msg 5058, Level 16, State 5, Server WIN-JHPGRBK8N0M, Line 5
09:36:38.960 Option 'SINGLE_USER' cannot be set in database 'master'.
09:36:38.962 Msg 5058, Level 16, State 4, Server WIN-JHPGRBK8N0M, Line 5
09:36:38.962 Option 'SINGLE_USER' cannot be set in database 'tempdb'.
09:36:38.964 BEGIN TO Drop DB Account-local 5
09:36:38.964 DROP DB [Account-local]
09:36:38.965 BEGIN TO Drop DB Tiger-local 6
09:36:38.965 DROP DB [Tiger-local]
09:36:39.113 drop login [WIN-JHPGRBK8N0M\AccSrv-local]
09:36:39.115 drop login [WIN-JHPGRBK8N0M\IASAccount-local]
09:36:39.117 drop login [WIN-JHPGRBK8N0M\TigerAPI-local]
09:36:39.119 drop login [WIN-JHPGRBK8N0M\MyData-local]
09:36:39.121 drop login [WIN-JHPGRBK8N0M\RespSvc-local]
09:36:41.145 WARNING: Waiting for service 'SQL Server (MSSQLSERVER) (MSSQLSERVER)' to 
09:36:41.146 stop...
09:36:43.146 WARNING: Waiting for service 'SQL Server (MSSQLSERVER) (MSSQLSERVER)' to 
09:36:43.146 stop...
09:36:45.149 WARNING: Waiting for service 'SQL Server (MSSQLSERVER) (MSSQLSERVER)' to 
09:36:45.149 stop...
09:36:47.153 WARNING: Waiting for service 'SQL Server (MSSQLSERVER) (MSSQLSERVER)' to 
09:36:47.153 stop...
09:36:49.788 Start deleting local and int local users
09:36:51.077 clean deployment history
09:36:51.361 Clean ElasticSearch Index....
09:36:51.578 
09:36:51.578 
09:36:51.583 IsMutuallyAuthenticated : False
09:36:51.583 Cookies                 : {}
09:36:51.584 Headers                 : {Access-Control-Allow-Origin, Content-Length, 
09:36:51.584                           Content-Type, Server}
09:36:51.584 SupportsHeaders         : True
09:36:51.584 ContentLength           : 21
09:36:51.584 ContentEncoding         : 
09:36:51.584 ContentType             : application/json; charset=UTF-8
09:36:51.585 CharacterSet            : UTF-8
09:36:51.585 Server                  : Jetty(8.1.14.v20131031)
09:36:51.585 LastModified            : 11/25/2015 9:36:51 AM
09:36:51.585 StatusCode              : OK
09:36:51.585 StatusDescription       : OK
09:36:51.585 ProtocolVersion         : 1.1
09:36:51.586 ResponseUri             : http://localhost:9200/_all
09:36:51.586 Method                  : DELETE
09:36:51.586 IsFromCache             : False
09:36:51.586 
09:36:51.667 Restarting IIS and SQL Server....
09:37:00.969 
09:37:00.970 Attempting stop...
09:37:00.970 
09:37:00.970 Internet services successfully stopped
09:37:00.970 
09:37:00.970 Attempting start...
09:37:00.970 
09:37:00.971 Internet services successfully restarted
09:37:00.971 
09:37:02.093 
09:37:02.095 
09:37:02.227 [go] Current job status: passed.

09:37:02.227 [go] Start to execute task: <exec command="powershell "iisreset"" workingdir="tiger" />.
09:37:02.228 [go] setting environment variable 'GO_SERVER_URL' to value 'https://10.18.7.153:8154/go/'
09:37:02.228 [go] setting environment variable 'GO_TRIGGER_USER' to value 'Tanny619'
09:37:02.228 [go] setting environment variable 'GO_PIPELINE_NAME' to value 'Tiger.Core'
09:37:02.228 [go] setting environment variable 'GO_PIPELINE_COUNTER' to value '6289'
09:37:02.228 [go] setting environment variable 'GO_PIPELINE_LABEL' to value '6289'
09:37:02.229 [go] setting environment variable 'GO_STAGE_NAME' to value 'Smoke-IE-By-Dispatching'
09:37:02.229 [go] setting environment variable 'GO_STAGE_COUNTER' to value '4'
09:37:02.229 [go] setting environment variable 'GO_JOB_NAME' to value 'deploy-regression'
09:37:02.229 [go] setting environment variable 'GO_REVISION_TIGER' to value '4ecd0193c83202a5c3c626643a9783866244ae06'
09:37:02.229 [go] setting environment variable 'GO_TO_REVISION_TIGER' to value '4ecd0193c83202a5c3c626643a9783866244ae06'
09:37:02.229 [go] setting environment variable 'GO_FROM_REVISION_TIGER' to value '0ff50a1fc42d68097a49f23dc52f3d8f4d01232d'
09:37:02.229 [go] setting environment variable 'LC_ALL' to value 'en_US.UTF-8'
09:37:02.229 [go] setting environment variable 'LANG' to value 'en_US.UTF-8'
09:37:11.945 
09:37:11.946 Attempting stop...
09:37:11.946 
09:37:11.946 Internet services successfully stopped
09:37:11.946 
09:37:11.946 Attempting start...
09:37:11.947 
09:37:11.947 Internet services successfully restarted
09:37:11.947 
09:37:11.969 [go] Current job status: passed.

09:37:11.969 [go] Start to execute task: <exec command="powershell" args="powershell -Command "./go.ns.ps1  Deploy-RegressionEnv -env ci"" workingdir="tiger" />.
09:37:11.970 [go] setting environment variable 'GO_SERVER_URL' to value 'https://10.18.7.153:8154/go/'
09:37:11.970 [go] setting environment variable 'GO_TRIGGER_USER' to value 'Tanny619'
09:37:11.970 [go] setting environment variable 'GO_PIPELINE_NAME' to value 'Tiger.Core'
09:37:11.970 [go] setting environment variable 'GO_PIPELINE_COUNTER' to value '6289'
09:37:11.970 [go] setting environment variable 'GO_PIPELINE_LABEL' to value '6289'
09:37:11.970 [go] setting environment variable 'GO_STAGE_NAME' to value 'Smoke-IE-By-Dispatching'
09:37:11.971 [go] setting environment variable 'GO_STAGE_COUNTER' to value '4'
09:37:11.971 [go] setting environment variable 'GO_JOB_NAME' to value 'deploy-regression'
09:37:11.971 [go] setting environment variable 'GO_REVISION_TIGER' to value '4ecd0193c83202a5c3c626643a9783866244ae06'
09:37:11.971 [go] setting environment variable 'GO_TO_REVISION_TIGER' to value '4ecd0193c83202a5c3c626643a9783866244ae06'
09:37:11.971 [go] setting environment variable 'GO_FROM_REVISION_TIGER' to value '0ff50a1fc42d68097a49f23dc52f3d8f4d01232d'
09:37:11.971 [go] setting environment variable 'LC_ALL' to value 'en_US.UTF-8'
09:37:11.971 [go] setting environment variable 'LANG' to value 'en_US.UTF-8'
09:37:13.024 11/25/2015 09:37:13: Downloading package [psake] from [http://10.18.7.148/nuget-libraries-repo] to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets]....
09:37:13.263 Already installed [psake 4.2.0.1]
09:37:13.266 Package [psake] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\psake.4.2.0.1].
09:37:13.388 11/25/2015 09:37:13: Downloading package [NScaffold.NuDeploy] from [http://10.18.7.148/nuget-libraries-repo] to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets]....
09:37:13.626 Already installed [NScaffold.NuDeploy 0.0.115]
09:37:13.628 Package [NScaffold.NuDeploy] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115].
09:37:13.761 11/25/2015 09:37:13: Downloading package [yam] from [http://10.18.7.148/nuget-libraries-repo] to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets]....
09:37:13.977 Already installed [yam 0.0.7.2]
09:37:13.979 Package [yam] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\yam.0.0.7.2].
09:37:14.013 C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\yam.0.0.7.2
09:37:14.071 11/25/2015 09:37:14: Downloading package [xunit.runners] from [http://10.18.7.148/nuget-libraries-repo] to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets]....
09:37:14.294 Already installed [xunit.runners 1.9.2]
09:37:14.295 Package [xunit.runners] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\xunit.runners.1.9.2].
09:37:14.296 C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\xunit.runners.1.9.2
09:37:14.317 11/25/2015 09:37:14: Downloading package [OpenCover] from [http://10.18.7.148/nuget-libraries-repo/] to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets]....
09:37:14.558 Already installed [OpenCover 4.5.3207]
09:37:14.560 Package [OpenCover] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\OpenCover.4.5.3207].
09:37:14.560 C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\OpenCover.4.5.3207
09:37:14.590 11/25/2015 09:37:14: Downloading package [ReportGenerator] from [http://10.18.7.148/nuget-libraries-repo/] to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets]....
09:37:14.832 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\.nuget\nuget.exe install ReportGenerator  -source http://10.18.7.148/nuget-libraries-repo/ -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets -NoCache 2>&1
09:37:15.327 Package [ReportGenerator] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\ReportGenerator.1.9.1.0].
09:37:15.328 C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\ReportGenerator.1.9.1.0
09:37:15.362 11/25/2015 09:37:15: Downloading package [SonarRunner] from [http://10.18.7.148/nuget-libraries-repo] to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets]....
09:37:15.616 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\.nuget\nuget.exe install SonarRunner -version 2.4.0 -source http://10.18.7.148/nuget-libraries-repo -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets -NoCache 2>&1
09:37:15.875 Package [SonarRunner] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\SonarRunner.2.4.0].
09:37:15.876 C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\SonarRunner.2.4.0
09:37:15.927 psake version 4.2.0
09:37:15.927 Copyright (c) 2010 James Kovacs
09:37:15.927 
09:37:16.471 Using cruise pipline label as build number.
09:37:17.011 Executing Deploy-RegressionEnv
09:37:17.203 2015-11-25T09:37:17 Start Install-NuPackage SampleSTS
09:37:17.230 11/25/2015 09:37:17: Downloading package [SampleSTS] from [http://10.18.7.148/nuget-server-tmp] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:37:17.748 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install SampleSTS -version 1.3.6289 -source http://10.18.7.148/nuget-server-tmp -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:37:18.396 Package [SampleSTS] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\SampleSTS.1.3.6289].
09:37:18.414 2015-11-25T09:37:18 Start install.ps1 SampleSTS
09:37:19.467 Microsoft (R) WinHTTP Certificate Configuration Tool
09:37:19.467 Copyright (C) Microsoft Corporation 2001.
09:37:19.467 
09:37:19.467 Matching certificate:
09:37:19.467 CN=selfsts
09:37:19.467 
09:37:19.467 Granting private key access for account:
09:37:19.467     \Everyone
09:37:19.496 Microsoft (R) WinHTTP Certificate Configuration Tool
09:37:19.496 Copyright (C) Microsoft Corporation 2001.
09:37:19.496 
09:37:19.496 Matching certificate:
09:37:19.496 CN=STSTestCert
09:37:19.496 
09:37:19.496 Granting private key access for account:
09:37:19.497     \Everyone
09:37:19.505 features to be installed: [change-hosts-file set-domain-name renew]
09:37:19.544 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\SampleSTS.1.3.6289\tools\deploy-website\renew.ns.ps1] starts
09:37:19.615 
09:37:19.619 
09:37:19.620     Directory: C:\Users\ADMINI~1\AppData\Local\Temp\1
09:37:19.620 
09:37:19.620 
09:37:19.621 Mode                LastWriteTime     Length Name                              
09:37:19.622 ----                -------------     ------ ----                              
09:37:19.624 d----        11/25/2015   9:37 AM            635840410395684140                
09:37:19.624 
09:37:19.625 
09:37:20.219 User [administrator] is ready.
09:37:27.475 Application pool [Sample-STS] is ready.
09:37:29.760 
09:37:29.762 Name             ID   State      Physical Path                  Bindings       
09:37:29.763 ----             --   -----      -------------                  --------       
09:37:29.766 Sample-STS       2    Started    C:\Users\ADMINI~1\AppData\Loca http *:5678:   
09:37:29.766                                  l\Temp\1\635840410395684140                   
09:37:29.766 
09:37:29.766 
09:37:29.771 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\SampleSTS.1.3.6289\tools\deploy-website\renew.ns.ps1] starts
09:37:30.170 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\SampleSTS.1.3.6289\tools\deploy-website\renew.ns.ps1] starts
09:37:31.431 try 1 time to Stop WebApplicationPool [Sample-STS]
09:37:34.493 Stop WebApplicationPool [Sample-STS] successfully.
09:37:34.493 WebAppPool[Sample-STS] stopped
09:37:34.879 try 1 time to Start WebApplicationPool [Sample-STS]
09:37:38.117 Start WebApplicationPool [Sample-STS] successfully.
09:37:38.121 WebAppPool[Sample-STS] started
09:37:38.193 Website [Sample-STS] is ready.
09:37:38.196 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\SampleSTS.1.3.6289\tools\deploy-website\renew.ns.ps1] ends
09:37:38.200 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\SampleSTS.1.3.6289\tools\deploy-website\renew.ns.ps1] ends
09:37:38.214 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\SampleSTS.1.3.6289\tools\deploy-website\renew.ns.ps1] ends
09:37:39.951 2015-11-25T09:37:39 End install.ps1 SampleSTS
09:37:39.953 
09:37:39.954 Name                           Value                                           
09:37:39.954 ----                           -----                                           
09:37:39.955 name                           Sample-STS                                      
09:37:39.957 bindings                       {System.Collections.Hashtable, System.Collect...
09:37:51.482 2015-11-25T09:37:51 Start Install-NuPackage AccountDB
09:37:51.511 11/25/2015 09:37:51: Downloading package [AccountDB] from [http://10.18.7.148/nuget-server-integration] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:37:51.975 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install AccountDB -version 1.0.1.302 -source http://10.18.7.148/nuget-server-integration -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:37:53.005 Package [AccountDB] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\AccountDB.1.0.1.302].
09:37:53.012 2015-11-25T09:37:53 Start install.ps1 AccountDB
09:37:53.276 features to be installed: [restore]
09:37:53.280 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\AccountDB.1.0.1.302\tools\deploy-mssql-database\restore.ns.ps1] starts
09:37:53.287 Clean database
09:37:53.389 Changed database context to 'master'.
09:37:53.476 Create database [Account-local]
09:37:57.896 Dropping index tables...
09:37:57.897 Done
09:37:57.975 -------------------------------------------------------------------------------
09:37:57.975 =============================== FluentMigrator ================================
09:37:57.975 -------------------------------------------------------------------------------
09:37:57.975 Source Code:
09:37:57.975   http://github.com/schambers/fluentmigrator
09:37:57.975 Ask For Help:
09:37:57.975   http://groups.google.com/group/fluentmigrator-google-group
09:37:57.975 -------------------------------------------------------------------------------
09:37:58.036 [+] Using Database SqlServer2008 and Connection String Data Source=localhost;Initial Catalog=Account-local;Integrated Security=True;Connect Timeout=1200;
09:37:58.124 [+] Beginning Transaction
09:37:58.233 -------------------------------------------------------------------------------
09:37:58.234 VersionMigration migrating
09:37:58.234 -------------------------------------------------------------------------------
09:37:58.261 [+] CreateTable VersionInfo
09:37:58.292 [+] VersionMigration migrated
09:37:58.339 -------------------------------------------------------------------------------
09:37:58.339 VersionUniqueMigration migrating
09:37:58.339 -------------------------------------------------------------------------------
09:37:58.356 [+] CreateIndex VersionInfo (Version)
09:37:58.362 [+] AlterTable VersionInfo
09:37:58.365 [+] CreateColumn VersionInfo AppliedOn DateTime
09:37:58.369 [+] VersionUniqueMigration migrated
09:37:58.410 -------------------------------------------------------------------------------
09:37:58.410 20120926170102: R01_MoveVerificationTokenAndPlatformUserStateToSubscription migrating
09:37:58.410 -------------------------------------------------------------------------------
09:37:58.413 [+] AlterTable subscription
09:37:58.414 [+] CreateColumn subscription token Guid
09:37:58.416 [+] ExecuteSqlStatement UPDATE subscription SET token = NEWID() WHERE applicationId = 'mytaxes.pwc.com'
09:37:58.419 [+] ExecuteSqlStatement UPDATE s set s.token = v.token FROM subscription s, verificationinfo v 
09:37:58.419                           WHERE v.platformuserid = s.platformuserid AND s.applicationId = 'mytravel.pwc.com'
09:37:58.422 [+] AlterTable subscription
09:37:58.422 [+] CreateColumn subscription status Int16
09:37:58.423 [+] ExecuteSqlStatement UPDATE subscription SET status = 0 
09:37:58.424                           WHERE platformuserid IN (
09:37:58.424                           SELECT platformuserid
09:37:58.424                           FROM PlatformUserState
09:37:58.424                           WHERE statusClassName LIKE '%invited%' OR statusClassName LIKE '%verified%' 
09:37:58.424                           OR statusClassName LIKE '%registrationLocked%')
09:37:58.429 [+] ExecuteSqlStatement UPDATE subscription SET status = 1
09:37:58.429                           WHERE platformuserid IN (
09:37:58.429                           SELECT platformuserid
09:37:58.429                           FROM PlatformUserState
09:37:58.430                           WHERE statusClassName LIKE '%started%' OR statusClassName LIKE '%softlocked%'
09:37:58.430                           OR statusClassName LIKE '%unlocking%' OR statusClassName LIKE '%hardlocked%')
09:37:58.434 [+] 20120926170102: R01_MoveVerificationTokenAndPlatformUserStateToSubscription migrated
09:37:58.451 -------------------------------------------------------------------------------
09:37:58.451 20121009112410: R02_CreateProfileAndPreferenceTable migrating
09:37:58.451 -------------------------------------------------------------------------------
09:37:58.452 [+] ExecuteSqlStatement CREATE TABLE Profile ([Id] [uniqueidentifier] primary key,
09:37:58.452                           [PlatformUserId] [uniqueidentifier] unique NOT NULL,
09:37:58.452                           [LastModified] datetimeoffset not null,
09:37:58.452                           [ModifiedBy] nvarchar(128) null)
09:37:58.454 [+] ExecuteSqlStatement ALTER TABLE [Profile] WITH CHECK ADD CONSTRAINT [FK_Profile_PlatformUser] FOREIGN KEY([PlatformUserId]) REFERENCES [PlatformUser] ([Id])
09:37:58.455 [+] ExecuteSqlStatement CREATE TABLE ProfileItem (
09:37:58.455                           [Id] [uniqueidentifier] primary key,
09:37:58.455                           [ProfileId] [uniqueidentifier] NOT NULL,
09:37:58.455                           [ItemKey] nvarchar(512) not null,
09:37:58.455                           [ItemValue] nvarchar(512) not null,
09:37:58.456                           [LastModified] datetimeoffset not null,
09:37:58.456                           [ModifiedBy] nvarchar(128) null)
09:37:58.457 [+] ExecuteSqlStatement ALTER TABLE [ProfileItem] WITH CHECK ADD CONSTRAINT [FK_ProfileItem_Profile] FOREIGN KEY([ProfileId]) REFERENCES [Profile] ([Id])
09:37:58.458 [+] ExecuteSqlStatement CREATE TABLE Preference ([Id] [uniqueidentifier] primary key,
09:37:58.458                           [PlatformUserId] [uniqueidentifier] unique NOT NULL,
09:37:58.458                           [LastModified] datetimeoffset not null,
09:37:58.458                           [ModifiedBy] nvarchar(128) null)
09:37:58.460 [+] ExecuteSqlStatement ALTER TABLE [Preference] WITH CHECK ADD CONSTRAINT [FK_Preference_PlatformUser] FOREIGN KEY([PlatformUserId]) REFERENCES [PlatformUser] ([Id])
09:37:58.461 [+] ExecuteSqlStatement CREATE TABLE PreferenceItem (
09:37:58.461                           [Id] [uniqueidentifier] primary key,
09:37:58.461                           [PreferenceId] [uniqueidentifier] NOT NULL,
09:37:58.462                           [ItemKey] nvarchar(512) not null,
09:37:58.462                           [ItemValue] nvarchar(512) not null,
09:37:58.462                           [LastModified] datetimeoffset not null,
09:37:58.462                           [ModifiedBy] nvarchar(128) null)
09:37:58.463 [+] ExecuteSqlStatement ALTER TABLE [PreferenceItem] WITH CHECK ADD CONSTRAINT [FK_PreferenceItem_Preference] FOREIGN KEY([PreferenceId]) REFERENCES [Preference] ([Id])
09:37:58.464 [+] 20121009112410: R02_CreateProfileAndPreferenceTable migrated
09:37:58.465 -------------------------------------------------------------------------------
09:37:58.465 20121009153810: R03_CopyAccountSettingsDataToProfileAndPreferenceTable migrating
09:37:58.465 -------------------------------------------------------------------------------
09:37:58.468 [+] ExecuteSqlStatement SELECT * INTO #tmp FROM (
09:37:58.468                           SELECT a.PlatformUserId, i.ItemKey, i.ItemValue, i.LastModified, i.ModifiedBy FROM AccountSettingItem i INNER JOIN AccountSettings a ON i.AccountSettingsId = a.Id
09:37:58.468                           UNION
09:37:58.468                           SELECT a.PlatformUserId, i.Question, i.Answer,i.LastModified, i.ModifiedBy   FROM VerificationQuestion i INNER JOIN VerificationInfo a ON i.VerificationInfoId = a.Id) t
09:37:58.490 [+] ExecuteSqlStatement SELECT * INTO #preference FROM (
09:37:58.490                           SELECT newid() AS Id , PlatformUserId, getdate() AS LastModified, '' AS ModifiedBy FROM #tmp GROUP BY platformuserid) pre
09:37:58.498 [+] ExecuteSqlStatement INSERT INTO Preference SELECT * FROM #preference
09:37:58.504 [+] ExecuteSqlStatement INSERT INTO PreferenceItem SELECT newid() AS Id, #preference.Id AS PreferenceId, #tmp.ItemKey, #tmp.ItemValue, #tmp.LastModified, #tmp.ModifiedBy FROM #tmp INNER JOIN #preference ON #tmp.PlatformUserId = #preference.PlatformUserId WHERE ItemKey IN ('Culture', 'Currency', 'DateFormat', 'NumberFormat', 'TimeFormat', 'TimeZone')
09:37:58.519 [+] ExecuteSqlStatement SELECT * INTO #profile FROM (
09:37:58.519                           SELECT newid() AS Id , PlatformUserId, getdate() AS LastModified, '' AS ModifiedBy FROM #tmp GROUP BY platformuserid) pro
09:37:58.524 [+] ExecuteSqlStatement INSERT INTO [Profile] SELECT * FROM #profile
09:37:58.530 [+] ExecuteSqlStatement INSERT INTO ProfileItem SELECT newid() AS Id, #profile.Id AS ProfileId, #tmp.ItemKey, #tmp.ItemValue, #tmp.LastModified, #tmp.ModifiedBy FROM #tmp INNER JOIN #profile ON #tmp.PlatformUserId = #profile.PlatformUserId where ItemKey NOT IN ('Culture', 'Currency', 'DateFormat', 'NumberFormat', 'TimeFormat', 'TimeZone', 'email')
09:37:58.541 [+] ExecuteSqlStatement DROP TABLE #tmp
09:37:58.545 [+] ExecuteSqlStatement DROP TABLE #preference
09:37:58.548 [+] ExecuteSqlStatement DROP TABLE #profile
09:37:58.552 [+] 20121009153810: R03_CopyAccountSettingsDataToProfileAndPreferenceTable migrated
09:37:58.554 -------------------------------------------------------------------------------
09:37:58.554 20121009165810: R04_RenameAcountSettingsChangedHistoryTable migrating
09:37:58.554 -------------------------------------------------------------------------------
09:37:58.555 [+] ExecuteSqlStatement sp_rename 'AccountSettingsChangedHistory', 'UserDataChangedHistory'
09:37:58.705 [+] ExecuteSqlStatement sp_rename N'UserDataChangedHistory.idx_AccountSettingsChangedHistory_ModifiedBy', N'idx_UserDataChangedHistory_ModifiedBy', N'INDEX'
09:37:58.712 [+] ExecuteSqlStatement sp_rename N'UserDataChangedHistory.idx_AccountSettingsChangedHistory_ChangedTime', N'idx_UserDataChangedHistory_ChangedTime', N'INDEX'
09:37:58.715 [+] 20121009165810: R04_RenameAcountSettingsChangedHistoryTable migrated
09:37:58.718 -------------------------------------------------------------------------------
09:37:58.718 20121010174310: R05_DeleteAccountSettingsAndAccountSettingsItemTable migrating
09:37:58.718 -------------------------------------------------------------------------------
09:37:58.725 [+] DeleteTable AccountSettingItem
09:37:58.734 [+] DeleteTable AccountSettings
09:37:58.739 [+] 20121010174310: R05_DeleteAccountSettingsAndAccountSettingsItemTable migrated
09:37:58.741 -------------------------------------------------------------------------------
09:37:58.741 20121016103823: R06_DeleteVerificationInfoAndVerificationQuestionsTable migrating
09:37:58.741 -------------------------------------------------------------------------------
09:37:58.743 [+] DeleteTable VerificationQuestion
09:37:58.747 [+] DeleteTable VerificationInfo
09:37:58.753 [+] 20121016103823: R06_DeleteVerificationInfoAndVerificationQuestionsTable migrated
09:37:58.755 -------------------------------------------------------------------------------
09:37:58.755 20121018170102: R07_UserState migrating
09:37:58.755 -------------------------------------------------------------------------------
09:37:58.759 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassData = '{"VerificationFailedTimes":'+StatusClassData+',"Verified":false}' WHERE statusClassName LIKE '%Invited%' OR statusClassName LIKE '%Verified%'
09:37:58.765 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassName = 'Inactive' WHERE StatusClassName LIKE '%Invited%'
09:37:58.772 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassName = 'Inactive' WHERE StatusClassName LIKE '%Verified%'
09:37:58.780 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassName = 'Activated' WHERE StatusClassName LIKE '%Started%'
09:37:58.785 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassName = 'SoftLocked' WHERE StatusClassName LIKE '%SoftLocked%'
09:37:58.790 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassName = 'HardLocked' WHERE StatusClassName LIKE '%HardLocked%'
09:37:58.795 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassName = 'Inactive, ' WHERE StatusClassName LIKE '%Unlocking%'
09:37:58.799 [+] ExecuteSqlStatement UPDATE PlatformUserState SET StatusClassName = 'HardLocked' WHERE StatusClassName LIKE '%RegistrationLocked%'
09:37:58.804 [+] 20121018170102: R07_UserState migrated
09:37:58.806 -------------------------------------------------------------------------------
09:37:58.806 20130305162747: R08_UserActivity migrating
09:37:58.807 -------------------------------------------------------------------------------
09:37:58.809 [+] ExecuteSqlStatement CREATE TABLE UserActivity ([Id] [uniqueidentifier] primary key,
09:37:58.809                           [PlatformUserId] [uniqueidentifier] NOT NULL,
09:37:58.809                           [ActivityType] [nvarchar](512) NOT NULL,
09:37:58.809                           [LastModified] datetimeoffset not null,
09:37:58.809                           [ModifiedBy] nvarchar(128) null)
09:37:58.829 [+] 20130305162747: R08_UserActivity migrated
09:37:58.832 -------------------------------------------------------------------------------
09:37:58.832 20131112142100: R09_USITAccount migrating
09:37:58.833 -------------------------------------------------------------------------------
09:37:58.838 [+] ExecuteSqlStatement CREATE TABLE USITAccount(
09:37:58.839   [Id] [uniqueidentifier] primary key,
09:37:58.839   [PlatformUserId] [uniqueidentifier] unique NOT NULL,
09:37:58.839   [GoId] int unique not null,
09:37:58.840   [LastModified] datetimeoffset not null,
09:37:58.840   [ModifiedBy] nvarchar(128) null,
09:37:58.841 )
09:37:58.847 [+] 20131112142100: R09_USITAccount migrated
09:37:58.849 -------------------------------------------------------------------------------
09:37:58.850 20131116202100: R10_USITCredential migrating
09:37:58.850 -------------------------------------------------------------------------------
09:37:58.851 [+] ExecuteSqlStatement CREATE TABLE USITCredential(
09:37:58.852   [UserName] varchar(64) primary key,
09:37:58.852   [Password] varchar(64) unique NOT NULL
09:37:58.852 )
09:37:58.856 [+] ExecuteSqlStatement Insert Into USITCredential values('rackspace','rackspace123#')
09:37:58.860 [+] 20131116202100: R10_USITCredential migrated
09:37:58.862 -------------------------------------------------------------------------------
09:37:58.862 20140117164206: R11_AddProfileIdIndexToProfileItem migrating
09:37:58.862 -------------------------------------------------------------------------------
09:37:58.866 [+] CreateIndex ProfileItem (ProfileId)
09:37:58.869 [+] 20140117164206: R11_AddProfileIdIndexToProfileItem migrated
09:37:58.871 -------------------------------------------------------------------------------
09:37:58.871 20140120112420: R12_AddPreferenceIdIndexToPreferenceItem migrating
09:37:58.871 -------------------------------------------------------------------------------
09:37:58.872 [+] CreateIndex PreferenceItem (PreferenceId)
09:37:58.876 [+] 20140120112420: R12_AddPreferenceIdIndexToPreferenceItem migrated
09:37:58.878 -------------------------------------------------------------------------------
09:37:58.878 20140611140500: R13_AddMyMobilitySubscriptionTable migrating
09:37:58.878 -------------------------------------------------------------------------------
09:37:58.879 [+] ExecuteSqlStatement CREATE TABLE MyMobilitySubscription (
09:37:58.879                           [Id] uniqueidentifier primary key,
09:37:58.879                           [ClientUri] nvarchar(max) NOT NULL,
09:37:58.880                           [ApplicationId] nvarchar(128) NOT NULL)
09:37:58.883 [+] 20140611140500: R13_AddMyMobilitySubscriptionTable migrated
09:37:58.885 -------------------------------------------------------------------------------
09:37:58.885 20140611150101: R14_AddMyMobilityClientUserTable migrating
09:37:58.885 -------------------------------------------------------------------------------
09:37:58.887 [+] ExecuteSqlStatement CREATE TABLE MyMobilityClientUser (
09:37:58.887                           [Id] uniqueidentifier primary key,
09:37:58.887                           [ClientUri] nvarchar(max) NOT NULL,
09:37:58.887                           [UserEmail] nvarchar(512) NOT NULL)
09:37:58.891 [+] 20140611150101: R14_AddMyMobilityClientUserTable migrated
09:37:58.893 -------------------------------------------------------------------------------
09:37:58.893 20140623102700: R15_AddRoleForMyMobilityClientUser migrating
09:37:58.894 -------------------------------------------------------------------------------
09:37:58.909 [+] CreateColumn MyMobilityClientUser Role String
09:37:58.916 [+] 20140623102700: R15_AddRoleForMyMobilityClientUser migrated
09:37:58.919 -------------------------------------------------------------------------------
09:37:58.919 20140624000000: R16_UpdateAuthenticationQuestionAnswersAsSaltedHash migrating
09:37:58.919 -------------------------------------------------------------------------------
09:37:58.925 [+] PerformDBOperation 
09:37:58.930 [+] Performing DB Operation
09:37:58.940 [+] 20140624000000: R16_UpdateAuthenticationQuestionAnswersAsSaltedHash migrated
09:37:58.942 -------------------------------------------------------------------------------
09:37:58.942 20140626000000: R17_MigrateMyVisasUsersToGlobalUserNameTable migrating
09:37:58.942 -------------------------------------------------------------------------------
09:37:58.943 [+] ExecuteSqlStatement INSERT INTO [GlobalUserName] ([Id],[Name],[LastModified],[ModifiedBy])
09:37:58.944                           SELECT newid(), c.username, getutcdate(), 'myAccount'
09:37:58.944                           FROM [Credential] c JOIN
09:37:58.944                           [Subscription] s ON c.[PlatformUserId] = s.[PlatformUserId]
09:37:58.944                           WHERE applicationid = 'myVisas'
09:37:58.944                           AND c.username NOT IN (select name from [GlobalUserName])
09:37:58.957 [+] 20140626000000: R17_MigrateMyVisasUsersToGlobalUserNameTable migrated
09:37:58.959 -------------------------------------------------------------------------------
09:37:58.960 20140702110000: R18_DropUniqueApplicationIdOnMyMobilitySubscriptionTable migrating
09:37:58.960 -------------------------------------------------------------------------------
09:37:58.961 [+] ExecuteSqlStatement DECLARE @ConstraintName NVARCHAR(MAX);
09:37:58.961                           SELECT @ConstraintName = name FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[MyMobilitySubscription]') AND name LIKE N'U%';
09:37:58.962                           IF (@ConstraintName IS NOT NULL)
09:37:58.962                             EXEC('ALTER TABLE [dbo].[MyMobilitySubscription] DROP CONSTRAINT ' + @ConstraintName);
09:37:58.962                           GO
09:37:58.977 [+] 20140702110000: R18_DropUniqueApplicationIdOnMyMobilitySubscriptionTable migrated
09:37:58.978 -------------------------------------------------------------------------------
09:37:58.978 20140702120000: R19_AddFirstMyMobilityAdmin migrating
09:37:58.978 -------------------------------------------------------------------------------
09:37:58.994 [+] -> 4 Insert operations completed in 00:00:00.0039060 taking an average of 00:00:00.0009765
09:37:58.995 [+] 20140702120000: R19_AddFirstMyMobilityAdmin migrated
09:37:58.996 -------------------------------------------------------------------------------
09:37:58.996 20140828113820: R20_AddPlatformUserIdIndexToCredential migrating
09:37:58.996 -------------------------------------------------------------------------------
09:37:58.997 [+] CreateIndex Credential (PlatformUserId)
09:37:58.998 [+] 20140828113820: R20_AddPlatformUserIdIndexToCredential migrated
09:37:58.999 -------------------------------------------------------------------------------
09:37:58.999 20140829103700: R21_AddTableMyMobilityEngagementUser migrating
09:37:58.999 -------------------------------------------------------------------------------
09:37:59.000 [+] ExecuteSqlStatement 
09:37:59.000             CREATE TABLE [dbo].[MyMobilityEngagementUser](
09:37:59.000 	            [Id] [uniqueidentifier] NOT NULL,
09:37:59.000 	            [EngagementUris] [nvarchar](max) NOT NULL,
09:37:59.000 	            [UserEmail] [nvarchar](512) NOT NULL,
09:37:59.000             PRIMARY KEY CLUSTERED 
09:37:59.000             (
09:37:59.000 	            [Id] ASC
09:37:59.000             ))
09:37:59.000             
09:37:59.001 [+] 20140829103700: R21_AddTableMyMobilityEngagementUser migrated
09:37:59.003 -------------------------------------------------------------------------------
09:37:59.003 20141010170400: R22_RestructureMyMobilityTables migrating
09:37:59.003 -------------------------------------------------------------------------------
09:37:59.016 [+] CreateTable MyMobilityUser
09:37:59.019 [+] CreateTable MyMobilityEngagementAssociation
09:37:59.023 [+] CreateForeignKey FK_UserEmail_MyMobilityUser MyMobilityEngagementAssociation(UserEmail) MyMobilityUser(UserEmail)
09:37:59.035 [+] RenameColumn MyMobilitySubscription ClientUri to EngagementUri
09:37:59.039 [+] DeleteTable MyMobilityEngagementUser
09:37:59.041 [+] DeleteTable MyMobilityClientUser
09:37:59.043 [+] 20141010170400: R22_RestructureMyMobilityTables migrated
09:37:59.044 -------------------------------------------------------------------------------
09:37:59.044 20141014153700: R23_AddMyMobilityTileTable migrating
09:37:59.044 -------------------------------------------------------------------------------
09:37:59.046 [+] CreateTable MyMobilityTile
09:37:59.048 [+] 20141014153700: R23_AddMyMobilityTileTable migrated
09:37:59.049 -------------------------------------------------------------------------------
09:37:59.049 20141020152800: R24_PopulateMyMobilityTileTable migrating
09:37:59.049 -------------------------------------------------------------------------------
09:37:59.061 [+] -> 9 Insert operations completed in 00:00:00.0048825 taking an average of 00:00:00.0005425
09:37:59.061 [+] 20141020152800: R24_PopulateMyMobilityTileTable migrated
09:37:59.062 -------------------------------------------------------------------------------
09:37:59.063 20141107092600: R25_PopulateEmployeeListTile migrating
09:37:59.063 -------------------------------------------------------------------------------
09:37:59.075 [+] FluentMigrator.Expressions.DeleteDataExpression
09:37:59.084 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:37:59.085 [+] 20141107092600: R25_PopulateEmployeeListTile migrated
09:37:59.087 -------------------------------------------------------------------------------
09:37:59.087 20141204154800: R26_AddProfileAvatarTable migrating
09:37:59.087 -------------------------------------------------------------------------------
09:37:59.088 [+] ExecuteSqlStatement CREATE TABLE ProfileAvatar (
09:37:59.089                           [Id] [uniqueidentifier] primary key,
09:37:59.089                           [PlatformUserId] [uniqueidentifier] NOT NULL,
09:37:59.089                           [ImageContent] image not null,
09:37:59.089                           [LastModified] datetimeoffset not null,
09:37:59.089                           [ModifiedBy] nvarchar(128) null)
09:37:59.232 [+] ExecuteSqlStatement ALTER TABLE [ProfileAvatar] WITH CHECK ADD CONSTRAINT [FK_ProfileAvatar_PlatformUser] FOREIGN KEY([PlatformUserId]) REFERENCES [PlatformUser] ([Id])
09:37:59.235 [+] 20141204154800: R26_AddProfileAvatarTable migrated
09:37:59.236 -------------------------------------------------------------------------------
09:37:59.236 20141215130000: R27_DropMyMobilityTables migrating
09:37:59.237 -------------------------------------------------------------------------------
09:37:59.237 [+] 20141215130000: R27_DropMyMobilityTables migrated
09:37:59.238 -------------------------------------------------------------------------------
09:37:59.238 20150108145700: R28_AddPublicProfileUrlToProfileAvatarTable migrating
09:37:59.238 -------------------------------------------------------------------------------
09:37:59.242 [+] CreateColumn ProfileAvatar PublicProfileUrl String
09:37:59.246 [+] 20150108145700: R28_AddPublicProfileUrlToProfileAvatarTable migrated
09:37:59.246 -------------------------------------------------------------------------------
09:37:59.247 20150609161000: R29_AddUniqueConstraintToProfileItemTable migrating
09:37:59.247 -------------------------------------------------------------------------------
09:37:59.253 [+] AlterTable ProfileItem
09:37:59.258 [+] AlterColumn ProfileItem ItemKey String
09:37:59.270 [+] ExecuteSqlStatement IF NOT EXISTS( SELECT * FROM sys.objects WHERE name = 'UQ_ProfileItem_ProfileID_ItemKey' AND type = 'UQ' )
09:37:59.270                           BEGIN
09:37:59.270 	                        ALTER TABLE [ProfileItem] ADD CONSTRAINT [UQ_ProfileItem_ProfileID_ItemKey] UNIQUE NONCLUSTERED 
09:37:59.270 	                        (
09:37:59.271                                 [ProfileId] ASC,
09:37:59.271 		                        [ItemKey] ASC
09:37:59.271 	                        ) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
09:37:59.271                           END
09:37:59.282 [+] 20150609161000: R29_AddUniqueConstraintToProfileItemTable migrated
09:37:59.285 -------------------------------------------------------------------------------
09:37:59.285 20150706171200: R30_AddGuidsToTableVariableUserDefinedFunction migrating
09:37:59.285 -------------------------------------------------------------------------------
09:37:59.286 [+] ExecuteSqlStatement 
09:37:59.286                 CREATE function [dbo].[guidsToTableVariable](@xml xml)
09:37:59.287                 returns @result table(Id uniqueidentifier primary key)
09:37:59.287                 as
09:37:59.287                 begin
09:37:59.287 	                insert into @result(Id)
09:37:59.287 	                select list.Id.value('(text())[1]', 'uniqueidentifier')
09:37:59.287 	                from @xml.nodes('//guid') as list(Id)
09:37:59.287 	                option (optimize for (@xml = NULL))
09:37:59.288 	                return 
09:37:59.288                 end
09:37:59.288             
09:37:59.296 [+] 20150706171200: R30_AddGuidsToTableVariableUserDefinedFunction migrated
09:37:59.300 -------------------------------------------------------------------------------
09:37:59.300 20150724112300: R31_RemoveGuidsToTableVariableUserDefinedFunction migrating
09:37:59.300 -------------------------------------------------------------------------------
09:37:59.301 [+] ExecuteSqlStatement DROP function [dbo].[guidsToTableVariable]
09:37:59.305 [+] 20150724112300: R31_RemoveGuidsToTableVariableUserDefinedFunction migrated
09:37:59.306 -------------------------------------------------------------------------------
09:37:59.306 20151008161100: R32_CreateProxyTable migrating
09:37:59.307 -------------------------------------------------------------------------------
09:37:59.309 [+] ExecuteSqlStatement CREATE TABLE [Proxy] (
09:37:59.309                 [Id] [uniqueidentifier] primary key,
09:37:59.309                 [PlatformUserId] [uniqueidentifier] NOT NULL,
09:37:59.309                 [ApplicationId] nvarchar(128) not null,
09:37:59.309                 [LastModified] datetimeoffset not null,
09:37:59.310                 [ModifiedBy] nvarchar(128) null)
09:37:59.312 [+] ExecuteSqlStatement ALTER TABLE [Proxy] WITH CHECK ADD CONSTRAINT [FK_Proxy_PlatformUser] FOREIGN KEY([PlatformUserId]) REFERENCES [PlatformUser] ([Id])
09:37:59.316 [+] CreateIndex Proxy (PlatformUserId)
09:37:59.319 [+] 20151008161100: R32_CreateProxyTable migrated
09:37:59.321 -------------------------------------------------------------------------------
09:37:59.321 20151013102800: R33_CreatePinCodeTable migrating
09:37:59.321 -------------------------------------------------------------------------------
09:37:59.323 [+] ExecuteSqlStatement CREATE TABLE [PinCode] (
09:37:59.323                 [Id] [uniqueidentifier] primary key,
09:37:59.324                 [PlatformUserId] [uniqueidentifier] not null,
09:37:59.324                 [EncryptedPinCode] nvarchar(512) not null,
09:37:59.324                 [ExpiredAt] datetimeoffset not null,
09:37:59.324                 [LastModified] datetimeoffset not null,
09:37:59.324                 [ModifiedBy] nvarchar(128) null)
09:37:59.327 [+] ExecuteSqlStatement ALTER TABLE [PinCode] WITH CHECK ADD CONSTRAINT [FK_PinCode_PlatformUser] FOREIGN KEY([PlatformUserId]) REFERENCES [PlatformUser] ([Id])
09:37:59.330 [+] CreateIndex PinCode (PlatformUserId)
09:37:59.333 [+] 20151013102800: R33_CreatePinCodeTable migrated
09:37:59.335 -------------------------------------------------------------------------------
09:37:59.335 20151014154400: R34_CreateProxyAsAssigneeTable migrating
09:37:59.335 -------------------------------------------------------------------------------
09:37:59.337 [+] ExecuteSqlStatement CREATE TABLE [ProxyAsAssignee] (
09:37:59.337                 [Id] [uniqueidentifier] primary key,
09:37:59.337                 [AssigneePlatformUserId] [uniqueidentifier] not null,
09:37:59.337                 [ProxyPlatformUserId] [uniqueidentifier] not null,
09:37:59.338                 [LastLoginTime] datetimeoffset not null,
09:37:59.338                 [Permission] int not null,
09:37:59.338                 [LastModified] datetimeoffset not null,
09:37:59.338                 [ModifiedBy] nvarchar(128) null)
09:37:59.341 [+] CreateIndex ProxyAsAssignee (AssigneePlatformUserId)
09:37:59.344 [+] CreateIndex ProxyAsAssignee (ProxyPlatformUserId)
09:37:59.347 [+] 20151014154400: R34_CreateProxyAsAssigneeTable migrated
09:37:59.349 -------------------------------------------------------------------------------
09:37:59.350 20151020164400: R35_CreateConfigurationTable migrating
09:37:59.350 -------------------------------------------------------------------------------
09:37:59.352 [+] CreateTable Configuration
09:37:59.359 [+] 20151020164400: R35_CreateConfigurationTable migrated
09:37:59.363 -------------------------------------------------------------------------------
09:37:59.363 20151020165400: R36_InsertPinCodeExpiryTimeToConfiguration migrating
09:37:59.363 -------------------------------------------------------------------------------
09:37:59.370 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:37:59.371 [+] 20151020165400: R36_InsertPinCodeExpiryTimeToConfiguration migrated
09:37:59.373 -------------------------------------------------------------------------------
09:37:59.373 20151022114300: R37_InsertPinCodeConfiguration migrating
09:37:59.373 -------------------------------------------------------------------------------
09:37:59.376 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:37:59.377 [+] 20151022114300: R37_InsertPinCodeConfiguration migrated
09:37:59.379 -------------------------------------------------------------------------------
09:37:59.379 20151026183000: R38_CreatePinCodeLogTable migrating
09:37:59.379 -------------------------------------------------------------------------------
09:37:59.385 [+] CreateTable PinCodeLog
09:37:59.392 [+] 20151026183000: R38_CreatePinCodeLogTable migrated
09:37:59.394 -------------------------------------------------------------------------------
09:37:59.394 20151039172800: R39_AddVoiceCallBasicAuthConfiguration migrating
09:37:59.394 -------------------------------------------------------------------------------
09:37:59.396 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:37:59.397 [+] 20151039172800: R39_AddVoiceCallBasicAuthConfiguration migrated
09:37:59.399 -------------------------------------------------------------------------------
09:37:59.399 20151104114000: R40_UpdatePinCodeHttpAuthColumn migrating
09:37:59.399 -------------------------------------------------------------------------------
09:37:59.414 [+] UpdateData 
09:37:59.426 [+] 20151104114000: R40_UpdatePinCodeHttpAuthColumn migrated
09:37:59.430 [+] Committing Transaction
09:37:59.435 [+] Task completed.
09:38:00.971 Processing DB user access
09:38:01.528 Changed database context to 'master'.
09:38:01.632 Changed database context to 'Account-local'.
09:38:01.686 Changed database context to 'Account-local'.
09:38:02.186 Changed database context to 'master'.
09:38:02.271 Changed database context to 'Account-local'.
09:38:02.352 Changed database context to 'Account-local'.
09:38:02.378 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\AccountDB.1.0.1.302\tools\deploy-mssql-database\restore.ns.ps1] ends
09:38:02.392 2015-11-25T09:38:02 End install.ps1 AccountDB
09:38:02.395 server                         localhost                                       
09:38:02.396 dbName                         Account-local                                   
09:38:03.215 2015-11-25T09:38:03 Start Install-NuPackage Account-service
09:38:03.240 11/25/2015 09:38:03: Downloading package [Account-service] from [http://10.18.7.148/nuget-server-integration] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:38:03.728 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install Account-service -version 1.0.1.302 -source http://10.18.7.148/nuget-server-integration -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:38:04.362 Package [Account-service] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\Account-service.1.0.1.302].
09:38:04.366 2015-11-25T09:38:04 Start install.ps1 Account-service
09:38:04.674 features to be installed: [renew]
09:38:04.679 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\Account-service.1.0.1.302\tools\deploy-website\renew.ns.ps1] starts
09:38:04.692 
09:38:04.692 
09:38:04.693     Directory: C:\Users\ADMINI~1\AppData\Local\Temp\1
09:38:04.693 
09:38:04.693 
09:38:04.694 Mode                LastWriteTime     Length Name                              
09:38:04.695 ----                -------------     ------ ----                              
09:38:04.696 d----        11/25/2015   9:38 AM            635840410846836905                
09:38:04.696 
09:38:04.696 
09:38:06.444 User [AccSrv-local] is ready.
09:38:09.104 Application pool [AccountService-local] is ready.
09:38:12.007 
09:38:12.011 Name             ID   State      Physical Path                  Bindings       
09:38:12.013 ----             --   -----      -------------                  --------       
09:38:12.034 AccountService-l 3    Started    C:\Users\ADMINI~1\AppData\Loca http *:10710:  
09:38:12.034 ocal                             l\Temp\1\635840410846836905                   
09:38:12.035 
09:38:12.035 
09:38:31.835 Website [AccountService-local] is ready.
09:38:31.844 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\Account-service.1.0.1.302\tools\deploy-website\renew.ns.ps1] ends
09:38:34.551 2015-11-25T09:38:34 End install.ps1 Account-service
09:38:34.553 name                           AccountService-local                            
09:38:34.555 bindings                       {protocol, bindingInformation}                  
09:38:35.067 2015-11-25T09:38:35 Start Install-NuPackage ResponsibilityService
09:38:35.093 11/25/2015 09:38:35: Downloading package [ResponsibilityService] from [http://10.18.7.148/nuget-server-integration] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:38:35.562 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install ResponsibilityService -version 1.3.82 -source http://10.18.7.148/nuget-server-integration -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:38:36.275 Package [ResponsibilityService] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\ResponsibilityService.1.3.82].
09:38:36.285 2015-11-25T09:38:36 Start install.ps1 ResponsibilityService
09:38:36.590 applyConfig starts.
09:38:36.643 applyConfig ends.
09:38:36.644 features to be installed: [renew]
09:38:36.676 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\ResponsibilityService.1.3.82\tools\deploy-website\renew.ns.ps1] starts
09:38:36.715 
09:38:36.716 
09:38:36.717     Directory: C:\Users\ADMINI~1\AppData\Local\Temp\1
09:38:36.718 
09:38:36.718 
09:38:36.720 Mode                LastWriteTime     Length Name                              
09:38:36.722 ----                -------------     ------ ----                              
09:38:36.724 d----        11/25/2015   9:38 AM            635840411166875015                
09:38:36.725 
09:38:36.725 
09:38:38.963 User [RespSvc-local] is ready.
09:38:42.128 Application pool [RespSvc-local] is ready.
09:38:44.657 
09:38:44.661 Name             ID   State      Physical Path                  Bindings       
09:38:44.663 ----             --   -----      -------------                  --------       
09:38:44.669 RespSvc-local    4    Started    C:\Users\ADMINI~1\AppData\Loca http *:15010:  
09:38:44.669                                  l\Temp\1\635840411166875015                   
09:38:44.670 
09:38:44.670 
09:38:45.983 try 1 time to Stop WebApplicationPool [RespSvc-local]
09:38:49.114 Stop WebApplicationPool [RespSvc-local] successfully.
09:38:49.118 WebAppPool[RespSvc-local] stopped
09:38:49.305 try 1 time to Start WebApplicationPool [RespSvc-local]
09:38:52.759 Start WebApplicationPool [RespSvc-local] successfully.
09:38:52.762 WebAppPool[RespSvc-local] started
09:38:52.961 Website [RespSvc-local] is ready.
09:38:52.972 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\ResponsibilityService.1.3.82\tools\deploy-website\renew.ns.ps1] ends
09:38:56.094 2015-11-25T09:38:56 End install.ps1 ResponsibilityService
09:38:56.096 name                           RespSvc-local                                   
09:38:56.097 bindings                       {protocol, bindingInformation}                  
09:38:56.191 2015-11-25T09:38:56 Start Install-NuPackage TigerDB
09:38:56.222 11/25/2015 09:38:56: Downloading package [TigerDB] from [http://10.18.7.148/nuget-server-tmp] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:38:56.706 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install TigerDB -version 1.3.6289 -source http://10.18.7.148/nuget-server-tmp -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:38:57.412 Package [TigerDB] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerDB.1.3.6289].
09:38:57.425 2015-11-25T09:38:57 Start install.ps1 TigerDB
09:38:57.688 features to be installed: [restore database-options]
09:38:57.692 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerDB.1.3.6289\tools\deploy-mssql-database\database-options.ns.ps1] starts
09:38:57.699 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerDB.1.3.6289\tools\deploy-mssql-database\database-options.ns.ps1] starts
09:38:57.704 Clean database
09:38:57.763 Changed database context to 'master'.
09:38:57.818 Create database [Tiger-local]
09:39:00.089 No baseline schema. Restore baseline skiped.
09:39:00.133 -------------------------------------------------------------------------------
09:39:00.134 =============================== FluentMigrator ================================
09:39:00.134 -------------------------------------------------------------------------------
09:39:00.134 Source Code:
09:39:00.134   http://github.com/schambers/fluentmigrator
09:39:00.134 Ask For Help:
09:39:00.134   http://groups.google.com/group/fluentmigrator-google-group
09:39:00.134 -------------------------------------------------------------------------------
09:39:00.214 [+] Using Database SqlServer2008 and Connection String Data Source=localhost;Initial Catalog=Tiger-local;Integrated Security=True;
09:39:00.320 -------------------------------------------------------------------------------
09:39:00.320 VersionMigration migrating
09:39:00.320 -------------------------------------------------------------------------------
09:39:00.322 [+] Beginning Transaction
09:39:00.335 [+] CreateTable VersionInfo
09:39:00.348 [+] Committing Transaction
09:39:00.349 [+] VersionMigration migrated
09:39:00.370 -------------------------------------------------------------------------------
09:39:00.370 VersionUniqueMigration migrating
09:39:00.371 -------------------------------------------------------------------------------
09:39:00.371 [+] Beginning Transaction
09:39:00.383 [+] CreateIndex VersionInfo (Version)
09:39:00.386 [+] AlterTable VersionInfo
09:39:00.387 [+] CreateColumn VersionInfo AppliedOn DateTime
09:39:00.390 [+] Committing Transaction
09:39:00.390 [+] VersionUniqueMigration migrated
09:39:00.487 -------------------------------------------------------------------------------
09:39:00.487 1: AddCountriesTable migrating
09:39:00.487 -------------------------------------------------------------------------------
09:39:00.488 [+] Beginning Transaction
09:39:00.490 [+] CreateTable countries
09:39:00.506 [+] Committing Transaction
09:39:00.507 [+] 1: AddCountriesTable migrated
09:39:00.508 -------------------------------------------------------------------------------
09:39:00.508 2: AddOfficesTable migrating
09:39:00.508 -------------------------------------------------------------------------------
09:39:00.508 [+] Beginning Transaction
09:39:00.510 [+] CreateTable offices
09:39:00.512 [+] Committing Transaction
09:39:00.513 [+] 2: AddOfficesTable migrated
09:39:00.513 -------------------------------------------------------------------------------
09:39:00.513 3: AddStaffsTable migrating
09:39:00.513 -------------------------------------------------------------------------------
09:39:00.514 [+] Beginning Transaction
09:39:00.515 [+] CreateTable staff
09:39:00.573 [+] Committing Transaction
09:39:00.573 [+] 3: AddStaffsTable migrated
09:39:00.573 -------------------------------------------------------------------------------
09:39:00.574 4: AddEngagementsTable migrating
09:39:00.574 -------------------------------------------------------------------------------
09:39:00.574 [+] Beginning Transaction
09:39:00.575 [+] CreateTable engagements
09:39:00.578 [+] Committing Transaction
09:39:00.580 [+] 4: AddEngagementsTable migrated
09:39:00.580 -------------------------------------------------------------------------------
09:39:00.580 5: AddAssigneesTable migrating
09:39:00.580 -------------------------------------------------------------------------------
09:39:00.580 [+] Beginning Transaction
09:39:00.583 [+] CreateTable assignees
09:39:00.585 [+] CreateIndex assignees (primary_email)
09:39:00.586 [+] CreateIndex assignees (secondary_email)
09:39:00.587 [+] ExecuteSqlStatement CREATE NONCLUSTERED INDEX assignee_engagement ON assignees ([engagement_id])INCLUDE ([id],[first_name],[last_name])
09:39:00.589 [+] Committing Transaction
09:39:00.589 [+] 5: AddAssigneesTable migrated
09:39:00.589 -------------------------------------------------------------------------------
09:39:00.589 6: AddWorkRecordsTable migrating
09:39:00.589 -------------------------------------------------------------------------------
09:39:00.589 [+] Beginning Transaction
09:39:00.592 [+] CreateTable work_records
09:39:00.593 [+] CreateIndex work_records (primary_service_id, assignee_id)
09:39:00.595 [+] CreateIndex work_records (current_milestone_id)
09:39:00.596 [+] CreateIndex work_records (current_milestone_name)
09:39:00.596 [+] CreateIndex work_records (responsible_office_id)
09:39:00.597 [+] ExecuteSqlStatement CREATE NONCLUSTERED INDEX tax_year_record_type ON [dbo].[work_records] ([tax_year],[practice_type]) INCLUDE ([id],[assignee_id])
09:39:00.598 [+] CreateIndex work_records (id)
09:39:00.600 [+] Committing Transaction
09:39:00.601 [+] 6: AddWorkRecordsTable migrated
09:39:00.601 -------------------------------------------------------------------------------
09:39:00.601 7: AddPassportsTable migrating
09:39:00.601 -------------------------------------------------------------------------------
09:39:00.601 [+] Beginning Transaction
09:39:00.601 [+] CreateTable passports
09:39:00.603 [+] Committing Transaction
09:39:00.604 [+] 7: AddPassportsTable migrated
09:39:00.605 -------------------------------------------------------------------------------
09:39:00.605 8: AddFamilyMembersTable migrating
09:39:00.605 -------------------------------------------------------------------------------
09:39:00.605 [+] Beginning Transaction
09:39:00.606 [+] CreateTable family_members
09:39:00.607 [+] Committing Transaction
09:39:00.608 [+] 8: AddFamilyMembersTable migrated
09:39:00.609 -------------------------------------------------------------------------------
09:39:00.609 9: AddAssignmentsTable migrating
09:39:00.609 -------------------------------------------------------------------------------
09:39:00.609 [+] Beginning Transaction
09:39:00.610 [+] CreateTable assignments
09:39:00.611 [+] CreateIndex assignments (assignee_id)
09:39:00.613 [+] Committing Transaction
09:39:00.613 [+] 9: AddAssignmentsTable migrated
09:39:00.614 -------------------------------------------------------------------------------
09:39:00.614 10: AddEngagedOfficesTable migrating
09:39:00.614 -------------------------------------------------------------------------------
09:39:00.614 [+] Beginning Transaction
09:39:00.615 [+] CreateTable engaged_offices
09:39:00.616 [+] Committing Transaction
09:39:00.617 [+] 10: AddEngagedOfficesTable migrated
09:39:00.618 -------------------------------------------------------------------------------
09:39:00.618 11: AddEngagedOfficesStaffsTable migrating
09:39:00.618 -------------------------------------------------------------------------------
09:39:00.618 [+] Beginning Transaction
09:39:00.619 [+] CreateTable engaged_office_staff
09:39:00.620 [+] Committing Transaction
09:39:00.621 [+] 11: AddEngagedOfficesStaffsTable migrated
09:39:00.621 -------------------------------------------------------------------------------
09:39:00.622 12: AddTypesOfServiceTable migrating
09:39:00.622 -------------------------------------------------------------------------------
09:39:00.622 [+] Beginning Transaction
09:39:00.623 [+] CreateTable types_of_service
09:39:00.624 [+] Committing Transaction
09:39:00.625 [+] 12: AddTypesOfServiceTable migrated
09:39:00.626 -------------------------------------------------------------------------------
09:39:00.626 13: AddUsersTable migrating
09:39:00.626 -------------------------------------------------------------------------------
09:39:00.626 [+] Beginning Transaction
09:39:00.626 [+] CreateTable users
09:39:00.628 [+] Committing Transaction
09:39:00.629 [+] 13: AddUsersTable migrated
09:39:00.630 -------------------------------------------------------------------------------
09:39:00.631 14: AddMilestonesTable migrating
09:39:00.631 -------------------------------------------------------------------------------
09:39:00.631 [+] Beginning Transaction
09:39:00.639 [+] CreateTable milestones
09:39:00.642 [+] CreateIndex milestones (work_record_id, responsible_office_id)
09:39:00.645 [+] CreateIndex milestones (responsibility_id)
09:39:00.648 [+] CreateIndex milestones (id)
09:39:00.651 [+] Committing Transaction
09:39:00.653 [+] 14: AddMilestonesTable migrated
09:39:00.654 -------------------------------------------------------------------------------
09:39:00.655 15: AddTimezonesTable migrating
09:39:00.655 -------------------------------------------------------------------------------
09:39:00.655 [+] Beginning Transaction
09:39:00.661 [+] CreateTable timezones
09:39:00.665 [+] CreateIndex timezones (name)
09:39:00.668 [+] Committing Transaction
09:39:00.671 [+] 15: AddTimezonesTable migrated
09:39:00.672 -------------------------------------------------------------------------------
09:39:00.672 16: AddQuestionnaireSetTable migrating
09:39:00.672 -------------------------------------------------------------------------------
09:39:00.673 [+] Beginning Transaction
09:39:00.675 [+] CreateTable questionnaire_set
09:39:00.679 [+] Committing Transaction
09:39:00.681 [+] 16: AddQuestionnaireSetTable migrated
09:39:00.682 -------------------------------------------------------------------------------
09:39:00.683 17: AddRebuildIndexProcedure migrating
09:39:00.683 -------------------------------------------------------------------------------
09:39:00.683 [+] Beginning Transaction
09:39:00.684 [+] ExecuteSqlStatement 
09:39:00.684 SET ANSI_NULLS ON
09:39:00.684 GO
09:39:00.684 
09:39:00.684 SET QUOTED_IDENTIFIER ON
09:39:00.684 GO
09:39:00.684 
09:39:00.685 CREATE PROCEDURE [rebuild_indexes]
09:39:00.685 AS
09:39:00.685 BEGIN
09:39:00.685 	SET NOCOUNT ON;
09:39:00.685 
09:39:00.685 	DECLARE @objectid int;
09:39:00.686 	DECLARE @indexid int;
09:39:00.686 	DECLARE @partitioncount bigint;
09:39:00.686 	DECLARE @schemaname nvarchar(130);
09:39:00.686 	DECLARE @objectname nvarchar(130);
09:39:00.686 	DECLARE @indexname nvarchar(130);
09:39:00.686 	DECLARE @partitionnum bigint;
09:39:00.686 	DECLARE @partitions bigint;
09:39:00.687 	DECLARE @frag float;
09:39:00.687 	DECLARE @command nvarchar(4000);
09:39:00.687 	DECLARE @dbid smallint;
09:39:00.687 
09:39:00.687 	-- Conditionally select tables and indexes from the sys.dm_db_index_physical_stats function
09:39:00.687 	-- and convert object and index IDs to names.
09:39:00.688 
09:39:00.688 	PRINT N'start ';
09:39:00.688 
09:39:00.688 	SET @dbid = DB_ID();
09:39:00.688 	SELECT
09:39:00.688 		[object_id] AS objectid,
09:39:00.688 		index_id AS indexid,
09:39:00.689 		partition_number AS partitionnum,
09:39:00.689 		avg_fragmentation_in_percent AS frag, page_count
09:39:00.689 	INTO #work_to_do
09:39:00.689 	FROM sys.dm_db_index_physical_stats (@dbid, NULL, NULL , NULL, N'LIMITED')
09:39:00.689 	WHERE avg_fragmentation_in_percent > 10.0  -- Allow limited fragmentation
09:39:00.689 	AND index_id > 0 -- Ignore heaps
09:39:00.690 	AND page_count > 25; -- Ignore small tables
09:39:00.690 
09:39:00.690 	-- Declare the cursor for the list of partitions to be processed.
09:39:00.690 	DECLARE partitions CURSOR FOR SELECT objectid,indexid, partitionnum,frag FROM #work_to_do;
09:39:00.690 	-- Open the cursor.
09:39:00.690 	OPEN partitions;
09:39:00.690 
09:39:00.691 	-- Loop through the partitions.
09:39:00.691 	WHILE (1=1)
09:39:00.691 	BEGIN
09:39:00.691 		FETCH NEXT
09:39:00.691 		FROM partitions
09:39:00.691 		INTO @objectid, @indexid, @partitionnum, @frag;
09:39:00.691 
09:39:00.692 		IF @@FETCH_STATUS < 0
09:39:00.692 		BEGIN	
09:39:00.692 			PRINT N'Rebuild Finished.';
09:39:00.692 			BREAK;
09:39:00.692 		END
09:39:00.692 			
09:39:00.692 		SELECT @objectname = QUOTENAME(o.name), @schemaname = QUOTENAME(s.name)
09:39:00.693 		FROM sys.objects AS o
09:39:00.693 		JOIN sys.schemas as s ON s.schema_id = o.schema_id
09:39:00.693 		WHERE o.object_id = @objectid;
09:39:00.693 		
09:39:00.693 		SELECT @indexname = QUOTENAME(name)
09:39:00.693 		FROM sys.indexes
09:39:00.693 		WHERE object_id = @objectid AND index_id = @indexid;
09:39:00.694 
09:39:00.694 		SELECT @partitioncount = count (*)
09:39:00.694 		FROM sys.partitions
09:39:00.694 		WHERE object_id = @objectid AND index_id = @indexid;
09:39:00.694 
09:39:00.694 		-- 30 is an arbitrary decision point at which to switch between reorganizing and rebuilding.
09:39:00.694 		IF @frag < 30.0
09:39:00.694 		SET @command = N'ALTER INDEX ' + @indexname + N' ON ' + @schemaname + N'.' + @objectname + N' REORGANIZE';
09:39:00.695 		IF @frag >= 30.0
09:39:00.695 		SET @command = N'ALTER INDEX ' + @indexname + N' ON ' + @schemaname + N'.' + @objectname + N' REBUILD';
09:39:00.695 		IF @partitioncount > 1
09:39:00.695 		SET @command = @command + N' PARTITION=' + CAST(@partitionnum AS nvarchar(10));
09:39:00.695 
09:39:00.695 		EXEC (@command);
09:39:00.695 
09:39:00.696 		PRINT N'Executed: ' + @command;
09:39:00.696 	END
09:39:00.696 
09:39:00.696 	-- Close and deallocate the cursor.
09:39:00.696 	CLOSE partitions;
09:39:00.696 
09:39:00.696 	DEALLOCATE partitions;
09:39:00.696 	-- Drop the temporary table.
09:39:00.696 	DROP TABLE #work_to_do;
09:39:00.696 END
09:39:00.696 GO	
09:39:00.696 
09:39:00.756 [+] Committing Transaction
09:39:00.758 [+] 17: AddRebuildIndexProcedure migrated
09:39:00.759 -------------------------------------------------------------------------------
09:39:00.759 18: AddAssigneesContactsTable migrating
09:39:00.759 -------------------------------------------------------------------------------
09:39:00.760 [+] Beginning Transaction
09:39:00.762 [+] CreateTable assignee_contact
09:39:00.771 [+] Committing Transaction
09:39:00.773 [+] 18: AddAssigneesContactsTable migrated
09:39:00.774 -------------------------------------------------------------------------------
09:39:00.774 19: AddHistoryItemTable migrating
09:39:00.775 -------------------------------------------------------------------------------
09:39:00.775 [+] Beginning Transaction
09:39:00.777 [+] CreateTable history_item
09:39:00.782 [+] Committing Transaction
09:39:00.784 [+] 19: AddHistoryItemTable migrated
09:39:00.785 -------------------------------------------------------------------------------
09:39:00.786 20: RenameQuestionnaireSet migrating
09:39:00.786 -------------------------------------------------------------------------------
09:39:00.786 [+] Beginning Transaction
09:39:00.799 [+] RenameTable questionnaire_set question_sets
09:39:00.898 [+] RenameColumn work_records questionnaire_set_id to question_set_id
09:39:00.903 [+] Committing Transaction
09:39:00.905 [+] 20: RenameQuestionnaireSet migrated
09:39:00.908 -------------------------------------------------------------------------------
09:39:00.908 21: SaperateFamilyMemberDependentNameToFirstNameAndLastName migrating
09:39:00.908 -------------------------------------------------------------------------------
09:39:00.908 [+] Beginning Transaction
09:39:00.913 [+] AlterTable family_members
09:39:00.915 [+] CreateColumn family_members first_name String
09:39:00.918 [+] CreateColumn family_members last_name String
09:39:00.920 [+] ExecuteSqlStatement update family_members 
09:39:00.921                 set first_name = CASE 
09:39:00.921 	                                WHEN CHARINDEX( ',', dependent_name)>0 THEN substring( dependent_name,charindex(',', dependent_name)+1,DATALENGTH(dependent_name) ) 
09:39:00.921                                     WHEN CHARINDEX(' ', dependent_name)>0 THEN substring( dependent_name,0,CHARINDEX(' ', dependent_name) )       
09:39:00.921                                     Else dependent_name
09:39:00.921                                  END, 
09:39:00.921                 last_name = CASE 
09:39:00.921                                WHEN CHARINDEX( ',', dependent_name)>0 THEN substring( dependent_name,0,CHARINDEX( ',', dependent_name) ) 
09:39:00.921                                WHEN CHARINDEX(' ', dependent_name)>0 THEN substring( dependent_name, charindex(' ', dependent_name)+1,DATALENGTH(dependent_name)  )       
09:39:00.921                                Else dependent_name
09:39:00.921                             END
09:39:00.923 [+] DeleteColumn family_members dependent_name
09:39:00.953 [+] Committing Transaction
09:39:00.954 [+] 21: SaperateFamilyMemberDependentNameToFirstNameAndLastName migrated
09:39:00.954 -------------------------------------------------------------------------------
09:39:00.955 22: AddMissingItemsTable migrating
09:39:00.955 -------------------------------------------------------------------------------
09:39:00.955 [+] Beginning Transaction
09:39:00.956 [+] CreateTable missing_items
09:39:00.959 [+] Committing Transaction
09:39:00.960 [+] 22: AddMissingItemsTable migrated
09:39:00.961 -------------------------------------------------------------------------------
09:39:00.961 23: RemoveStatusForStaff migrating
09:39:00.961 -------------------------------------------------------------------------------
09:39:00.961 [+] Beginning Transaction
09:39:00.962 [+] DeleteColumn staff status
09:39:00.975 [+] Committing Transaction
09:39:00.976 [+] 23: RemoveStatusForStaff migrated
09:39:00.976 -------------------------------------------------------------------------------
09:39:00.976 24: RemoveFixedFeeFromWorkRecord migrating
09:39:00.976 -------------------------------------------------------------------------------
09:39:00.976 [+] Beginning Transaction
09:39:00.977 [+] DeleteColumn work_records fixed_fee_amount
09:39:00.985 [+] DeleteColumn work_records fixed_fee_currency
09:39:00.995 [+] Committing Transaction
09:39:00.996 [+] 24: RemoveFixedFeeFromWorkRecord migrated
09:39:00.997 -------------------------------------------------------------------------------
09:39:00.997 25: AddReceivedStatusForMissingItem migrating
09:39:00.997 -------------------------------------------------------------------------------
09:39:00.997 [+] Beginning Transaction
09:39:01.002 [+] CreateColumn missing_items received Boolean
09:39:01.006 [+] Committing Transaction
09:39:01.008 [+] 25: AddReceivedStatusForMissingItem migrated
09:39:01.010 -------------------------------------------------------------------------------
09:39:01.010 26: AddEngagmentIDForWorkRecord migrating
09:39:01.010 -------------------------------------------------------------------------------
09:39:01.011 [+] Beginning Transaction
09:39:01.018 [+] AlterColumn work_records assignee_id Int64
09:39:01.031 [+] AlterColumn work_records primary_service_id Int64
09:39:01.033 [+] CreateColumn work_records engagement_id Int64
09:39:01.037 [+] Committing Transaction
09:39:01.039 [+] 26: AddEngagmentIDForWorkRecord migrated
09:39:01.040 -------------------------------------------------------------------------------
09:39:01.040 27: ExtractQuestionnaireFromWorkRecord migrating
09:39:01.040 -------------------------------------------------------------------------------
09:39:01.041 [+] Beginning Transaction
09:39:01.045 [+] CreateColumn work_records has_questionnaire Boolean
09:39:01.049 [+] ExecuteSqlStatement UPDATE work_records SET has_questionnaire = 1 WHERE question_set_id IS NOT NULL
09:39:01.054 [+] CreateTable questionnaire
09:39:01.058 [+] ExecuteSqlStatement INSERT INTO questionnaire (work_record_id, contact_id, question_set_id, due_date) 
09:39:01.058                             SELECT id, contact_id, question_set_id, due_date FROM work_records WHERE has_questionnaire = 1
09:39:01.061 [+] DeleteColumn work_records contact_id
09:39:01.079 [+] DeleteColumn work_records question_set_id
09:39:01.094 [+] DeleteColumn work_records due_date
09:39:01.102 [+] Committing Transaction
09:39:01.104 [+] 27: ExtractQuestionnaireFromWorkRecord migrated
09:39:01.105 -------------------------------------------------------------------------------
09:39:01.105 28: RemoveQsIdAddQsUriFromWorkRecord migrating
09:39:01.105 -------------------------------------------------------------------------------
09:39:01.105 [+] Beginning Transaction
09:39:01.107 [+] DeleteColumn questionnaire question_set_id
09:39:01.116 [+] CreateColumn questionnaire question_set_uri String
09:39:01.118 [+] Committing Transaction
09:39:01.120 [+] 28: RemoveQsIdAddQsUriFromWorkRecord migrated
09:39:01.121 -------------------------------------------------------------------------------
09:39:01.122 29: RemoveQuestionSetTable migrating
09:39:01.122 -------------------------------------------------------------------------------
09:39:01.122 [+] Beginning Transaction
09:39:01.126 [+] DeleteTable question_sets
09:39:01.133 [+] Committing Transaction
09:39:01.134 [+] 29: RemoveQuestionSetTable migrated
09:39:01.136 -------------------------------------------------------------------------------
09:39:01.136 30: AddColActivationStatusToQuestionnaire migrating
09:39:01.136 -------------------------------------------------------------------------------
09:39:01.136 [+] Beginning Transaction
09:39:01.138 [+] CreateColumn questionnaire activation_status Int32
09:39:01.141 [+] ExecuteSqlStatement UPDATE q SET q.activation_status = (CASE WHEN current_milestone_name = 'Record Created' THEN 1 ELSE 3 END) 
09:39:01.141                             FROM work_records wr INNER JOIN questionnaire q ON wr.id = q.work_record_id
09:39:01.150 [+] Committing Transaction
09:39:01.165 [+] 30: AddColActivationStatusToQuestionnaire migrated
09:39:01.166 -------------------------------------------------------------------------------
09:39:01.166 31: AddTargetTypeToTypeOfService migrating
09:39:01.167 -------------------------------------------------------------------------------
09:39:01.167 [+] Beginning Transaction
09:39:01.167 [+] AlterColumn types_of_service country_id Int64
09:39:01.168 [+] CreateColumn types_of_service target_type Int32
09:39:01.174 [+] Committing Transaction
09:39:01.176 [+] 31: AddTargetTypeToTypeOfService migrated
09:39:01.178 -------------------------------------------------------------------------------
09:39:01.178 33: RemoveIsTaxReturn migrating
09:39:01.179 -------------------------------------------------------------------------------
09:39:01.180 [+] Beginning Transaction
09:39:01.181 [+] DeleteColumn work_records is_tax_return
09:39:01.194 [+] Committing Transaction
09:39:01.196 [+] 33: RemoveIsTaxReturn migrated
09:39:01.196 -------------------------------------------------------------------------------
09:39:01.196 34: ChangeQuestionSetUriToQuestionSetId migrating
09:39:01.196 -------------------------------------------------------------------------------
09:39:01.197 [+] Beginning Transaction
09:39:01.198 [+] DeleteColumn questionnaire question_set_uri
09:39:01.205 [+] CreateColumn questionnaire question_set_id Guid
09:39:01.209 [+] Committing Transaction
09:39:01.212 [+] 34: ChangeQuestionSetUriToQuestionSetId migrated
09:39:01.213 -------------------------------------------------------------------------------
09:39:01.213 35: AddQuestionaireIdToQuestionnaire migrating
09:39:01.213 -------------------------------------------------------------------------------
09:39:01.214 [+] Beginning Transaction
09:39:01.216 [+] DeleteColumn questionnaire activation_status
09:39:01.231 [+] CreateColumn questionnaire questionnaire_id Guid
09:39:01.234 [+] Committing Transaction
09:39:01.236 [+] 35: AddQuestionaireIdToQuestionnaire migrated
09:39:01.237 -------------------------------------------------------------------------------
09:39:01.238 36: AddCompositeSearchIndexToWorkRecord migrating
09:39:01.238 -------------------------------------------------------------------------------
09:39:01.238 [+] Beginning Transaction
09:39:01.240 [+] CreateIndex work_records (tax_year, practice_type, engagement_id, assignee_id)
09:39:01.243 [+] Committing Transaction
09:39:01.245 [+] 36: AddCompositeSearchIndexToWorkRecord migrated
09:39:01.247 -------------------------------------------------------------------------------
09:39:01.247 37: RemoveCreatedAtColumnFromWorkRecord migrating
09:39:01.247 -------------------------------------------------------------------------------
09:39:01.248 [+] Beginning Transaction
09:39:01.250 [+] DeleteColumn work_records created_at
09:39:01.264 [+] Committing Transaction
09:39:01.265 [+] 37: RemoveCreatedAtColumnFromWorkRecord migrated
09:39:01.265 -------------------------------------------------------------------------------
09:39:01.265 38: AddIndexResponsibilityIdDateToMilestones migrating
09:39:01.265 -------------------------------------------------------------------------------
09:39:01.265 [+] Beginning Transaction
09:39:01.266 [+] CreateIndex milestones (responsibility_id, date)
09:39:01.267 [+] CreateIndex work_records (assignee_id)
09:39:01.269 [+] DeleteIndex milestones ()
09:39:01.270 [+] ExecuteSqlStatement CREATE NONCLUSTERED INDEX [milestone_responsibility_id] ON [dbo].[milestones](	[responsibility_id] ASC) INCLUDE ([id])
09:39:01.273 [+] Committing Transaction
09:39:01.275 [+] 38: AddIndexResponsibilityIdDateToMilestones migrated
09:39:01.275 -------------------------------------------------------------------------------
09:39:01.275 39: ChangeCountryToCountryIdInAssignees migrating
09:39:01.275 -------------------------------------------------------------------------------
09:39:01.275 [+] Beginning Transaction
09:39:01.276 [+] AlterTable assignees
09:39:01.277 [+] AlterColumn assignees country Int64
09:39:01.279 [+] RenameColumn assignees country to country_id
09:39:01.281 [+] Committing Transaction
09:39:01.282 [+] 39: ChangeCountryToCountryIdInAssignees migrated
09:39:01.283 -------------------------------------------------------------------------------
09:39:01.283 40: AddActivationErrorMsgToQuestionnaire migrating
09:39:01.283 -------------------------------------------------------------------------------
09:39:01.283 [+] Beginning Transaction
09:39:01.289 [+] AlterTable questionnaire
09:39:01.291 [+] CreateColumn questionnaire activation_error_type String
09:39:01.295 [+] Committing Transaction
09:39:01.297 [+] 40: AddActivationErrorMsgToQuestionnaire migrated
09:39:01.298 -------------------------------------------------------------------------------
09:39:01.299 41: AddLastModifierTypeInOrganizerMileStone migrating
09:39:01.299 -------------------------------------------------------------------------------
09:39:01.299 [+] Beginning Transaction
09:39:01.301 [+] AlterTable milestones
09:39:01.302 [+] CreateColumn milestones last_modifier_type String
09:39:01.305 [+] ExecuteSqlStatement UPDATE milestones SET last_modifier_type = 'staff' WHERE last_modifier_id is not null
09:39:01.310 [+] Committing Transaction
09:39:01.312 [+] 41: AddLastModifierTypeInOrganizerMileStone migrated
09:39:01.313 -------------------------------------------------------------------------------
09:39:01.313 42: AddModifierTypeInHistoryItemMileStone migrating
09:39:01.313 -------------------------------------------------------------------------------
09:39:01.313 [+] Beginning Transaction
09:39:01.316 [+] DeleteColumn history_item staff_id
09:39:01.332 [+] AlterTable history_item
09:39:01.333 [+] CreateColumn history_item modifier_id Int64
09:39:01.334 [+] AlterTable history_item
09:39:01.334 [+] CreateColumn history_item modifier_type String
09:39:01.335 [+] ExecuteSqlStatement UPDATE history_item SET modifier_type = 'staff' WHERE modifier_id is not null
09:39:01.337 [+] Committing Transaction
09:39:01.338 [+] 42: AddModifierTypeInHistoryItemMileStone migrated
09:39:01.339 -------------------------------------------------------------------------------
09:39:01.339 43: AlterInteractingSystemToIntInTableMilestones migrating
09:39:01.339 -------------------------------------------------------------------------------
09:39:01.339 [+] Beginning Transaction
09:39:01.340 [+] AlterTable milestones
09:39:01.340 [+] CreateColumn milestones temp Int32
09:39:01.341 [+] ExecuteSqlStatement UPDATE milestones SET temp = 0 WHERE interacting_system = 'Tiger'
09:39:01.344 [+] DeleteColumn milestones interacting_system
09:39:01.355 [+] ExecuteSqlStatement sys.sp_rename @objname = N'[milestones].temp', @newname = 'interacting_system', @objtype = 'COLUMN'
09:39:01.358 [+] Committing Transaction
09:39:01.360 [+] 43: AlterInteractingSystemToIntInTableMilestones migrated
09:39:01.360 -------------------------------------------------------------------------------
09:39:01.361 44: AddIndexTaxContaxtToWorkRecord migrating
09:39:01.361 -------------------------------------------------------------------------------
09:39:01.361 [+] Beginning Transaction
09:39:01.362 [+] ExecuteSqlStatement CREATE NONCLUSTERED INDEX [record_type_assignee_id_current_milestone_name]ON [dbo].[work_records] ([practice_type],[assignee_id],[current_milestone_name])INCLUDE ([id],[primary_service_id])
09:39:01.365 [+] Committing Transaction
09:39:01.367 [+] 44: AddIndexTaxContaxtToWorkRecord migrated
09:39:01.368 -------------------------------------------------------------------------------
09:39:01.368 45: ChangePKofQuestionnaireToWorkRecordId migrating
09:39:01.369 -------------------------------------------------------------------------------
09:39:01.369 [+] Beginning Transaction
09:39:01.372 [+] ExecuteSqlStatement 
09:39:01.372                 IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[questionnaire]') AND name = N'PK_questionnaire')
09:39:01.373                 ALTER TABLE [dbo].[questionnaire] DROP CONSTRAINT [PK_questionnaire]
09:39:01.373             
09:39:01.384 [+] AlterColumn questionnaire work_record_id Int64
09:39:01.389 [+] ExecuteSqlStatement 
09:39:01.389                 ALTER TABLE [dbo].[questionnaire] ADD  CONSTRAINT [PK_questionnaire] PRIMARY KEY CLUSTERED 
09:39:01.389                 (
09:39:01.389 	                [work_record_id] ASC
09:39:01.390                 )WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON)
09:39:01.390             
09:39:01.393 [+] DeleteColumn questionnaire id
09:39:01.412 [+] Committing Transaction
09:39:01.414 [+] 45: ChangePKofQuestionnaireToWorkRecordId migrated
09:39:01.419 -------------------------------------------------------------------------------
09:39:01.419 46: CreateActiveQuestionnaireFailedEmail migrating
09:39:01.420 -------------------------------------------------------------------------------
09:39:01.421 [+] Beginning Transaction
09:39:01.424 [+] CreateTable activate_questionnaire_failed_email
09:39:01.428 [+] Committing Transaction
09:39:01.430 [+] 46: CreateActiveQuestionnaireFailedEmail migrated
09:39:01.431 -------------------------------------------------------------------------------
09:39:01.431 47: AddEstimatedCompletionDateInWorkRecord migrating
09:39:01.432 -------------------------------------------------------------------------------
09:39:01.432 [+] Beginning Transaction
09:39:01.433 [+] AlterTable work_records
09:39:01.434 [+] CreateColumn work_records estimated_completion_date 
09:39:01.438 [+] Committing Transaction
09:39:01.440 [+] 47: AddEstimatedCompletionDateInWorkRecord migrated
09:39:01.441 -------------------------------------------------------------------------------
09:39:01.441 48: AddConfirmedUnsignedConsentTable migrating
09:39:01.441 -------------------------------------------------------------------------------
09:39:01.442 [+] Beginning Transaction
09:39:01.443 [+] CreateTable confirmed_unsigned_consent
09:39:01.448 [+] Committing Transaction
09:39:01.450 [+] 48: AddConfirmedUnsignedConsentTable migrated
09:39:01.451 -------------------------------------------------------------------------------
09:39:01.452 49: AddFeatureListTable migrating
09:39:01.452 -------------------------------------------------------------------------------
09:39:01.452 [+] Beginning Transaction
09:39:01.454 [+] CreateTable feature_list
09:39:01.458 [+] Committing Transaction
09:39:01.460 [+] 49: AddFeatureListTable migrated
09:39:01.461 -------------------------------------------------------------------------------
09:39:01.462 50: AddIndexFirstNameLastNameToAssignee migrating
09:39:01.462 -------------------------------------------------------------------------------
09:39:01.462 [+] Beginning Transaction
09:39:01.464 [+] Committing Transaction
09:39:01.466 [+] 50: AddIndexFirstNameLastNameToAssignee migrated
09:39:01.467 -------------------------------------------------------------------------------
09:39:01.467 51: CreateFailedEmail migrating
09:39:01.467 -------------------------------------------------------------------------------
09:39:01.468 [+] Beginning Transaction
09:39:01.470 [+] DeleteColumn activate_questionnaire_failed_email status
09:39:01.483 [+] DeleteColumn activate_questionnaire_failed_email last_modified_at
09:39:01.492 [+] CreateColumn activate_questionnaire_failed_email failed_email_id Int64
09:39:01.494 [+] CreateTable failed_emails
09:39:01.499 [+] Committing Transaction
09:39:01.501 [+] 51: CreateFailedEmail migrated
09:39:01.502 -------------------------------------------------------------------------------
09:39:01.503 52: AddContentToFailedEmail migrating
09:39:01.503 -------------------------------------------------------------------------------
09:39:01.503 [+] Beginning Transaction
09:39:01.505 [+] CreateColumn failed_emails content String
09:39:01.509 [+] DeleteTable activate_questionnaire_failed_email
09:39:01.512 [+] CreateTable notification_error_messages
09:39:01.516 [+] Committing Transaction
09:39:01.518 [+] 52: AddContentToFailedEmail migrated
09:39:01.519 -------------------------------------------------------------------------------
09:39:01.520 53: CreateMissingItemsMail migrating
09:39:01.520 -------------------------------------------------------------------------------
09:39:01.520 [+] Beginning Transaction
09:39:01.523 [+] CreateTable missing_itmes_mails
09:39:01.700 [+] Committing Transaction
09:39:01.702 [+] 53: CreateMissingItemsMail migrated
09:39:01.702 -------------------------------------------------------------------------------
09:39:01.702 54: AddAccountIdToAssignee migrating
09:39:01.702 -------------------------------------------------------------------------------
09:39:01.703 [+] Beginning Transaction
09:39:01.705 [+] AlterTable assignees
09:39:01.706 [+] CreateColumn assignees account_id Guid
09:39:01.710 [+] Committing Transaction
09:39:01.712 [+] 54: AddAccountIdToAssignee migrated
09:39:01.712 -------------------------------------------------------------------------------
09:39:01.712 55: AddIsCpqToQuestionnaire migrating
09:39:01.712 -------------------------------------------------------------------------------
09:39:01.713 [+] Beginning Transaction
09:39:01.713 [+] AlterTable questionnaire
09:39:01.713 [+] CreateColumn questionnaire is_cpq Boolean
09:39:01.716 [+] Committing Transaction
09:39:01.717 [+] 55: AddIsCpqToQuestionnaire migrated
09:39:01.717 -------------------------------------------------------------------------------
09:39:01.717 56: AddIrMarkToQuestionnaire migrating
09:39:01.718 -------------------------------------------------------------------------------
09:39:01.718 [+] Beginning Transaction
09:39:01.718 [+] AlterTable questionnaire
09:39:01.718 [+] CreateColumn questionnaire ir_mark String
09:39:01.721 [+] Committing Transaction
09:39:01.723 [+] 56: AddIrMarkToQuestionnaire migrated
09:39:01.723 -------------------------------------------------------------------------------
09:39:01.723 57: AddAssigneeEngagementTableAndRemoveEngagementIdFromAssignee migrating
09:39:01.723 -------------------------------------------------------------------------------
09:39:01.723 [+] Beginning Transaction
09:39:01.726 [+] CreateTable assignees_engagements
09:39:01.731 [+] ExecuteSqlStatement  
09:39:01.731                 ALTER TABLE [assignees_engagements] 
09:39:01.731                 ADD CONSTRAINT [assignees_engagements_constraint_pk] PRIMARY KEY NONCLUSTERED (id ASC)
09:39:01.731             
09:39:01.733 [+] CreateIndex assignees_engagements (assignee_id)
09:39:01.738 [+] CreateIndex assignees_engagements (engagement_id)
09:39:01.739 [+] ExecuteSqlStatement 
09:39:01.739                 INSERT INTO assignees_engagements(assignee_id, engagement_id)
09:39:01.739                     SELECT	id, engagement_id
09:39:01.739                     FROM	[assignees]                
09:39:01.739             
09:39:01.743 [+] DeleteIndex assignees ()
09:39:01.746 [+] DeleteColumn assignees engagement_id
09:39:01.764 [+] Committing Transaction
09:39:01.765 [+] 57: AddAssigneeEngagementTableAndRemoveEngagementIdFromAssignee migrated
09:39:01.766 -------------------------------------------------------------------------------
09:39:01.766 58: AddClientsTable migrating
09:39:01.766 -------------------------------------------------------------------------------
09:39:01.767 [+] Beginning Transaction
09:39:01.770 [+] CreateTable clients
09:39:01.771 [+] CreateIndex clients (name)
09:39:01.772 [+] CreateIndex clients (short_name)
09:39:01.773 [+] AlterTable engagements
09:39:01.774 [+] AlterColumn engagements client_name String
09:39:01.775 [+] CreateColumn engagements client_id Int64
09:39:01.776 [+] ExecuteSqlStatement 
09:39:01.776                 INSERT INTO clients(name, status)
09:39:01.776                     SELECT	distinct client_name, 1
09:39:01.777                     FROM	[engagements];
09:39:01.777                 UPDATE e SET e.client_id = c.id
09:39:01.777                     FROM clients c
09:39:01.777                     JOIN engagements e ON c.name = e.client_name;
09:39:01.777             
09:39:01.781 [+] DeleteColumn engagements client_name
09:39:01.789 [+] Committing Transaction
09:39:01.791 [+] 58: AddClientsTable migrated
09:39:01.793 -------------------------------------------------------------------------------
09:39:01.793 59: MigrateClientShortNameInClientTable migrating
09:39:01.793 -------------------------------------------------------------------------------
09:39:01.793 [+] Beginning Transaction
09:39:01.796 [+] ExecuteSqlStatement 
09:39:01.796                 UPDATE clients SET short_name = SUBSTRING(name, 1, 20) WHERE short_name IS NULL OR short_name = ''
09:39:01.797             
09:39:01.804 [+] DeleteIndex clients ()
09:39:01.810 [+] AlterTable clients
09:39:01.813 [+] AlterColumn clients short_name String
09:39:01.817 [+] CreateIndex clients (short_name)
09:39:01.821 [+] Committing Transaction
09:39:01.822 [+] 59: MigrateClientShortNameInClientTable migrated
09:39:01.824 -------------------------------------------------------------------------------
09:39:01.824 60: DeleteIndexOnAssigneesEngagementsTableAndClientTable migrating
09:39:01.824 -------------------------------------------------------------------------------
09:39:01.825 [+] Beginning Transaction
09:39:01.827 [+] ExecuteSqlStatement ALTER TABLE [dbo].[assignees_engagements] DROP CONSTRAINT [assignees_engagements_constraint_pk]
09:39:01.831 [+] DeleteColumn assignees_engagements id
09:39:01.848 [+] DeleteIndex assignees_engagements ()
09:39:01.852 [+] DeleteIndex assignees_engagements ()
09:39:01.855 [+] ExecuteSqlStatement  
09:39:01.855                 ALTER TABLE [assignees_engagements] 
09:39:01.855                 ADD CONSTRAINT [assignees_engagements_unique_constraint] UNIQUE NONCLUSTERED (assignee_id ASC, engagement_id ASC)
09:39:01.856             
09:39:01.859 [+] DeleteIndex clients ()
09:39:01.862 [+] DeleteIndex clients ()
09:39:01.865 [+] Committing Transaction
09:39:01.867 [+] 60: DeleteIndexOnAssigneesEngagementsTableAndClientTable migrated
09:39:01.868 -------------------------------------------------------------------------------
09:39:01.868 61: MigrateRemoveFailedEmailsTable migrating
09:39:01.869 -------------------------------------------------------------------------------
09:39:01.869 [+] Beginning Transaction
09:39:01.871 [+] DeleteTable failed_emails
09:39:01.882 [+] Committing Transaction
09:39:01.884 [+] 61: MigrateRemoveFailedEmailsTable migrated
09:39:01.885 -------------------------------------------------------------------------------
09:39:01.886 62: ChangeAssigneeFieldLengthToBeSameAsAccountService migrating
09:39:01.886 -------------------------------------------------------------------------------
09:39:01.886 [+] Beginning Transaction
09:39:01.891 [+] DeleteIndex assignees ()
09:39:01.894 [+] DeleteIndex assignees ()
09:39:01.896 [+] AlterColumn assignees first_name String
09:39:01.899 [+] AlterColumn assignees middle_name String
09:39:01.903 [+] AlterColumn assignees last_name String
09:39:01.905 [+] AlterColumn assignees employee_id String
09:39:01.908 [+] AlterColumn assignees occupation String
09:39:01.912 [+] AlterColumn assignees primary_email String
09:39:01.915 [+] AlterColumn assignees secondary_email String
09:39:01.919 [+] AlterColumn assignees phone_number String
09:39:01.922 [+] AlterColumn assignees mobile_phone_number String
09:39:01.926 [+] AlterColumn assignees street_address_1 String
09:39:01.929 [+] AlterColumn assignees street_address_2 String
09:39:01.931 [+] AlterColumn assignees city String
09:39:01.941 [+] AlterColumn assignees zip String
09:39:01.948 [+] AlterColumn assignees state String
09:39:01.954 [+] AlterColumn assignees suite_number String
09:39:01.959 [+] AlterColumn assignees county String
09:39:01.965 [+] CreateIndex assignees (primary_email)
09:39:01.968 [+] CreateIndex assignees (secondary_email)
09:39:01.971 [+] Committing Transaction
09:39:01.972 [+] 62: ChangeAssigneeFieldLengthToBeSameAsAccountService migrated
09:39:01.972 -------------------------------------------------------------------------------
09:39:01.972 63: AddAccountSyncTable migrating
09:39:01.972 -------------------------------------------------------------------------------
09:39:01.972 [+] Beginning Transaction
09:39:01.982 [+] CreateTable account_syncs
09:39:01.984 [+] ExecuteSqlStatement insert into Account_Syncs(status,last_updated_time,last_modified_at) values(0, '2015-11-25 01:39:01','635840123419739690')
09:39:01.986 [+] Committing Transaction
09:39:01.986 [+] 63: AddAccountSyncTable migrated
09:39:01.987 -------------------------------------------------------------------------------
09:39:01.987 64: RemoveAssigneeDetails migrating
09:39:01.987 -------------------------------------------------------------------------------
09:39:01.987 [+] Beginning Transaction
09:39:01.988 [+] DeleteColumn assignees date_of_birth
09:39:01.996 [+] DeleteColumn assignees employee_id
09:39:02.006 [+] DeleteColumn assignees language_preference
09:39:02.014 [+] DeleteColumn assignees street_address_1
09:39:02.020 [+] DeleteColumn assignees street_address_2
09:39:02.027 [+] DeleteColumn assignees city
09:39:02.035 [+] DeleteColumn assignees Zip
09:39:02.042 [+] DeleteColumn assignees state
09:39:02.050 [+] DeleteColumn assignees county
09:39:02.058 [+] DeleteColumn assignees country_id
09:39:02.070 [+] DeleteColumn assignees suite_number
09:39:02.084 [+] DeleteColumn assignees phone_number
09:39:02.092 [+] DeleteColumn assignees mobile_phone_number
09:39:02.101 [+] DeleteColumn assignees time_zone
09:39:02.111 [+] DeleteColumn assignees gender
09:39:02.131 [+] Committing Transaction
09:39:02.138 [+] 64: RemoveAssigneeDetails migrated
09:39:02.140 -------------------------------------------------------------------------------
09:39:02.140 65: AddImmigrationInfoTable migrating
09:39:02.140 -------------------------------------------------------------------------------
09:39:02.141 [+] Beginning Transaction
09:39:02.150 [+] CreateTable immigration_info
09:39:02.155 [+] CreateConstraint PK_immigration_info
09:39:02.165 [+] Committing Transaction
09:39:02.167 [+] 65: AddImmigrationInfoTable migrated
09:39:02.169 -------------------------------------------------------------------------------
09:39:02.169 66: AddOrganizerTable migrating
09:39:02.169 -------------------------------------------------------------------------------
09:39:02.170 [+] Beginning Transaction
09:39:02.172 [+] CreateTable organizers
09:39:02.175 [+] CreateConstraint PK_organizers
09:39:02.180 [+] DeleteTable questionnaire
09:39:02.186 [+] Committing Transaction
09:39:02.189 [+] 66: AddOrganizerTable migrated
09:39:02.190 -------------------------------------------------------------------------------
09:39:02.191 67: AddOrganizerMilestoneTable migrating
09:39:02.191 -------------------------------------------------------------------------------
09:39:02.191 [+] Beginning Transaction
09:39:02.194 [+] CreateTable organizer_milestones
09:39:02.204 [+] Committing Transaction
09:39:02.207 [+] 67: AddOrganizerMilestoneTable migrated
09:39:02.208 -------------------------------------------------------------------------------
09:39:02.208 68: DeleteNotificationErrorMessagesTable migrating
09:39:02.208 -------------------------------------------------------------------------------
09:39:02.209 [+] Beginning Transaction
09:39:02.210 [+] DeleteTable notification_error_messages
09:39:02.214 [+] Committing Transaction
09:39:02.217 [+] 68: DeleteNotificationErrorMessagesTable migrated
09:39:02.218 -------------------------------------------------------------------------------
09:39:02.218 69: AddIsInitialPasswordColumnToUserTable migrating
09:39:02.218 -------------------------------------------------------------------------------
09:39:02.218 [+] Beginning Transaction
09:39:02.220 [+] AlterTable users
09:39:02.222 [+] CreateColumn users is_initial_password Boolean
09:39:02.225 [+] Committing Transaction
09:39:02.228 [+] 69: AddIsInitialPasswordColumnToUserTable migrated
09:39:02.229 -------------------------------------------------------------------------------
09:39:02.229 70: AddDependentColumnForImmigrationInfoTable migrating
09:39:02.229 -------------------------------------------------------------------------------
09:39:02.230 [+] Beginning Transaction
09:39:02.231 [+] AlterTable immigration_info
09:39:02.233 [+] CreateColumn immigration_info dependent String
09:39:02.237 [+] Committing Transaction
09:39:02.239 [+] 70: AddDependentColumnForImmigrationInfoTable migrated
09:39:02.241 -------------------------------------------------------------------------------
09:39:02.241 71: RemoveInTaxReturnCountFromService migrating
09:39:02.241 -------------------------------------------------------------------------------
09:39:02.242 [+] Beginning Transaction
09:39:02.244 [+] DeleteColumn types_of_service in_tax_return_count, target_type
09:39:02.265 [+] AlterColumn organizers question_set_id String
09:39:02.271 [+] Committing Transaction
09:39:02.273 [+] 71: RemoveInTaxReturnCountFromService migrated
09:39:02.275 -------------------------------------------------------------------------------
09:39:02.276 72: ChangeOrganizerStatusToInteger migrating
09:39:02.276 -------------------------------------------------------------------------------
09:39:02.276 [+] Beginning Transaction
09:39:02.278 [+] AlterTable organizers
09:39:02.280 [+] AlterColumn organizers status Int32
09:39:02.285 [+] AlterTable organizer_milestones
09:39:02.287 [+] AlterColumn organizer_milestones name Int32
09:39:02.293 [+] Committing Transaction
09:39:02.295 [+] 72: ChangeOrganizerStatusToInteger migrated
09:39:02.297 -------------------------------------------------------------------------------
09:39:02.297 73: AddReceivedAtToMissingItem migrating
09:39:02.297 -------------------------------------------------------------------------------
09:39:02.298 [+] Beginning Transaction
09:39:02.300 [+] AlterTable missing_items
09:39:02.301 [+] CreateColumn missing_items received_at DateTime
09:39:02.305 [+] Committing Transaction
09:39:02.307 [+] 73: AddReceivedAtToMissingItem migrated
09:39:02.309 -------------------------------------------------------------------------------
09:39:02.309 74: AddWorkRecordReportTable migrating
09:39:02.309 -------------------------------------------------------------------------------
09:39:02.310 [+] Beginning Transaction
09:39:02.313 [+] CreateTable work_record_reports
09:39:02.318 [+] ExecuteSqlStatement Alter table work_record_reports add constraint pk_work_record_reports primary key clustered(work_record_id)
09:39:02.324 [+] CreateIndex work_record_reports (tax_year, practice_type, engagement_id, responsible_office_id, jurisdiction_id)
09:39:02.332 [+] Committing Transaction
09:39:02.336 [+] 74: AddWorkRecordReportTable migrated
09:39:02.338 -------------------------------------------------------------------------------
09:39:02.338 75: AddColumnToWorkRecordReportTable migrating
09:39:02.338 -------------------------------------------------------------------------------
09:39:02.338 [+] Beginning Transaction
09:39:02.341 [+] AlterTable work_record_reports
09:39:02.342 [+] CreateColumn work_record_reports days_in_hourse Int32
09:39:02.346 [+] AlterTable work_record_reports
09:39:02.346 [+] CreateColumn work_record_reports days_in_mi Int32
09:39:02.351 [+] AlterTable work_record_reports
09:39:02.352 [+] CreateColumn work_record_reports has_missing_info Boolean
09:39:02.356 [+] AlterTable work_record_reports
09:39:02.357 [+] CreateColumn work_record_reports notified_at DateTime
09:39:02.360 [+] AlterTable work_record_reports
09:39:02.362 [+] CreateColumn work_record_reports in_process_at DateTime
09:39:02.365 [+] AlterTable work_record_reports
09:39:02.366 [+] CreateColumn work_record_reports submitted_at DateTime
09:39:02.370 [+] Committing Transaction
09:39:02.372 [+] 75: AddColumnToWorkRecordReportTable migrated
09:39:02.374 -------------------------------------------------------------------------------
09:39:02.374 76: AddCreatedAtToWorkRecordReportTable migrating
09:39:02.374 -------------------------------------------------------------------------------
09:39:02.375 [+] Beginning Transaction
09:39:02.377 [+] AlterTable work_record_reports
09:39:02.380 [+] CreateColumn work_record_reports created_at DateTime
09:39:02.386 [+] Committing Transaction
09:39:02.389 [+] 76: AddCreatedAtToWorkRecordReportTable migrated
09:39:02.390 -------------------------------------------------------------------------------
09:39:02.390 77: AddWorkRecordStatusToWorkRecordReportTable migrating
09:39:02.390 -------------------------------------------------------------------------------
09:39:02.390 [+] Beginning Transaction
09:39:02.397 [+] AlterTable work_record_reports
09:39:02.401 [+] CreateColumn work_record_reports last_mi_generate_date DateTime
09:39:02.404 [+] DeleteColumn work_record_reports days_in_hourse
09:39:02.423 [+] Committing Transaction
09:39:02.425 [+] 77: AddWorkRecordStatusToWorkRecordReportTable migrated
09:39:02.427 -------------------------------------------------------------------------------
09:39:02.427 78: AddEntityTimestamp migrating
09:39:02.427 -------------------------------------------------------------------------------
09:39:02.428 [+] Beginning Transaction
09:39:02.429 [+] CreateTable entity_timestamps
09:39:02.432 [+] ExecuteSqlStatement Insert entity_timestamps values('Office',635840123424290180)
09:39:02.435 [+] ExecuteSqlStatement Insert entity_timestamps values('TypeOfService',635840123424290180)
09:39:02.438 [+] Committing Transaction
09:39:02.440 [+] 78: AddEntityTimestamp migrated
09:39:02.441 -------------------------------------------------------------------------------
09:39:02.442 79: AddFeatureToggle migrating
09:39:02.442 -------------------------------------------------------------------------------
09:39:02.442 [+] Beginning Transaction
09:39:02.444 [+] CreateTable feature_toggle
09:39:02.448 [+] ExecuteSqlStatement Insert feature_toggle values('upload-myVisas-file',0)
09:39:02.452 [+] Committing Transaction
09:39:02.454 [+] 79: AddFeatureToggle migrated
09:39:02.455 -------------------------------------------------------------------------------
09:39:02.455 80: AddTaskTemplate migrating
09:39:02.455 -------------------------------------------------------------------------------
09:39:02.456 [+] Beginning Transaction
09:39:02.462 [+] CreateTable task_templates
09:39:02.468 [+] CreateIndex task_templates (name)
09:39:02.471 [+] Committing Transaction
09:39:02.472 [+] 80: AddTaskTemplate migrated
09:39:02.474 -------------------------------------------------------------------------------
09:39:02.474 81: AddTaskDefinition migrating
09:39:02.474 -------------------------------------------------------------------------------
09:39:02.475 [+] Beginning Transaction
09:39:02.485 [+] CreateTable task_definitions
09:39:02.490 [+] CreateForeignKey fk_task_definitions_ref_task_templates task_definitions(task_template_id) task_templates(id)
09:39:02.499 [+] Committing Transaction
09:39:02.501 [+] 81: AddTaskDefinition migrated
09:39:02.503 -------------------------------------------------------------------------------
09:39:02.503 82: AddWorkRecordTaskTemplate migrating
09:39:02.503 -------------------------------------------------------------------------------
09:39:02.504 [+] Beginning Transaction
09:39:02.506 [+] CreateTable work_record_task_templates
09:39:02.509 [+] CreateForeignKey fk_work_record_task_templates_ref_task_templates work_record_task_templates(task_template_id) task_templates(id)
09:39:02.512 [+] CreateForeignKey fk_work_record_task_templates_ref_work_records work_record_task_templates(work_record_id) work_records(id)
09:39:02.516 [+] Committing Transaction
09:39:02.518 [+] 82: AddWorkRecordTaskTemplate migrated
09:39:02.519 -------------------------------------------------------------------------------
09:39:02.519 83: AddFeatureToggleForTaskTemplate migrating
09:39:02.519 -------------------------------------------------------------------------------
09:39:02.520 [+] Beginning Transaction
09:39:02.538 [+] -> 1 Insert operations completed in 00:00:00.0029295 taking an average of 00:00:00.0029295
09:39:02.539 [+] Committing Transaction
09:39:02.541 [+] 83: AddFeatureToggleForTaskTemplate migrated
09:39:02.542 -------------------------------------------------------------------------------
09:39:02.543 84: AddFeatureToggleForAdditionalService migrating
09:39:02.543 -------------------------------------------------------------------------------
09:39:02.543 [+] Beginning Transaction
09:39:02.546 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:02.547 [+] Committing Transaction
09:39:02.550 [+] 84: AddFeatureToggleForAdditionalService migrated
09:39:02.551 -------------------------------------------------------------------------------
09:39:02.551 85: CreateIndexForOrganizerMilstone migrating
09:39:02.551 -------------------------------------------------------------------------------
09:39:02.552 [+] Beginning Transaction
09:39:02.553 [+] CreateIndex organizer_milestones (organizer_id)
09:39:02.555 [+] Committing Transaction
09:39:02.558 [+] 85: CreateIndexForOrganizerMilstone migrated
09:39:02.559 -------------------------------------------------------------------------------
09:39:02.559 86: AddWorkRecordTask migrating
09:39:02.559 -------------------------------------------------------------------------------
09:39:02.559 [+] Beginning Transaction
09:39:02.562 [+] CreateTable work_record_tasks
09:39:02.566 [+] Committing Transaction
09:39:02.568 [+] 86: AddWorkRecordTask migrated
09:39:02.569 -------------------------------------------------------------------------------
09:39:02.570 87: AddSubscribedOffices migrating
09:39:02.570 -------------------------------------------------------------------------------
09:39:02.570 [+] Beginning Transaction
09:39:02.588 [+] CreateTable task_template_subscriptions
09:39:02.589 [+] CreateForeignKey fk_task_template_subscriptions_ref_countries task_template_subscriptions(country_id) countries(id)
09:39:02.589 [+] CreateForeignKey fk_task_template_subscriptions_ref_offices task_template_subscriptions(office_id) offices(id)
09:39:02.589 [+] CreateForeignKey fk_task_template_subscriptions_ref_task_templates task_template_subscriptions(task_template_id) task_templates(id)
09:39:02.590 [+] Committing Transaction
09:39:02.593 [+] 87: AddSubscribedOffices migrated
09:39:02.594 -------------------------------------------------------------------------------
09:39:02.594 88: AddAdditionalServicesTable migrating
09:39:02.594 -------------------------------------------------------------------------------
09:39:02.594 [+] Beginning Transaction
09:39:02.595 [+] CreateTable additional_services
09:39:02.598 [+] Committing Transaction
09:39:02.600 [+] 88: AddAdditionalServicesTable migrated
09:39:02.601 -------------------------------------------------------------------------------
09:39:02.601 89: AddBatchItem migrating
09:39:02.602 -------------------------------------------------------------------------------
09:39:02.602 [+] Beginning Transaction
09:39:02.604 [+] CreateTable batch_item
09:39:02.608 [+] Committing Transaction
09:39:02.610 [+] 89: AddBatchItem migrated
09:39:02.611 -------------------------------------------------------------------------------
09:39:02.611 90: AddFeatureToggleForFileCabinetDownloadHistory migrating
09:39:02.612 -------------------------------------------------------------------------------
09:39:02.612 [+] Beginning Transaction
09:39:02.614 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:02.616 [+] Committing Transaction
09:39:02.617 [+] 90: AddFeatureToggleForFileCabinetDownloadHistory migrated
09:39:02.618 -------------------------------------------------------------------------------
09:39:02.618 91: AddBatch migrating
09:39:02.618 -------------------------------------------------------------------------------
09:39:02.619 [+] Beginning Transaction
09:39:02.621 [+] DeleteTable batch_item
09:39:02.625 [+] CreateTable batches
09:39:02.628 [+] CreateTable batch_items
09:39:02.632 [+] Committing Transaction
09:39:02.634 [+] 91: AddBatch migrated
09:39:02.635 -------------------------------------------------------------------------------
09:39:02.636 92: AddClientIdToAssigneesTable migrating
09:39:02.636 -------------------------------------------------------------------------------
09:39:02.636 [+] Beginning Transaction
09:39:02.637 [+] AlterTable assignees
09:39:02.638 [+] CreateColumn assignees client_id Int64
09:39:02.642 [+] ExecuteSqlStatement update assignees set client_id = (select top 1 engagements.client_id from 
09:39:02.642                             engagements inner join assignees_engagements on assignees_engagements.engagement_id = engagements.id where
09:39:02.642                             assignees_engagements.assignee_id = assignees.id)
09:39:02.651 [+] Committing Transaction
09:39:02.658 [+] 92: AddClientIdToAssigneesTable migrated
09:39:02.661 -------------------------------------------------------------------------------
09:39:02.661 93: AddEngagementIdToTaskTemplatesTable migrating
09:39:02.661 -------------------------------------------------------------------------------
09:39:02.662 [+] Beginning Transaction
09:39:02.666 [+] AlterTable task_templates
09:39:02.667 [+] CreateColumn task_templates engagement_id Int64
09:39:02.670 [+] CreateForeignKey fk_task_templates_ref_engagements task_templates(engagement_id) engagements(id)
09:39:02.674 [+] Committing Transaction
09:39:02.676 [+] 93: AddEngagementIdToTaskTemplatesTable migrated
09:39:02.678 -------------------------------------------------------------------------------
09:39:02.678 94: AddFeatureToggleForDeleteWorkRecord migrating
09:39:02.678 -------------------------------------------------------------------------------
09:39:02.679 [+] Beginning Transaction
09:39:02.686 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:02.698 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:02.700 [+] Committing Transaction
09:39:02.701 [+] 94: AddFeatureToggleForDeleteWorkRecord migrated
09:39:02.703 -------------------------------------------------------------------------------
09:39:02.703 95: RemoveDeleteOnCascadeForForeignKeys migrating
09:39:02.703 -------------------------------------------------------------------------------
09:39:02.704 [+] Beginning Transaction
09:39:02.714 [+] DeleteForeignKey fk_work_record_task_templates_ref_task_templates work_record_task_templates ()  ()
09:39:02.722 [+] CreateForeignKey fk_work_record_task_templates_ref_task_templates work_record_task_templates(task_template_id) task_templates(id)
09:39:02.725 [+] DeleteForeignKey fk_work_record_task_templates_ref_work_records work_record_task_templates ()  ()
09:39:02.729 [+] CreateForeignKey fk_work_record_task_templates_ref_work_records work_record_task_templates(work_record_id) work_records(id)
09:39:02.732 [+] DeleteForeignKey fk_task_definitions_ref_task_templates task_definitions ()  ()
09:39:02.735 [+] CreateForeignKey fk_task_definitions_ref_task_templates task_definitions(task_template_id) task_templates(id)
09:39:02.738 [+] DeleteForeignKey fk_task_template_subscriptions_ref_countries task_template_subscriptions ()  ()
09:39:02.741 [+] CreateForeignKey fk_task_template_subscriptions_ref_countries task_template_subscriptions(country_id) countries(id)
09:39:02.745 [+] DeleteForeignKey fk_task_template_subscriptions_ref_offices task_template_subscriptions ()  ()
09:39:02.748 [+] CreateForeignKey fk_task_template_subscriptions_ref_offices task_template_subscriptions(office_id) offices(id)
09:39:02.752 [+] DeleteForeignKey fk_task_template_subscriptions_ref_task_templates task_template_subscriptions ()  ()
09:39:02.755 [+] CreateForeignKey fk_task_template_subscriptions_ref_task_templates task_template_subscriptions(task_template_id) task_templates(id)
09:39:02.759 [+] Committing Transaction
09:39:02.761 [+] 95: RemoveDeleteOnCascadeForForeignKeys migrated
09:39:02.762 -------------------------------------------------------------------------------
09:39:02.762 96: AllowTaskTemplateIdNullableBecauseOfCascadeUpdate migrating
09:39:02.762 -------------------------------------------------------------------------------
09:39:02.762 [+] Beginning Transaction
09:39:02.764 [+] AlterColumn task_definitions task_template_id Int64
09:39:02.767 [+] Committing Transaction
09:39:02.769 [+] 96: AllowTaskTemplateIdNullableBecauseOfCascadeUpdate migrated
09:39:02.770 -------------------------------------------------------------------------------
09:39:02.770 97: FixMissingItemsMailTableTable migrating
09:39:02.770 -------------------------------------------------------------------------------
09:39:02.771 [+] Beginning Transaction
09:39:02.773 [+] RenameTable missing_itmes_mails missing_items_mails
09:39:02.777 [+] Committing Transaction
09:39:02.778 [+] 97: FixMissingItemsMailTableTable migrated
09:39:02.780 -------------------------------------------------------------------------------
09:39:02.780 98: RemoveCascadeDeleteOnTableTaskTemplatesAndAddColumnOnTableWorkRecordTaskTemplates migrating
09:39:02.780 -------------------------------------------------------------------------------
09:39:02.780 [+] Beginning Transaction
09:39:02.793 [+] DeleteForeignKey fk_task_templates_ref_engagements task_templates ()  ()
09:39:02.796 [+] CreateForeignKey fk_task_templates_ref_engagements task_templates(engagement_id) engagements(id)
09:39:02.800 [+] DeleteConstraint PK_work_record_task_templates
09:39:02.806 [+] AlterTable work_record_task_templates
09:39:02.807 [+] CreateColumn work_record_task_templates id Int64
09:39:02.810 [+] CreateConstraint PK_work_record_task_templates
09:39:02.815 [+] Committing Transaction
09:39:02.817 [+] 98: RemoveCascadeDeleteOnTableTaskTemplatesAndAddColumnOnTableWorkRecordTaskTemplates migrated
09:39:02.818 -------------------------------------------------------------------------------
09:39:02.819 99: AddFeatureToggleForMissingInfo migrating
09:39:02.819 -------------------------------------------------------------------------------
09:39:02.819 [+] Beginning Transaction
09:39:02.821 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:02.823 [+] Committing Transaction
09:39:02.825 [+] 99: AddFeatureToggleForMissingInfo migrated
09:39:02.826 -------------------------------------------------------------------------------
09:39:02.826 100: AllowWorkRecordIdInAdditionalServicesNullable migrating
09:39:02.827 -------------------------------------------------------------------------------
09:39:02.827 [+] Beginning Transaction
09:39:02.829 [+] AlterColumn additional_services work_record_id Int64
09:39:02.832 [+] Committing Transaction
09:39:02.834 [+] 100: AllowWorkRecordIdInAdditionalServicesNullable migrated
09:39:02.836 -------------------------------------------------------------------------------
09:39:02.836 101: AllowTaskDefinitionIdOnWorkRecordTaskNullable migrating
09:39:02.836 -------------------------------------------------------------------------------
09:39:02.836 [+] Beginning Transaction
09:39:02.838 [+] AlterColumn work_record_tasks task_definition_id Int64
09:39:02.842 [+] Committing Transaction
09:39:02.843 [+] 101: AllowTaskDefinitionIdOnWorkRecordTaskNullable migrated
09:39:02.845 -------------------------------------------------------------------------------
09:39:02.845 102: AddFeatureToggleForBatchSendInvitation migrating
09:39:02.845 -------------------------------------------------------------------------------
09:39:02.845 [+] Beginning Transaction
09:39:02.848 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:02.851 [+] Committing Transaction
09:39:02.854 [+] 102: AddFeatureToggleForBatchSendInvitation migrated
09:39:02.855 -------------------------------------------------------------------------------
09:39:02.855 103: AddChecklistTemplatesTable migrating
09:39:02.855 -------------------------------------------------------------------------------
09:39:02.856 [+] Beginning Transaction
09:39:02.858 [+] CreateTable checklist_templates
09:39:02.860 [+] CreateIndex checklist_templates (name)
09:39:02.861 [+] CreateForeignKey fk_checklist_templates_ref_engagements checklist_templates(engagement_id) engagements(id)
09:39:02.865 [+] Committing Transaction
09:39:02.867 [+] 103: AddChecklistTemplatesTable migrated
09:39:02.868 -------------------------------------------------------------------------------
09:39:02.869 104: AddChecklistTemplateSubscriptionsTable migrating
09:39:02.869 -------------------------------------------------------------------------------
09:39:02.869 [+] Beginning Transaction
09:39:02.872 [+] CreateTable checklist_template_subscriptions
09:39:02.875 [+] CreateForeignKey fk_checklist_template_subscriptions_ref_countries checklist_template_subscriptions(country_id) countries(id)
09:39:02.880 [+] CreateForeignKey fk_checklist_template_subscriptions_ref_offices checklist_template_subscriptions(office_id) offices(id)
09:39:02.884 [+] CreateForeignKey fk_checklist_template_subscriptions_ref_checklist_templates checklist_template_subscriptions(checklist_template_id) checklist_templates(id)
09:39:02.886 [+] Committing Transaction
09:39:02.888 [+] 104: AddChecklistTemplateSubscriptionsTable migrated
09:39:02.889 -------------------------------------------------------------------------------
09:39:02.890 105: AddChecklistItemDefinitionsTable migrating
09:39:02.890 -------------------------------------------------------------------------------
09:39:02.890 [+] Beginning Transaction
09:39:02.893 [+] CreateTable checklist_item_definitions
09:39:02.899 [+] CreateForeignKey fk_checklist_item_definitions_ref_checklist_templates checklist_item_definitions(checklist_template_id) checklist_templates(id)
09:39:02.905 [+] Committing Transaction
09:39:02.908 [+] 105: AddChecklistItemDefinitionsTable migrated
09:39:02.909 -------------------------------------------------------------------------------
09:39:02.910 106: AddWorkrecordChecklistTable migrating
09:39:02.910 -------------------------------------------------------------------------------
09:39:02.910 [+] Beginning Transaction
09:39:02.912 [+] CreateTable work_record_checklist_templates
09:39:02.924 [+] CreateForeignKey fk_work_record_checklist_templates_ref_checklist_templates work_record_checklist_templates(checklist_template_id) checklist_templates(id)
09:39:02.926 [+] CreateForeignKey fk_work_record_checklist_templates_ref_work_records work_record_checklist_templates(work_record_id) work_records(id)
09:39:02.929 [+] Committing Transaction
09:39:02.931 [+] 106: AddWorkrecordChecklistTable migrated
09:39:02.932 -------------------------------------------------------------------------------
09:39:02.933 107: AddWorkRecordChecklistItem migrating
09:39:02.933 -------------------------------------------------------------------------------
09:39:02.933 [+] Beginning Transaction
09:39:02.936 [+] CreateTable work_record_checklist_items
09:39:02.939 [+] CreateForeignKey fk_work_record_checklist_items_ref_work_records work_record_checklist_items(work_record_id) work_records(id)
09:39:02.943 [+] Committing Transaction
09:39:02.945 [+] 107: AddWorkRecordChecklistItem migrated
09:39:02.946 -------------------------------------------------------------------------------
09:39:02.946 108: AlterOrganizerToAddQuestionnaireReminder migrating
09:39:02.947 -------------------------------------------------------------------------------
09:39:02.947 [+] Beginning Transaction
09:39:02.949 [+] AlterTable organizers
09:39:02.950 [+] CreateColumn organizers reminder_state Int16
09:39:02.955 [+] Committing Transaction
09:39:02.957 [+] 108: AlterOrganizerToAddQuestionnaireReminder migrated
09:39:02.958 -------------------------------------------------------------------------------
09:39:02.959 109: AddFeatureToggleForQuestionnaireReminder migrating
09:39:02.959 -------------------------------------------------------------------------------
09:39:02.959 [+] Beginning Transaction
09:39:02.962 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:02.963 [+] Committing Transaction
09:39:02.965 [+] 109: AddFeatureToggleForQuestionnaireReminder migrated
09:39:02.966 -------------------------------------------------------------------------------
09:39:02.967 110: AddIsDefaultToTaskDefinition migrating
09:39:02.967 -------------------------------------------------------------------------------
09:39:02.968 [+] Beginning Transaction
09:39:02.969 [+] AlterTable task_definitions
09:39:02.970 [+] CreateColumn task_definitions is_default Boolean
09:39:02.974 [+] ExecuteSqlStatement declare @id int
09:39:02.974 declare ids cursor for 	select id from task_templates
09:39:02.974 open ids
09:39:02.974 fetch next from ids into @id
09:39:02.974 While @@fetch_status=0     
09:39:02.975 Begin
09:39:02.975 	if not Exists(select * from task_definitions where task_template_id=@id and milestone=10)
09:39:02.975 	begin
09:39:02.975 		insert into task_definitions (name,task_index,task_template_id,milestone,is_default) values('Initiated',0,@id,10,1);
09:39:02.975 	end
09:39:02.975 	if not Exists(select * from task_definitions where task_template_id=@id and milestone=20)
09:39:02.975 	begin
09:39:02.976 		insert into task_definitions (name,task_index,task_template_id,milestone,is_default) values('In Preparation',0,@id,20,1);
09:39:02.976 	end
09:39:02.976 	if not Exists(select * from task_definitions where task_template_id=@id and milestone=30)
09:39:02.976 	begin
09:39:02.976 		insert into task_definitions (name,task_index,task_template_id,milestone,is_default) values('In Review',0,@id,30,1);
09:39:02.976 	end
09:39:02.976 	if not Exists(select * from task_definitions where task_template_id=@id and milestone=40)
09:39:02.977 	begin
09:39:02.977 		insert into task_definitions (name,task_index,task_template_id,milestone,is_default) values('Post Work',0,@id,40,1);
09:39:02.977 	end
09:39:02.977 	if not Exists(select * from task_definitions where task_template_id=@id and milestone=50)
09:39:02.977 	begin
09:39:02.977 		insert into task_definitions (name,task_index,task_template_id,milestone,is_default) values('Post Work Done',0,@id,50,1);
09:39:02.977 	end
09:39:02.977 	fetch next from ids into @id
09:39:02.977 End   
09:39:02.977 close ids
09:39:02.977 Deallocate   ids
09:39:02.999 [+] Committing Transaction
09:39:03.002 [+] 110: AddIsDefaultToTaskDefinition migrated
09:39:03.003 -------------------------------------------------------------------------------
09:39:03.003 111: AddFeatureToggleForNewSingleCreateWR migrating
09:39:03.003 -------------------------------------------------------------------------------
09:39:03.004 [+] Beginning Transaction
09:39:03.006 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:03.007 [+] Committing Transaction
09:39:03.009 [+] 111: AddFeatureToggleForNewSingleCreateWR migrated
09:39:03.011 -------------------------------------------------------------------------------
09:39:03.011 112: AddColumnCompleteDateOnWorkRecordChecklistItem migrating
09:39:03.011 -------------------------------------------------------------------------------
09:39:03.011 [+] Beginning Transaction
09:39:03.012 [+] AlterTable work_record_checklist_items
09:39:03.013 [+] CreateColumn work_record_checklist_items complete_date DateTime
09:39:03.017 [+] Committing Transaction
09:39:03.019 [+] 112: AddColumnCompleteDateOnWorkRecordChecklistItem migrated
09:39:03.021 -------------------------------------------------------------------------------
09:39:03.021 113: AddOutOfScopeWorkTable migrating
09:39:03.021 -------------------------------------------------------------------------------
09:39:03.021 [+] Beginning Transaction
09:39:03.024 [+] CreateTable out_of_scope_work
09:39:03.028 [+] CreateForeignKey fk_out_of_scope_work_ref_work_records out_of_scope_work(work_record_id) work_records(id)
09:39:03.032 [+] CreateForeignKey fk_out_of_scope_work_ref_staff out_of_scope_work(owner_id) staff(id)
09:39:03.036 [+] Committing Transaction
09:39:03.038 [+] 113: AddOutOfScopeWorkTable migrated
09:39:03.040 -------------------------------------------------------------------------------
09:39:03.040 114: AddWorkRecordTaskAssignmentsTable migrating
09:39:03.040 -------------------------------------------------------------------------------
09:39:03.041 [+] Beginning Transaction
09:39:03.046 [+] CreateTable work_record_task_assignments
09:39:03.053 [+] CreateForeignKey fk_work_record_task_assignments_ref_work_records work_record_task_assignments(work_record_id) work_records(id)
09:39:03.055 [+] CreateForeignKey fk_work_record_task_assignments_ref_task_definitions work_record_task_assignments(task_definition_id) task_definitions(id)
09:39:03.058 [+] CreateForeignKey fk_work_record_task_assignments_ref_offices work_record_task_assignments(office_id) offices(id)
09:39:03.061 [+] CreateForeignKey fk_work_record_task_assignments_ref_staff work_record_task_assignments(staff_id) staff(id)
09:39:03.065 [+] Committing Transaction
09:39:03.068 [+] 114: AddWorkRecordTaskAssignmentsTable migrated
09:39:03.069 -------------------------------------------------------------------------------
09:39:03.069 115: RemoveMissingItemReceived migrating
09:39:03.069 -------------------------------------------------------------------------------
09:39:03.069 [+] Beginning Transaction
09:39:03.071 [+] DeleteColumn missing_items received
09:39:03.092 [+] Committing Transaction
09:39:03.094 [+] 115: RemoveMissingItemReceived migrated
09:39:03.094 -------------------------------------------------------------------------------
09:39:03.094 116: AddFkOnWorkRecordTasksTable migrating
09:39:03.094 -------------------------------------------------------------------------------
09:39:03.094 [+] Beginning Transaction
09:39:03.096 [+] ExecuteSqlStatement 
09:39:03.096                 DELETE FROM [dbo].[work_record_tasks]
09:39:03.097                 WHERE [work_record_id] NOT IN (
09:39:03.097 	                SELECT [id] FROM [dbo].[work_records]
09:39:03.097                 )  
09:39:03.097             
09:39:03.103 [+] CreateForeignKey fk_work_record_tasks_ref_work_records work_record_tasks(work_record_id) work_records(id)
09:39:03.107 [+] Committing Transaction
09:39:03.114 [+] 116: AddFkOnWorkRecordTasksTable migrated
09:39:03.117 -------------------------------------------------------------------------------
09:39:03.117 117: AddDefaultTaskTemplate migrating
09:39:03.118 -------------------------------------------------------------------------------
09:39:03.118 [+] Beginning Transaction
09:39:03.120 [+] AlterTable task_templates
09:39:03.122 [+] CreateColumn task_templates is_default Boolean
09:39:03.126 [+] ExecuteSqlStatement 
09:39:03.126                 INSERT INTO task_templates(name,owned_by,is_default) VALUES('DEFAULT_TASK_TEMPLATE', 0, 1)
09:39:03.126                 DECLARE @id bigint
09:39:03.126                 SELECT @id = @@IDENTITY
09:39:03.127                 INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default) VALUES('Initiated', @id, 0, 10, 1)
09:39:03.127                 INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default) VALUES('In Preparation', @id, 0, 20, 1)
09:39:03.127                 INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default) VALUES('In Review', @id, 0, 30, 1)
09:39:03.127                 INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default) VALUES('Complete', @id, 0, 40, 1)
09:39:03.127                 INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default) VALUES('Post Work', @id, 0, 50, 1)
09:39:03.127             
09:39:03.140 [+] Committing Transaction
09:39:03.142 [+] 117: AddDefaultTaskTemplate migrated
09:39:03.144 -------------------------------------------------------------------------------
09:39:03.144 118: ChangeColumnCompleteDateOnWorkRecordTaskToDatetime2 migrating
09:39:03.144 -------------------------------------------------------------------------------
09:39:03.145 [+] Beginning Transaction
09:39:03.147 [+] AlterTable work_record_tasks
09:39:03.149 [+] AlterColumn work_record_tasks complete_date 
09:39:03.156 [+] Committing Transaction
09:39:03.158 [+] 118: ChangeColumnCompleteDateOnWorkRecordTaskToDatetime2 migrated
09:39:03.159 -------------------------------------------------------------------------------
09:39:03.159 119: CreateDefaultTasksForWorkRecordWithoutTaskTemplateApplied migrating
09:39:03.159 -------------------------------------------------------------------------------
09:39:03.160 [+] Beginning Transaction
09:39:03.162 [+] ExecuteSqlStatement 
09:39:03.162 declare @default_task_template_id bigint, @id int, @milestone_name int
09:39:03.162 select top 1 @default_task_template_id= id from task_templates where is_default = 1
09:39:03.162 
09:39:03.163 declare ids cursor for
09:39:03.163 	SELECT id, current_milestone_name FROM work_records 
09:39:03.163 	WHERE id not in(
09:39:03.163 		SELECT DISTINCT work_record_id FROM work_record_task_templates
09:39:03.163 	) 
09:39:03.163 
09:39:03.164 open ids
09:39:03.164 fetch next from ids into @id, @milestone_name
09:39:03.164 While @@fetch_status=0     
09:39:03.164 Begin
09:39:03.164 	INSERT INTO work_record_task_templates(task_template_id, work_record_id) 
09:39:03.164 		VALUES(@default_task_template_id, @id)
09:39:03.165 	
09:39:03.165 	INSERT INTO work_record_tasks(complete_date, name, task_index, milestone, work_record_id, task_definition_id)
09:39:03.165 		SELECT m.date, td.name, td.task_index, td.milestone, @id, td.id
09:39:03.165 		FROM task_definitions td 
09:39:03.165 			INNER JOIN milestones m ON td.milestone = m.name
09:39:03.166 		WHERE td.task_template_id = @default_task_template_id 
09:39:03.166 			AND td.milestone <= @milestone_name
09:39:03.166 			AND m.work_record_id = @id
09:39:03.166 	
09:39:03.166 	fetch next from ids into @id, @milestone_name
09:39:03.166 End   
09:39:03.166 close ids
09:39:03.167 Deallocate ids
09:39:03.167             
09:39:03.192 [+] Committing Transaction
09:39:03.194 [+] 119: CreateDefaultTasksForWorkRecordWithoutTaskTemplateApplied migrated
09:39:03.195 -------------------------------------------------------------------------------
09:39:03.195 120: AddResponsibilityToWorkRecordReport migrating
09:39:03.196 -------------------------------------------------------------------------------
09:39:03.196 [+] Beginning Transaction
09:39:03.198 [+] AlterTable work_record_reports
09:39:03.199 [+] CreateColumn work_record_reports initial_reviewer Int64
09:39:03.203 [+] CreateColumn work_record_reports preparer Int64
09:39:03.206 [+] CreateColumn work_record_reports reviewer Int64
09:39:03.210 [+] CreateColumn work_record_reports signer Int64
09:39:03.213 [+] CreateColumn work_record_reports administrator Int64
09:39:03.216 [+] ExecuteSqlStatement update work_record_reports set initial_reviewer = milestones.responsibility_id
09:39:03.216 from work_record_reports inner join milestones on work_record_reports.work_record_id=milestones.work_record_id and milestones.name=10
09:39:03.225 [+] ExecuteSqlStatement update work_record_reports set preparer = milestones.responsibility_id
09:39:03.225 from work_record_reports inner join milestones on work_record_reports.work_record_id=milestones.work_record_id and milestones.name=20
09:39:03.235 [+] ExecuteSqlStatement update work_record_reports set reviewer = milestones.responsibility_id
09:39:03.235 from work_record_reports inner join milestones on work_record_reports.work_record_id=milestones.work_record_id and milestones.name=30
09:39:03.251 [+] ExecuteSqlStatement update work_record_reports set signer = milestones.responsibility_id
09:39:03.252 from work_record_reports inner join milestones on work_record_reports.work_record_id=milestones.work_record_id and milestones.name=40
09:39:03.260 [+] ExecuteSqlStatement update work_record_reports set administrator = milestones.responsibility_id
09:39:03.260 from work_record_reports inner join milestones on work_record_reports.work_record_id=milestones.work_record_id and milestones.name=50
09:39:03.270 [+] Committing Transaction
09:39:03.272 [+] 120: AddResponsibilityToWorkRecordReport migrated
09:39:03.274 -------------------------------------------------------------------------------
09:39:03.274 121: RemoveFeatureToggleBatchSendInvitationAndDeleteWorkRecord migrating
09:39:03.274 -------------------------------------------------------------------------------
09:39:03.275 [+] Beginning Transaction
09:39:03.277 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:03.279 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:03.281 [+] Committing Transaction
09:39:03.283 [+] 121: RemoveFeatureToggleBatchSendInvitationAndDeleteWorkRecord migrated
09:39:03.284 -------------------------------------------------------------------------------
09:39:03.284 122: MigrateWorkRecordReportCurrentlyWithData migrating
09:39:03.285 -------------------------------------------------------------------------------
09:39:03.285 [+] Beginning Transaction
09:39:03.287 [+] ExecuteSqlStatement update work_record_reports 
09:39:03.287 set currently_with = t.full_name from work_record_reports left outer join 
09:39:03.287 (select work_records.id, staff.last_name +', '+staff.First_Name+' '+ staff.middle_name as full_name 
09:39:03.287 from work_records inner join milestones on milestones.id = work_records.current_milestone_id
09:39:03.287 inner join staff on staff.id = milestones.responsibility_id) t on t.id=work_record_reports.work_record_id
09:39:03.304 [+] ExecuteSqlStatement update work_record_reports 
09:39:03.304 set questionnaire_contact = t.full_name from work_record_reports left outer join 
09:39:03.304 (select work_records.id, staff.last_name +', '+staff.First_Name+' '+ staff.middle_name as full_name 
09:39:03.304 from work_records inner join organizers on organizers.work_record_id = work_records.id
09:39:03.304 inner join staff on staff.id = organizers.contact_id) t on t.id=work_record_reports.work_record_id
09:39:03.315 [+] Committing Transaction
09:39:03.317 [+] 122: MigrateWorkRecordReportCurrentlyWithData migrated
09:39:03.318 -------------------------------------------------------------------------------
09:39:03.318 123: MigrateWorkRecordReportCurrentlyWithData2 migrating
09:39:03.318 -------------------------------------------------------------------------------
09:39:03.319 [+] Beginning Transaction
09:39:03.320 [+] ExecuteSqlStatement update work_record_reports 
09:39:03.320 set currently_with = t.full_name from work_record_reports left outer join 
09:39:03.320 (select work_records.id, staff.last_name +', '+staff.First_Name+' '+ isnull(staff.middle_name,'') as full_name 
09:39:03.320 from work_records inner join milestones on milestones.id = work_records.current_milestone_id
09:39:03.321 inner join staff on staff.id = milestones.responsibility_id) t on t.id=work_record_reports.work_record_id
09:39:03.335 [+] ExecuteSqlStatement update work_record_reports 
09:39:03.335 set questionnaire_contact = t.full_name from work_record_reports left outer join 
09:39:03.336 (select work_records.id, staff.last_name +', '+staff.First_Name+' '+ isnull(staff.middle_name,'') as full_name 
09:39:03.336 from work_records inner join organizers on organizers.work_record_id = work_records.id
09:39:03.336 inner join staff on staff.id = organizers.contact_id) t on t.id=work_record_reports.work_record_id
09:39:03.343 [+] Committing Transaction
09:39:03.345 [+] 123: MigrateWorkRecordReportCurrentlyWithData2 migrated
09:39:03.346 -------------------------------------------------------------------------------
09:39:03.347 124: AddFeatureToggleForNewBatchCreateWR migrating
09:39:03.347 -------------------------------------------------------------------------------
09:39:03.347 [+] Beginning Transaction
09:39:03.349 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:03.350 [+] Committing Transaction
09:39:03.352 [+] 124: AddFeatureToggleForNewBatchCreateWR migrated
09:39:03.353 -------------------------------------------------------------------------------
09:39:03.354 125: AddStatusColumnOnWorkRecordTaskTableAndWorkRecordChecklistTable migrating
09:39:03.354 -------------------------------------------------------------------------------
09:39:03.354 [+] Beginning Transaction
09:39:03.356 [+] AlterTable work_record_tasks
09:39:03.358 [+] CreateColumn work_record_tasks status Int32
09:39:03.361 [+] AlterTable work_record_checklist_items
09:39:03.362 [+] CreateColumn work_record_checklist_items status Int32
09:39:03.364 [+] ExecuteSqlStatement update [dbo].[work_record_tasks] set [status] = 1 where complete_date is not null
09:39:03.367 [+] ExecuteSqlStatement update [dbo].[work_record_checklist_items] set [status] = 1 where complete_date is not null
09:39:03.370 [+] Committing Transaction
09:39:03.372 [+] 125: AddStatusColumnOnWorkRecordTaskTableAndWorkRecordChecklistTable migrated
09:39:03.374 -------------------------------------------------------------------------------
09:39:03.375 126: MigrateDataForTaskHistory migrating
09:39:03.375 -------------------------------------------------------------------------------
09:39:03.379 [+] Beginning Transaction
09:39:03.383 [+] ExecuteSqlStatement update [dbo].[history_item] set [what] = 'Status', [from] = 'Created', [to] = 'Done' where [what] = 'CompleteDate' and [from] = ''
09:39:03.390 [+] Committing Transaction
09:39:03.392 [+] 126: MigrateDataForTaskHistory migrated
09:39:03.393 -------------------------------------------------------------------------------
09:39:03.394 127: AddFeatureToggleForNewAssigneeDetailUI migrating
09:39:03.394 -------------------------------------------------------------------------------
09:39:03.394 [+] Beginning Transaction
09:39:03.396 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:03.398 [+] Committing Transaction
09:39:03.400 [+] 127: AddFeatureToggleForNewAssigneeDetailUI migrated
09:39:03.401 -------------------------------------------------------------------------------
09:39:03.401 128: AddFeatureToggleForToDoList migrating
09:39:03.402 -------------------------------------------------------------------------------
09:39:03.402 [+] Beginning Transaction
09:39:03.405 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:03.406 [+] Committing Transaction
09:39:03.408 [+] 128: AddFeatureToggleForToDoList migrated
09:39:03.410 -------------------------------------------------------------------------------
09:39:03.410 129: AddColumnTaskAssignmentIdOnWorkRecordTasks migrating
09:39:03.410 -------------------------------------------------------------------------------
09:39:03.411 [+] Beginning Transaction
09:39:03.413 [+] AlterTable work_record_tasks
09:39:03.414 [+] CreateColumn work_record_tasks task_assignment_id Int64
09:39:03.417 [+] CreateForeignKey fk_work_record_tasks_ref_work_record_task_assignments work_record_tasks(task_assignment_id) work_record_task_assignments(id)
09:39:03.420 [+] Committing Transaction
09:39:03.423 [+] 129: AddColumnTaskAssignmentIdOnWorkRecordTasks migrated
09:39:03.424 -------------------------------------------------------------------------------
09:39:03.424 130: MigrateDataForMissingItemReceivedHistory migrating
09:39:03.424 -------------------------------------------------------------------------------
09:39:03.425 [+] Beginning Transaction
09:39:03.426 [+] ExecuteSqlStatement update [dbo].[history_item] set [what] = 'Received' where [what] = 'ReceivedAt'
09:39:03.430 [+] Committing Transaction
09:39:03.433 [+] 130: MigrateDataForMissingItemReceivedHistory migrated
09:39:03.434 -------------------------------------------------------------------------------
09:39:03.434 131: AddPersonalTask migrating
09:39:03.434 -------------------------------------------------------------------------------
09:39:03.434 [+] Beginning Transaction
09:39:03.437 [+] CreateTable personal_tasks
09:39:03.444 [+] CreateForeignKey fk_personal_tasks_ref_engagements personal_tasks(engagement_id) engagements(id)
09:39:03.448 [+] CreateForeignKey fk_personal_tasks_ref_assignees personal_tasks(assignee_id) assignees(id)
09:39:03.451 [+] CreateForeignKey fk_personal_tasks_ref_staff personal_tasks(assign_to) staff(id)
09:39:03.452 [+] CreateForeignKey fk_personal_tasks_ref_staff_created_by personal_tasks(created_by) staff(id)
09:39:03.454 [+] Committing Transaction
09:39:03.455 [+] 131: AddPersonalTask migrated
09:39:03.455 -------------------------------------------------------------------------------
09:39:03.455 132: AddColumnTaskAssignmentsOnWorkRecordTasks migrating
09:39:03.455 -------------------------------------------------------------------------------
09:39:03.455 [+] Beginning Transaction
09:39:03.456 [+] AlterTable task_definitions
09:39:03.457 [+] CreateColumn task_definitions is_retired Boolean
09:39:03.459 [+] AlterTable work_record_tasks
09:39:03.460 [+] CreateColumn work_record_tasks is_actived Boolean
09:39:03.461 [+] AlterTable work_record_tasks
09:39:03.462 [+] CreateColumn work_record_tasks responsible_office_id Int64
09:39:03.463 [+] CreateForeignKey fk_work_record_tasks_ref_offices work_record_tasks(responsible_office_id) offices(id)
09:39:03.464 [+] AlterTable work_record_tasks
09:39:03.464 [+] CreateColumn work_record_tasks responsibility_id Int64
09:39:03.466 [+] CreateForeignKey fk_work_record_tasks_ref_staff work_record_tasks(responsibility_id) staff(id)
09:39:03.467 [+] Committing Transaction
09:39:03.468 [+] 132: AddColumnTaskAssignmentsOnWorkRecordTasks migrated
09:39:03.468 -------------------------------------------------------------------------------
09:39:03.468 133: MigrateMileStoneResposibleToWorkRecordTaskAssignments migrating
09:39:03.468 -------------------------------------------------------------------------------
09:39:03.468 [+] Beginning Transaction
09:39:03.468 [+] ExecuteSqlStatement 
09:39:03.468 UPDATE work_record_tasks 
09:39:03.468 SET    responsible_office_id = ms.responsible_office_id, 
09:39:03.468        responsibility_id = ms.responsibility_id, 
09:39:03.468        is_actived = 1 
09:39:03.468 FROM   milestones ms, 
09:39:03.468        work_records wr 
09:39:03.469 WHERE  ms.name = work_record_tasks.milestone 
09:39:03.469        AND ms.work_record_id = wr.id 
09:39:03.469        AND work_record_tasks.work_record_id = wr.id
09:39:03.469 
09:39:03.476 [+] Committing Transaction
09:39:03.477 [+] 133: MigrateMileStoneResposibleToWorkRecordTaskAssignments migrated
09:39:03.477 -------------------------------------------------------------------------------
09:39:03.477 134: AddToDoItemTable migrating
09:39:03.477 -------------------------------------------------------------------------------
09:39:03.478 [+] Beginning Transaction
09:39:03.478 [+] CreateTable todo_items
09:39:03.481 [+] CreateForeignKey fk_todo_items_ref_personal_tasks todo_items(personal_task_id) personal_tasks(id)
09:39:03.482 [+] CreateForeignKey fk_todo_items_ref_work_record_tasks todo_items(work_record_task_id) work_record_tasks(id)
09:39:03.483 [+] Committing Transaction
09:39:03.484 [+] 134: AddToDoItemTable migrated
09:39:03.484 -------------------------------------------------------------------------------
09:39:03.485 135: AddFeatureToggleForToBatchUpdateWorkMilestones migrating
09:39:03.485 -------------------------------------------------------------------------------
09:39:03.485 [+] Beginning Transaction
09:39:03.486 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:03.486 [+] Committing Transaction
09:39:03.487 [+] 135: AddFeatureToggleForToBatchUpdateWorkMilestones migrated
09:39:03.487 -------------------------------------------------------------------------------
09:39:03.487 136: AddColumnResponsibilityOnWorkRecordChecklistItems migrating
09:39:03.487 -------------------------------------------------------------------------------
09:39:03.487 [+] Beginning Transaction
09:39:03.488 [+] AlterTable work_record_checklist_items
09:39:03.489 [+] CreateColumn work_record_checklist_items responsible_office_id Int64
09:39:03.490 [+] CreateForeignKey fk_work_record_checklist_items_ref_offices work_record_checklist_items(responsible_office_id) offices(id)
09:39:03.491 [+] AlterTable work_record_checklist_items
09:39:03.492 [+] CreateColumn work_record_checklist_items responsibility_id Int64
09:39:03.494 [+] CreateForeignKey fk_work_record_checklist_items_ref_staff work_record_checklist_items(responsibility_id) staff(id)
09:39:03.496 [+] Committing Transaction
09:39:03.497 [+] 136: AddColumnResponsibilityOnWorkRecordChecklistItems migrated
09:39:03.498 -------------------------------------------------------------------------------
09:39:03.498 137: ChangeAssignmentColumnOnWorkRecordTaskAssignments migrating
09:39:03.498 -------------------------------------------------------------------------------
09:39:03.499 [+] Beginning Transaction
09:39:03.500 [+] DeleteForeignKey fk_work_record_task_assignments_ref_offices work_record_task_assignments ()  ()
09:39:03.503 [+] DeleteForeignKey fk_work_record_task_assignments_ref_staff work_record_task_assignments ()  ()
09:39:03.512 [+] DeleteColumn work_record_task_assignments office_id, staff_id
09:39:03.538 [+] AlterTable work_record_task_assignments
09:39:03.539 [+] CreateColumn work_record_task_assignments responsible_office_id Int64
09:39:03.543 [+] CreateForeignKey fk_work_record_task_assignments_ref_offices work_record_task_assignments(responsible_office_id) offices(id)
09:39:03.546 [+] AlterTable work_record_task_assignments
09:39:03.547 [+] CreateColumn work_record_task_assignments responsibility_id Int64
09:39:03.550 [+] CreateForeignKey fk_work_record_task_assignments_ref_staff work_record_task_assignments(responsibility_id) staff(id)
09:39:03.551 [+] AlterTable work_record_task_assignments
09:39:03.551 [+] CreateColumn work_record_task_assignments milestone Int32
09:39:03.555 [+] Committing Transaction
09:39:03.557 [+] 137: ChangeAssignmentColumnOnWorkRecordTaskAssignments migrated
09:39:03.558 -------------------------------------------------------------------------------
09:39:03.558 138: MigrateTaskAssignmentToWorkRecordTaskAssignments migrating
09:39:03.558 -------------------------------------------------------------------------------
09:39:03.559 [+] Beginning Transaction
09:39:03.560 [+] ExecuteSqlStatement 
09:39:03.561 /*migrate from milestone to assignments*/ 
09:39:03.561 
09:39:03.561 INSERT INTO [dbo].[work_record_task_assignments] 
09:39:03.561             ([work_record_id], 
09:39:03.561              [task_definition_id], 
09:39:03.561              [responsible_office_id], 
09:39:03.561              [responsibility_id], 
09:39:03.562              [milestone]) 
09:39:03.562 (SELECT m.work_record_id, 
09:39:03.562         td.id, 
09:39:03.562         m.responsible_office_id, 
09:39:03.562         m.responsibility_id, 
09:39:03.562         td.milestone 
09:39:03.562  FROM   milestones m 
09:39:03.563         INNER JOIN task_definitions td 
09:39:03.563                 ON m.name = td.milestone 
09:39:03.563         INNER JOIN work_record_task_templates wrtt 
09:39:03.563                ON m.work_record_id = wrtt.work_record_id and wrtt.task_template_id = td.task_template_id 
09:39:03.563  WHERE  m.responsible_office_id IS NOT NULL) 
09:39:03.563 
09:39:03.564 /*migrate from work record task to assignments*/ 
09:39:03.564 
09:39:03.564 INSERT INTO [dbo].[work_record_task_assignments] 
09:39:03.564             ([work_record_id], 
09:39:03.564              [task_definition_id], 
09:39:03.564              [responsible_office_id], 
09:39:03.564              [responsibility_id], 
09:39:03.565              [milestone]) 
09:39:03.565 (SELECT wrt.work_record_id, 
09:39:03.565         wrt.task_definition_id, 
09:39:03.565         wrt.responsible_office_id, 
09:39:03.565         wrt.responsibility_id, 
09:39:03.565         wrt.milestone 
09:39:03.566  FROM   work_record_tasks wrt 
09:39:03.566         INNER JOIN (SELECT * 
09:39:03.566                     FROM   milestones 
09:39:03.566                     WHERE  responsible_office_id IS NULL AND name<> 0 AND name<>999) m 
09:39:03.566                 ON m.work_record_id = wrt.work_record_id 
09:39:03.566                    AND wrt.milestone = m.name) 
09:39:03.567 
09:39:03.567 /*delete not actived tasks from work record task*/
09:39:03.567 DELETE FROM work_record_tasks 
09:39:03.567 WHERE  is_actived = 0 
09:39:03.567 
09:39:03.567 /*set persist assignment to work record task*/
09:39:03.567 UPDATE work_record_tasks 
09:39:03.568 SET    task_assignment_id = wrtt.id 
09:39:03.568 FROM   work_record_tasks wrt 
09:39:03.568        INNER JOIN work_record_task_assignments wrtt 
09:39:03.568                ON wrt.work_record_id = wrtt.work_record_id 
09:39:03.568                   AND wrt.task_definition_id = wrtt.task_definition_id
09:39:03.568 
09:39:03.613 [+] Committing Transaction
09:39:03.614 [+] 138: MigrateTaskAssignmentToWorkRecordTaskAssignments migrated
09:39:03.614 -------------------------------------------------------------------------------
09:39:03.614 139: AddDeletedTaskDefinitionBack migrating
09:39:03.614 -------------------------------------------------------------------------------
09:39:03.615 [+] Beginning Transaction
09:39:03.615 [+] ExecuteSqlStatement 
09:39:03.615 
09:39:03.616 DECLARE @milestone INT 
09:39:03.616 DECLARE @name NVARCHAR(max) 
09:39:03.616 DECLARE @task_definition_id BIGINT 
09:39:03.616 DECLARE @task_template_id BIGINT 
09:39:03.616 
09:39:03.616 DECLARE add_task_definition CURSOR FOR 
09:39:03.616   SELECT wrt.milestone, 
09:39:03.616          wrt.name, 
09:39:03.616          wrt.task_definition_id, 
09:39:03.616          wrtt.task_template_id 
09:39:03.616   FROM   work_record_tasks wrt, 
09:39:03.616          work_record_task_templates wrtt 
09:39:03.616   WHERE  task_definition_id IN (SELECT task_definition_id 
09:39:03.616                                 FROM   (SELECT DISTINCT task_definition_id 
09:39:03.616                                         FROM   work_record_tasks) a 
09:39:03.616                                 WHERE  a.task_definition_id NOT IN (SELECT id 
09:39:03.617                                                                     FROM 
09:39:03.617                                        task_definitions)) 
09:39:03.617          AND wrt.work_record_id = wrtt.work_record_id 
09:39:03.617 OPEN add_task_definition 
09:39:03.617 
09:39:03.617 FETCH next FROM add_task_definition INTO @milestone, @name, @task_definition_id, @task_template_id 
09:39:03.617 
09:39:03.617 WHILE @@fetch_status = 0 
09:39:03.617   BEGIN 
09:39:03.617       INSERT INTO task_definitions 
09:39:03.617                   (milestone, name, task_template_id, is_default, is_retired, task_index) 
09:39:03.620       VALUES      (@milestone, @name, @task_template_id, 0, 1, 0) 
09:39:03.620 
09:39:03.620       UPDATE work_record_tasks 
09:39:03.620       SET    task_definition_id = @@Identity 
09:39:03.620       WHERE  task_definition_id = @task_definition_id 
09:39:03.620 
09:39:03.620       UPDATE work_record_task_assignments 
09:39:03.620       SET    task_definition_id = @@Identity 
09:39:03.621       WHERE  task_definition_id = @task_definition_id 
09:39:03.621 
09:39:03.621       FETCH next FROM add_task_definition INTO @milestone, @name, 
09:39:03.621       @task_definition_id, @task_template_id 
09:39:03.621   END 
09:39:03.621 
09:39:03.621 CLOSE add_task_definition 
09:39:03.621 
09:39:03.621 DEALLOCATE add_task_definition 
09:39:03.621 
09:39:03.621 DECLARE @id INT 
09:39:03.621 DECLARE ids CURSOR FOR 
09:39:03.621   SELECT id 
09:39:03.621   FROM   work_records 
09:39:03.621 
09:39:03.621 OPEN ids 
09:39:03.621 
09:39:03.621 FETCH next FROM ids INTO @id 
09:39:03.622 
09:39:03.622 WHILE @@fetch_status = 0 
09:39:03.622   BEGIN 
09:39:03.622       INSERT INTO work_record_task_assignments 
09:39:03.622                   (work_record_id, 
09:39:03.622                    task_definition_id, 
09:39:03.622                    responsible_office_id, 
09:39:03.622                    responsibility_id, 
09:39:03.622                    milestone) 
09:39:03.622       SELECT wrt.work_record_id, 
09:39:03.622              wrt.task_definition_id, 
09:39:03.622              wr.responsible_office_id, 
09:39:03.622              NULL, 
09:39:03.622              wrt.milestone 
09:39:03.622       FROM   work_record_tasks wrt 
09:39:03.622              LEFT JOIN work_record_task_assignments wrta 
09:39:03.623                     ON wrt.work_record_id = wrta.work_record_id 
09:39:03.623                        AND wrt.task_definition_id = wrta.task_definition_id 
09:39:03.623              INNER JOIN work_records wr 
09:39:03.623                      ON wr.id = wrt.work_record_id 
09:39:03.623       WHERE  wrta.work_record_id IS NULL 
09:39:03.623              AND wrt.work_record_id = @id 
09:39:03.623 
09:39:03.623       UPDATE work_record_tasks 
09:39:03.623       SET    task_assignment_id = wrta.id 
09:39:03.623       FROM   work_record_task_assignments wrta 
09:39:03.623              INNER JOIN work_record_tasks wrt 
09:39:03.623                      ON wrt.work_record_id = wrta.work_record_id 
09:39:03.623                         AND wrt.task_definition_id = wrta.task_definition_id 
09:39:03.623       WHERE  wrt.work_record_id = @id 
09:39:03.623              AND wrt.task_assignment_id IS NULL 
09:39:03.623 
09:39:03.623       FETCH next FROM ids INTO @id 
09:39:03.623   END 
09:39:03.624 
09:39:03.624 CLOSE ids 
09:39:03.624 DEALLOCATE ids 
09:39:03.624 
09:39:03.637 [+] Committing Transaction
09:39:03.639 [+] 139: AddDeletedTaskDefinitionBack migrated
09:39:03.640 -------------------------------------------------------------------------------
09:39:03.640 140: ValidateMigrationResult migrating
09:39:03.641 -------------------------------------------------------------------------------
09:39:03.641 [+] Beginning Transaction
09:39:03.643 [+] ExecuteSqlStatement 
09:39:03.643 IF  EXISTS (SELECT * FROM work_record_tasks where task_definition_id is null)
09:39:03.644 BEGIN
09:39:03.644 	RAISERROR (N'task definition id cannot be null in work record task table',  16, 1);
09:39:03.644 END
09:39:03.644 IF  EXISTS (SELECT * FROM work_record_tasks where task_assignment_id is null)
09:39:03.644 BEGIN
09:39:03.644 	RAISERROR (N'task assignment id cannot be null in work record task table',  16, 1);
09:39:03.644 END
09:39:03.644 IF  EXISTS (SELECT * FROM work_record_task_assignments where responsible_office_id  is null)
09:39:03.644 BEGIN
09:39:03.644 	RAISERROR (N'responsible_office_id cannot be null in work record task assignment table',  16, 1);
09:39:03.645 END
09:39:03.645 
09:39:03.645 IF  EXISTS (select work_record_id from work_record_task_assignments group by work_record_id, task_definition_id having count(work_record_id) >=2)
09:39:03.645 BEGIN
09:39:03.645 	RAISERROR (N'has dupicate task definition id for the same work record in work record task assignment table',  16, 1);
09:39:03.645 END
09:39:03.645 
09:39:03.646 IF  EXISTS (select work_record_id from work_record_tasks group by work_record_id, task_definition_id having count(work_record_id) >=2)
09:39:03.646 BEGIN
09:39:03.646 	RAISERROR (N'Dupicate task definition id exists for the same work record in work record task table',  16, 1);
09:39:03.646 END
09:39:03.646 
09:39:03.646 IF  EXISTS (
09:39:03.646 			SELECT * FROM work_record_tasks wrt LEFT JOIN work_record_task_assignments wrta 
09:39:03.646             ON wrt.work_record_id = wrta.work_record_id  AND wrt.task_definition_id = wrta.task_definition_id 
09:39:03.647 			WHERE  wrta.id IS NULL )
09:39:03.647 BEGIN
09:39:03.647 	RAISERROR (N'Some tasks do not have task assignment',  16, 1);
09:39:03.647 END
09:39:03.647 
09:39:03.663 [+] Committing Transaction
09:39:03.665 [+] 140: ValidateMigrationResult migrated
09:39:03.667 -------------------------------------------------------------------------------
09:39:03.667 141: TaskAssignmentIndex migrating
09:39:03.668 -------------------------------------------------------------------------------
09:39:03.668 [+] Beginning Transaction
09:39:03.670 [+] CreateIndex work_record_task_assignments (work_record_id)
09:39:03.673 [+] CreateIndex work_record_task_templates (work_record_id)
09:39:03.676 [+] CreateIndex work_record_tasks (work_record_id)
09:39:03.680 [+] Committing Transaction
09:39:03.683 [+] 141: TaskAssignmentIndex migrated
09:39:03.685 -------------------------------------------------------------------------------
09:39:03.685 142: AddColumnHttpStatusInBatchItem migrating
09:39:03.685 -------------------------------------------------------------------------------
09:39:03.686 [+] Beginning Transaction
09:39:03.688 [+] AlterTable batch_items
09:39:03.689 [+] CreateColumn batch_items http_status Int16
09:39:03.694 [+] Committing Transaction
09:39:03.697 [+] 142: AddColumnHttpStatusInBatchItem migrated
09:39:03.700 -------------------------------------------------------------------------------
09:39:03.701 143: AddDefaultResponsibleOfficeToChecklistItem migrating
09:39:03.702 -------------------------------------------------------------------------------
09:39:03.702 [+] Beginning Transaction
09:39:03.705 [+] ExecuteSqlStatement 
09:39:03.706                 UPDATE c
09:39:03.706                 SET c.responsible_office_id = w.responsible_office_id
09:39:03.706                 FROM work_record_checklist_items c INNER JOIN work_records w ON c.work_record_id = w.id
09:39:03.706                 WHERE c.responsible_office_id IS NULL                
09:39:03.707             
09:39:03.718 [+] Committing Transaction
09:39:03.721 [+] 143: AddDefaultResponsibleOfficeToChecklistItem migrated
09:39:03.722 -------------------------------------------------------------------------------
09:39:03.723 144: MigrateToSupportMultipleWorkRecordNotes migrating
09:39:03.723 -------------------------------------------------------------------------------
09:39:03.723 [+] Beginning Transaction
09:39:03.726 [+] CreateTable work_record_notes
09:39:03.730 [+] CreateForeignKey fk_work_record_notes_ref_work_records work_record_notes(work_record_id) work_records(id)
09:39:03.734 [+] CreateIndex work_record_notes (work_record_id)
09:39:03.737 [+] ExecuteSqlStatement 
09:39:03.737 DECLARE @work_record_id BIGINT
09:39:03.737 DECLARE @work_record_note NVARCHAR(2000)
09:39:03.737 
09:39:03.738 DECLARE add_notes CURSOR FOR
09:39:03.738 	SELECT wr.id,wr.notes
09:39:03.738 	FROM work_records wr
09:39:03.738 	WHERE wr.notes is not null and Len(wr.notes) > 0
09:39:03.738 	
09:39:03.738 OPEN add_notes
09:39:03.739 	
09:39:03.739 FETCH next FROM add_notes INTO @work_record_id,@work_record_note
09:39:03.739 
09:39:03.739 WHILE @@fetch_status = 0
09:39:03.739 	BEGIN
09:39:03.739 		INSERT INTO work_record_notes
09:39:03.739 			(work_record_id,content)
09:39:03.740 		VALUES(@work_record_id,@work_record_note)
09:39:03.740 		FETCH next FROM add_notes INTO @work_record_id,@work_record_note
09:39:03.740 	END
09:39:03.740 
09:39:03.740 CLOSE add_notes
09:39:03.740 DEALLOCATE add_notes
09:39:03.740 
09:39:03.744 [+] DeleteColumn work_records notes
09:39:03.762 [+] Committing Transaction
09:39:03.769 [+] 144: MigrateToSupportMultipleWorkRecordNotes migrated
09:39:03.770 -------------------------------------------------------------------------------
09:39:03.770 145: AddFeatureToggleForAdvanceToDoList migrating
09:39:03.770 -------------------------------------------------------------------------------
09:39:03.770 [+] Beginning Transaction
09:39:03.774 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:03.776 [+] Committing Transaction
09:39:03.779 [+] 145: AddFeatureToggleForAdvanceToDoList migrated
09:39:03.780 -------------------------------------------------------------------------------
09:39:03.780 146: AddChecklistIdColumnToDoItemTableAndGenerateWorkRecordTaskRelatedToDoItems migrating
09:39:03.781 -------------------------------------------------------------------------------
09:39:03.781 [+] Beginning Transaction
09:39:03.783 [+] AlterTable todo_items
09:39:03.784 [+] CreateColumn todo_items checklist_item_id Int64
09:39:03.787 [+] CreateForeignKey fk_todo_items_ref_work_record_checklist_items todo_items(checklist_item_id) work_record_checklist_items(id)
09:39:03.791 [+] ExecuteSqlStatement 
09:39:03.791               insert into todo_items([type]
09:39:03.791                        ,[status]
09:39:03.791                        ,[updated_time]
09:39:03.791                        ,[planned_date]
09:39:03.791                        ,[personal_task_id]
09:39:03.791                        ,[section]
09:39:03.792                        ,[work_record_task_id]
09:39:03.792                        ,[checklist_item_id])
09:39:03.792               select 0
09:39:03.792 		            ,0
09:39:03.792 		            ,getutcdate()
09:39:03.792 		            ,NULL
09:39:03.793 		            ,NULL
09:39:03.793 		            ,0
09:39:03.793 		            ,id
09:39:03.793 		            ,NULL
09:39:03.793               from [work_record_tasks]
09:39:03.793               where id not in (
09:39:03.794 	            select work_record_task_id from todo_items where work_record_task_id is not null
09:39:03.794               )
09:39:03.804 [+] ExecuteSqlStatement 
09:39:03.804               insert into todo_items([type]
09:39:03.804                        ,[status]
09:39:03.804                        ,[updated_time]
09:39:03.805                        ,[planned_date]
09:39:03.805                        ,[personal_task_id]
09:39:03.805                        ,[section]
09:39:03.805                        ,[work_record_task_id]
09:39:03.805                        ,[checklist_item_id])
09:39:03.805               select 2
09:39:03.805 		            ,0
09:39:03.805 		            ,getutcdate()
09:39:03.805 		            ,NULL
09:39:03.805 		            ,NULL
09:39:03.805 		            ,0
09:39:03.805                     ,NULL
09:39:03.805 		            ,id
09:39:03.805               from [work_record_checklist_items]
09:39:03.806               where id not in (
09:39:03.806 	            select checklist_item_id from todo_items where checklist_item_id is not null
09:39:03.806               )
09:39:03.814 [+] Committing Transaction
09:39:03.816 [+] 146: AddChecklistIdColumnToDoItemTableAndGenerateWorkRecordTaskRelatedToDoItems migrated
09:39:03.817 -------------------------------------------------------------------------------
09:39:03.818 147: RenameColumnHttpStatusInBatchItem migrating
09:39:03.818 -------------------------------------------------------------------------------
09:39:03.819 [+] Beginning Transaction
09:39:03.820 [+] RenameColumn batch_items http_status to http_status_code
09:39:03.824 [+] Committing Transaction
09:39:03.826 [+] 147: RenameColumnHttpStatusInBatchItem migrated
09:39:03.827 -------------------------------------------------------------------------------
09:39:03.827 148: RemoveFeatureToggleAdditionalService migrating
09:39:03.828 -------------------------------------------------------------------------------
09:39:03.828 [+] Beginning Transaction
09:39:03.834 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:03.839 [+] Committing Transaction
09:39:03.840 [+] 148: RemoveFeatureToggleAdditionalService migrated
09:39:03.841 -------------------------------------------------------------------------------
09:39:03.842 149: AddFeatureToggleForSecurityModel migrating
09:39:03.842 -------------------------------------------------------------------------------
09:39:03.842 [+] Beginning Transaction
09:39:03.843 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:03.846 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:03.847 [+] Committing Transaction
09:39:03.849 [+] 149: AddFeatureToggleForSecurityModel migrated
09:39:03.850 -------------------------------------------------------------------------------
09:39:03.851 150: AddAssigneeIdIndexIntoFamilyMembers migrating
09:39:03.851 -------------------------------------------------------------------------------
09:39:03.851 [+] Beginning Transaction
09:39:03.853 [+] CreateIndex family_members (assignee_id)
09:39:03.856 [+] Committing Transaction
09:39:03.858 [+] 150: AddAssigneeIdIndexIntoFamilyMembers migrated
09:39:03.859 -------------------------------------------------------------------------------
09:39:03.860 151: AddAssigneeIdIndexIntoAssigneeContact migrating
09:39:03.860 -------------------------------------------------------------------------------
09:39:03.860 [+] Beginning Transaction
09:39:03.862 [+] CreateIndex assignee_contact (assignee_id)
09:39:03.865 [+] Committing Transaction
09:39:03.867 [+] 151: AddAssigneeIdIndexIntoAssigneeContact migrated
09:39:03.868 -------------------------------------------------------------------------------
09:39:03.869 152: AddColumnFirstFinalReminderInWorkRecordReports migrating
09:39:03.869 -------------------------------------------------------------------------------
09:39:03.869 [+] Beginning Transaction
09:39:03.871 [+] AlterTable work_record_reports
09:39:03.872 [+] CreateColumn work_record_reports first_reminder DateTime
09:39:03.876 [+] AlterTable work_record_reports
09:39:03.877 [+] CreateColumn work_record_reports final_reminder DateTime
09:39:03.881 [+] Committing Transaction
09:39:03.883 [+] 152: AddColumnFirstFinalReminderInWorkRecordReports migrated
09:39:03.887 -------------------------------------------------------------------------------
09:39:03.887 153: AddColumnFirstFinalReminderInOrganizers migrating
09:39:03.887 -------------------------------------------------------------------------------
09:39:03.887 [+] Beginning Transaction
09:39:03.889 [+] AlterTable organizers
09:39:03.890 [+] CreateColumn organizers first_reminder DateTime
09:39:03.893 [+] AlterTable organizers
09:39:03.900 [+] CreateColumn organizers final_reminder DateTime
09:39:03.905 [+] Committing Transaction
09:39:03.907 [+] 153: AddColumnFirstFinalReminderInOrganizers migrated
09:39:03.908 -------------------------------------------------------------------------------
09:39:03.909 154: AddFeatureToggleForWorkRecordInfoAccessControlList migrating
09:39:03.909 -------------------------------------------------------------------------------
09:39:03.909 [+] Beginning Transaction
09:39:03.911 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:03.913 [+] Committing Transaction
09:39:03.914 [+] 154: AddFeatureToggleForWorkRecordInfoAccessControlList migrated
09:39:03.916 -------------------------------------------------------------------------------
09:39:03.916 155: RemoveFeatureToggleForQuestionnaireReminder migrating
09:39:03.916 -------------------------------------------------------------------------------
09:39:03.916 [+] Beginning Transaction
09:39:03.918 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:03.920 [+] Committing Transaction
09:39:03.922 [+] 155: RemoveFeatureToggleForQuestionnaireReminder migrated
09:39:03.924 -------------------------------------------------------------------------------
09:39:03.924 156: CreateAssigneeReports migrating
09:39:03.924 -------------------------------------------------------------------------------
09:39:03.924 [+] Beginning Transaction
09:39:03.926 [+] CreateTable assignee_reports
09:39:03.931 [+] Committing Transaction
09:39:03.933 [+] 156: CreateAssigneeReports migrated
09:39:03.934 -------------------------------------------------------------------------------
09:39:03.934 157: AddChecklistFieldsIntoWorkRecordReport migrating
09:39:03.934 -------------------------------------------------------------------------------
09:39:03.934 [+] Beginning Transaction
09:39:03.936 [+] AlterTable work_record_reports
09:39:03.938 [+] CreateColumn work_record_reports has_checklist_status Boolean
09:39:03.941 [+] AlterTable work_record_reports
09:39:03.942 [+] CreateColumn work_record_reports checklist_complete_date DateTime
09:39:03.945 [+] Committing Transaction
09:39:03.947 [+] 157: AddChecklistFieldsIntoWorkRecordReport migrated
09:39:03.949 -------------------------------------------------------------------------------
09:39:03.949 158: RenameFeatureToggleForAssigneeInfoAccessControlList migrating
09:39:03.949 -------------------------------------------------------------------------------
09:39:03.949 [+] Beginning Transaction
09:39:03.958 [+] UpdateData 
09:39:03.971 [+] Committing Transaction
09:39:03.972 [+] 158: RenameFeatureToggleForAssigneeInfoAccessControlList migrated
09:39:03.973 -------------------------------------------------------------------------------
09:39:03.973 159: AddColumnSubscriptionsInAssigneeReports migrating
09:39:03.973 -------------------------------------------------------------------------------
09:39:03.973 [+] Beginning Transaction
09:39:03.973 [+] AlterTable assignee_reports
09:39:03.974 [+] CreateColumn assignee_reports subscription Int16
09:39:03.975 [+] Committing Transaction
09:39:03.976 [+] 159: AddColumnSubscriptionsInAssigneeReports migrated
09:39:03.977 -------------------------------------------------------------------------------
09:39:03.977 160: MigrateToSupportWorkRecordReportChecklistStatus migrating
09:39:03.977 -------------------------------------------------------------------------------
09:39:03.977 [+] Beginning Transaction
09:39:03.977 [+] ExecuteSqlStatement 
09:39:03.978 DECLARE @has_checklist_status BIT
09:39:03.978 DECLARE @work_record_id BIGINT
09:39:03.978 DECLARE @checklist_status INT
09:39:03.978 
09:39:03.978 UPDATE work_record_reports set has_checklist_status = 0
09:39:03.978 
09:39:03.978 DECLARE all_checklist_items CURSOR FOR
09:39:03.978 	SELECT item.work_record_id
09:39:03.978 	FROM work_record_checklist_items item
09:39:03.978 	ORDER BY complete_date
09:39:03.978 
09:39:03.978 OPEN all_checklist_items
09:39:03.978 FETCH NEXT FROM all_checklist_items INTO @work_record_id
09:39:03.978 
09:39:03.978 WHILE @@fetch_status = 0
09:39:03.978 	BEGIN
09:39:03.978 		UPDATE work_record_reports set has_checklist_status = 1 WHERE work_record_id = @work_record_id
09:39:03.978 		
09:39:03.978 		FETCH NEXT FROM all_checklist_items INTO @work_record_id
09:39:03.979 	END
09:39:03.979 
09:39:03.979 CLOSE all_checklist_items
09:39:03.979 DEALLOCATE all_checklist_items
09:39:03.982 [+] Committing Transaction
09:39:03.983 [+] 160: MigrateToSupportWorkRecordReportChecklistStatus migrated
09:39:03.984 -------------------------------------------------------------------------------
09:39:03.984 161: MigrateToSupportWorkRecordReportCompleteDate migrating
09:39:03.984 -------------------------------------------------------------------------------
09:39:03.984 [+] Beginning Transaction
09:39:03.985 [+] ExecuteSqlStatement 
09:39:03.985 DECLARE @work_record_id BIGINT
09:39:03.985 
09:39:03.985 DECLARE all_work_record_reports CURSOR FOR
09:39:03.985 	select work_record_id from work_record_reports
09:39:03.985 	
09:39:03.985 OPEN all_work_record_reports
09:39:03.985 FETCH NEXT FROM all_work_record_reports INTO @work_record_id
09:39:03.985 
09:39:03.985 WHILE @@fetch_status = 0
09:39:03.985 	
09:39:03.985 	BEGIN
09:39:03.985 		IF (select count(id) from work_record_checklist_items where work_record_id = @work_record_id AND status = 0) = 0
09:39:03.985 			BEGIN
09:39:03.985 				UPDATE work_record_reports 
09:39:03.985 				SET checklist_complete_date = (select top 1 complete_date 
09:39:03.986 												from work_record_checklist_items 
09:39:03.986 												where work_record_id = @work_record_id 
09:39:03.986 												order by complete_date desc)
09:39:03.986 				WHERE work_record_id = @work_record_id
09:39:03.986 			END
09:39:03.986 		FETCH NEXT FROM all_work_record_reports INTO @work_record_id
09:39:03.986 	END
09:39:03.986 
09:39:03.986 CLOSE all_work_record_reports
09:39:03.986 DEALLOCATE all_work_record_reports
09:39:03.992 [+] Committing Transaction
09:39:03.994 [+] 161: MigrateToSupportWorkRecordReportCompleteDate migrated
09:39:03.995 -------------------------------------------------------------------------------
09:39:03.995 162: AddFeatureToggleForUserAccessControl migrating
09:39:03.995 -------------------------------------------------------------------------------
09:39:03.995 [+] Beginning Transaction
09:39:03.997 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:03.999 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:04.000 [+] Committing Transaction
09:39:04.002 [+] 162: AddFeatureToggleForUserAccessControl migrated
09:39:04.003 -------------------------------------------------------------------------------
09:39:04.003 163: AddWorkRecordNominationTable migrating
09:39:04.003 -------------------------------------------------------------------------------
09:39:04.004 [+] Beginning Transaction
09:39:04.004 [+] CreateTable work_record_nomination
09:39:04.006 [+] CreateForeignKey fk_work_record_nomination_ref_staff work_record_nomination(staff_id) staff(id)
09:39:04.007 [+] CreateForeignKey fk_work_record_nomination_ref_work_records work_record_nomination(work_record_id) work_records(id)
09:39:04.008 [+] ExecuteSqlStatement ALTER TABLE work_record_nomination WITH NOCHECK ADD CONSTRAINT [PK_work_record_nomination] PRIMARY KEY NONCLUSTERED 
09:39:04.008                                         (staff_id,work_record_id)
09:39:04.009 [+] Committing Transaction
09:39:04.010 [+] 163: AddWorkRecordNominationTable migrated
09:39:04.010 -------------------------------------------------------------------------------
09:39:04.010 164: RemoveFeatureToggleForAssigneeUacAndWorkRecordUac migrating
09:39:04.010 -------------------------------------------------------------------------------
09:39:04.011 [+] Beginning Transaction
09:39:04.011 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.012 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.013 [+] Committing Transaction
09:39:04.014 [+] 164: RemoveFeatureToggleForAssigneeUacAndWorkRecordUac migrated
09:39:04.014 -------------------------------------------------------------------------------
09:39:04.014 165: MigrateCurrentMilestoneInCompleteTaskResponsibilities migrating
09:39:04.014 -------------------------------------------------------------------------------
09:39:04.014 [+] Beginning Transaction
09:39:04.015 [+] ExecuteSqlStatement UPDATE work_record_reports
09:39:04.015 SET currently_with = result.ids
09:39:04.015 FROM work_record_reports
09:39:04.015 INNER JOIN (
09:39:04.015 SELECT aa.work_record_id,
09:39:04.015 stuff((SELECT ','+ convert(nvarchar(255),result.responsibility_id)
09:39:04.015 FROM
09:39:04.015 (SELECT distinct wt.work_record_id,  wta.responsibility_id
09:39:04.015 	FROM work_record_tasks wt
09:39:04.015 	INNER JOIN work_records
09:39:04.015 	ON work_records.id = wt.work_record_id
09:39:04.016 	AND work_records.current_milestone_name = wt.milestone
09:39:04.016 	inner join work_record_task_assignments wta
09:39:04.016 	on wta.id = wt.task_assignment_id
09:39:04.016 	AND wt.status = 0
09:39:04.016 	WHERE wt.work_record_id = wt.work_record_id) result
09:39:04.016 WHERE result.work_record_id = aa.work_record_id
09:39:04.016 for xml path('')),1,1,'') as ids
09:39:04.016 FROM (SELECT DISTINCT work_record_id FROM work_record_tasks WHERE status = 0) as aa) as result
09:39:04.016 ON result.work_record_id = work_record_reports.work_record_id
09:39:04.016 
09:39:04.043 [+] Committing Transaction
09:39:04.045 [+] 165: MigrateCurrentMilestoneInCompleteTaskResponsibilities migrated
09:39:04.046 -------------------------------------------------------------------------------
09:39:04.046 166: ChangeResponsiblePeopleColumnsOnWorkRecordReports migrating
09:39:04.046 -------------------------------------------------------------------------------
09:39:04.047 [+] Beginning Transaction
09:39:04.049 [+] AlterTable work_record_reports
09:39:04.050 [+] AlterColumn work_record_reports initial_reviewer String
09:39:04.056 [+] AlterTable work_record_reports
09:39:04.057 [+] AlterColumn work_record_reports preparer String
09:39:04.063 [+] AlterTable work_record_reports
09:39:04.064 [+] AlterColumn work_record_reports reviewer String
09:39:04.070 [+] AlterTable work_record_reports
09:39:04.071 [+] AlterColumn work_record_reports signer String
09:39:04.077 [+] AlterTable work_record_reports
09:39:04.078 [+] AlterColumn work_record_reports administrator String
09:39:04.084 [+] Committing Transaction
09:39:04.086 [+] 166: ChangeResponsiblePeopleColumnsOnWorkRecordReports migrated
09:39:04.087 -------------------------------------------------------------------------------
09:39:04.087 167: DropWorkRecordNominationTableAndRecreateIt migrating
09:39:04.088 -------------------------------------------------------------------------------
09:39:04.088 [+] Beginning Transaction
09:39:04.093 [+] DeleteTable work_record_nomination
09:39:04.101 [+] CreateTable work_record_nomination
09:39:04.105 [+] CreateForeignKey fk_work_record_nomination_ref_staff work_record_nomination(staff_id) staff(id)
09:39:04.108 [+] CreateForeignKey fk_work_record_nomination_ref_work_records work_record_nomination(work_record_id) work_records(id)
09:39:04.111 [+] CreateIndex work_record_nomination (staff_id, work_record_id)
09:39:04.114 [+] Committing Transaction
09:39:04.116 [+] 167: DropWorkRecordNominationTableAndRecreateIt migrated
09:39:04.118 -------------------------------------------------------------------------------
09:39:04.118 170: MigrateResponsibilitiesOnWorkRecordReport migrating
09:39:04.118 -------------------------------------------------------------------------------
09:39:04.118 [+] Beginning Transaction
09:39:04.121 [+] ExecuteSqlStatement UPDATE work_Record_reports
09:39:04.121 SET initial_reviewer = www.ids
09:39:04.122 FROM work_Record_reports
09:39:04.122 INNER JOIN (
09:39:04.122 SELECT work_record_id, 
09:39:04.122   (STUFF((SELECT DISTINCT ',' + convert(nvarchar(255), wta.responsibility_id)
09:39:04.122   FROM work_record_task_assignments wta
09:39:04.122   WHERE wta.work_record_id = wr.work_record_id
09:39:04.122   AND wta.milestone = 10
09:39:04.123   FOR XML PATH('')), 1,1, '')) as ids
09:39:04.123 FROM work_Record_reports wr) www
09:39:04.123 ON www.work_record_id = work_Record_reports.work_record_id
09:39:04.143 [+] ExecuteSqlStatement UPDATE work_Record_reports
09:39:04.143 SET preparer = www.ids
09:39:04.144 FROM work_Record_reports
09:39:04.144 INNER JOIN (
09:39:04.144 SELECT work_record_id, 
09:39:04.144   (STUFF((SELECT DISTINCT ',' + convert(nvarchar(255), wta.responsibility_id)
09:39:04.144   FROM work_record_task_assignments wta
09:39:04.144   WHERE wta.work_record_id = wr.work_record_id
09:39:04.144   AND wta.milestone = 20
09:39:04.144   FOR XML PATH('')), 1,1, '')) as ids
09:39:04.144 FROM work_Record_reports wr) www
09:39:04.144 ON www.work_record_id = work_Record_reports.work_record_id
09:39:04.153 [+] ExecuteSqlStatement UPDATE work_Record_reports
09:39:04.153 SET reviewer = www.ids
09:39:04.154 FROM work_Record_reports
09:39:04.154 INNER JOIN (
09:39:04.154 SELECT work_record_id, 
09:39:04.154   (STUFF((SELECT DISTINCT ',' + convert(nvarchar(255), wta.responsibility_id)
09:39:04.154   FROM work_record_task_assignments wta
09:39:04.154   WHERE wta.work_record_id = wr.work_record_id
09:39:04.154   AND wta.milestone = 30
09:39:04.154   FOR XML PATH('')), 1,1, '')) as ids
09:39:04.154 FROM work_Record_reports wr) www
09:39:04.154 ON www.work_record_id = work_Record_reports.work_record_id
09:39:04.164 [+] ExecuteSqlStatement UPDATE work_Record_reports
09:39:04.164 SET signer = www.ids
09:39:04.164 FROM work_Record_reports
09:39:04.164 INNER JOIN (
09:39:04.165 SELECT work_record_id, 
09:39:04.165   (STUFF((SELECT DISTINCT ',' + convert(nvarchar(255), wta.responsibility_id)
09:39:04.165   FROM work_record_task_assignments wta
09:39:04.165   WHERE wta.work_record_id = wr.work_record_id
09:39:04.165   AND wta.milestone = 40
09:39:04.165   FOR XML PATH('')), 1,1, '')) as ids
09:39:04.165 FROM work_Record_reports wr) www
09:39:04.166 ON www.work_record_id = work_Record_reports.work_record_id
09:39:04.177 [+] ExecuteSqlStatement UPDATE work_Record_reports
09:39:04.177 SET administrator = www.ids
09:39:04.177 FROM work_Record_reports
09:39:04.178 INNER JOIN (
09:39:04.178 SELECT work_record_id, 
09:39:04.178   (STUFF((SELECT DISTINCT ',' + convert(nvarchar(255), wta.responsibility_id)
09:39:04.178   FROM work_record_task_assignments wta
09:39:04.178   WHERE wta.work_record_id = wr.work_record_id
09:39:04.179   AND wta.milestone = 50
09:39:04.179   FOR XML PATH('')), 1,1, '')) as ids
09:39:04.179 FROM work_Record_reports wr) www
09:39:04.179 ON www.work_record_id = work_Record_reports.work_record_id
09:39:04.189 [+] Committing Transaction
09:39:04.191 [+] 170: MigrateResponsibilitiesOnWorkRecordReport migrated
09:39:04.191 -------------------------------------------------------------------------------
09:39:04.191 171: MigrateRemindersOnWorkRecordReport migrating
09:39:04.191 -------------------------------------------------------------------------------
09:39:04.192 [+] Beginning Transaction
09:39:04.203 [+] ExecuteSqlStatement UPDATE work_record_reports
09:39:04.203 SET first_reminder = result.[when]
09:39:04.203 FROM work_record_reports
09:39:04.203 INNER JOIN
09:39:04.203 (SELECT TOP(1) [when], work_record_id from history_item
09:39:04.203 INNER JOIN organizers
09:39:04.203 ON organizers.work_record_id = history_item.entity_id
09:39:04.203 WHERE history_item.entity_type = 'Organizer'
09:39:04.203 AND history_item.what = 'FirstReminder'
09:39:04.203 AND organizers.reminder_state IN (1,2)
09:39:04.204 ORDER BY history_item.[when] desc) result
09:39:04.204 ON result.work_record_id = work_record_reports.work_record_id
09:39:04.213 [+] ExecuteSqlStatement UPDATE work_record_reports
09:39:04.213 SET final_reminder = result.[when]
09:39:04.214 FROM work_record_reports
09:39:04.214 INNER JOIN
09:39:04.214 (SELECT TOP(1) [when], work_record_id from history_item
09:39:04.214 INNER JOIN organizers
09:39:04.215 ON organizers.work_record_id = history_item.entity_id
09:39:04.215 WHERE history_item.entity_type = 'Organizer'
09:39:04.215 AND history_item.what = 'FinalReminder'
09:39:04.215 AND organizers.reminder_state IN (2)
09:39:04.215 ORDER BY history_item.[when] desc) result
09:39:04.216 ON result.work_record_id = work_record_reports.work_record_id
09:39:04.226 [+] Committing Transaction
09:39:04.230 [+] 171: MigrateRemindersOnWorkRecordReport migrated
09:39:04.231 -------------------------------------------------------------------------------
09:39:04.231 172: AddEngagementToEntityTimestamp migrating
09:39:04.231 -------------------------------------------------------------------------------
09:39:04.232 [+] Beginning Transaction
09:39:04.233 [+] ExecuteSqlStatement Insert entity_timestamps values('Engagement',635840123442326135)
09:39:04.235 [+] Committing Transaction
09:39:04.237 [+] 172: AddEngagementToEntityTimestamp migrated
09:39:04.238 -------------------------------------------------------------------------------
09:39:04.238 173: AddIndexEngagedOfficeIdAndStaffIdToEngagedOfficeStaff migrating
09:39:04.239 -------------------------------------------------------------------------------
09:39:04.239 [+] Beginning Transaction
09:39:04.241 [+] CreateIndex engaged_office_staff (engaged_office_id, staff_id)
09:39:04.244 [+] Committing Transaction
09:39:04.246 [+] 173: AddIndexEngagedOfficeIdAndStaffIdToEngagedOfficeStaff migrated
09:39:04.247 -------------------------------------------------------------------------------
09:39:04.247 175: RemoveAssgineeInfoOnAssigneeReport migrating
09:39:04.248 -------------------------------------------------------------------------------
09:39:04.248 [+] Beginning Transaction
09:39:04.250 [+] DeleteColumn assignee_reports first_name, last_name, middle_name, email_address
09:39:04.298 [+] Committing Transaction
09:39:04.299 [+] 175: RemoveAssgineeInfoOnAssigneeReport migrated
09:39:04.299 -------------------------------------------------------------------------------
09:39:04.299 176: AddAssigneeNominationTable migrating
09:39:04.299 -------------------------------------------------------------------------------
09:39:04.299 [+] Beginning Transaction
09:39:04.299 [+] CreateTable assignee_nomination
09:39:04.301 [+] CreateForeignKey fk_assignee_nomination_ref_staff assignee_nomination(staff_id) staff(id)
09:39:04.302 [+] CreateForeignKey fk_assignee_nomination_ref_assignees assignee_nomination(assignee_id) assignees(id)
09:39:04.304 [+] CreateIndex assignee_nomination (staff_id, assignee_id)
09:39:04.305 [+] Committing Transaction
09:39:04.306 [+] 176: AddAssigneeNominationTable migrated
09:39:04.307 -------------------------------------------------------------------------------
09:39:04.307 177: AddFeatureToggleForCustomFieldPhaseI migrating
09:39:04.307 -------------------------------------------------------------------------------
09:39:04.307 [+] Beginning Transaction
09:39:04.308 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:04.309 [+] Committing Transaction
09:39:04.310 [+] 177: AddFeatureToggleForCustomFieldPhaseI migrated
09:39:04.310 -------------------------------------------------------------------------------
09:39:04.310 178: AddCustomFieldsTable migrating
09:39:04.311 -------------------------------------------------------------------------------
09:39:04.311 [+] Beginning Transaction
09:39:04.311 [+] CreateTable custom_fields
09:39:04.313 [+] CreateForeignKey fk_custom_fields_ref_engagements custom_fields(engagement_id) engagements(id)
09:39:04.314 [+] Committing Transaction
09:39:04.315 [+] 178: AddCustomFieldsTable migrated
09:39:04.316 -------------------------------------------------------------------------------
09:39:04.316 179: AddCustomFieldsValueTable migrating
09:39:04.316 -------------------------------------------------------------------------------
09:39:04.316 [+] Beginning Transaction
09:39:04.317 [+] CreateTable custom_fields_value
09:39:04.320 [+] CreateForeignKey fk_custom_fields_value_ref_assignees custom_fields_value(assignee_id) assignees(id)
09:39:04.322 [+] CreateForeignKey fk_custom_fields_value_ref_custom_fields custom_fields_value(customfields_id) custom_fields(id)
09:39:04.324 [+] Committing Transaction
09:39:04.325 [+] 179: AddCustomFieldsValueTable migrated
09:39:04.325 -------------------------------------------------------------------------------
09:39:04.325 180: AddTypeAndLocationIntoCustomFields migrating
09:39:04.325 -------------------------------------------------------------------------------
09:39:04.325 [+] Beginning Transaction
09:39:04.326 [+] AlterTable custom_fields
09:39:04.326 [+] CreateColumn custom_fields type Int16
09:39:04.327 [+] AlterTable custom_fields
09:39:04.328 [+] CreateColumn custom_fields location Int16
09:39:04.329 [+] Committing Transaction
09:39:04.330 [+] 180: AddTypeAndLocationIntoCustomFields migrated
09:39:04.330 -------------------------------------------------------------------------------
09:39:04.330 181: AddFeatureToggleForADFS migrating
09:39:04.330 -------------------------------------------------------------------------------
09:39:04.330 [+] Beginning Transaction
09:39:04.331 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.332 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:04.333 [+] Committing Transaction
09:39:04.334 [+] 181: AddFeatureToggleForADFS migrated
09:39:04.334 -------------------------------------------------------------------------------
09:39:04.334 182: AddColumnPPIDOnStaff migrating
09:39:04.334 -------------------------------------------------------------------------------
09:39:04.334 [+] Beginning Transaction
09:39:04.335 [+] AlterTable staff
09:39:04.336 [+] CreateColumn staff ppid String
09:39:04.337 [+] CreateIndex staff (ppid)
09:39:04.338 [+] Committing Transaction
09:39:04.339 [+] 182: AddColumnPPIDOnStaff migrated
09:39:04.339 -------------------------------------------------------------------------------
09:39:04.339 183: AddIndexResponsibilityIdOnWorkRecordTaskAssignments migrating
09:39:04.339 -------------------------------------------------------------------------------
09:39:04.339 [+] Beginning Transaction
09:39:04.340 [+] CreateIndex work_record_task_assignments (responsibility_id)
09:39:04.341 [+] Committing Transaction
09:39:04.341 [+] 183: AddIndexResponsibilityIdOnWorkRecordTaskAssignments migrated
09:39:04.342 -------------------------------------------------------------------------------
09:39:04.342 184: AddIndexTaskAssignmentIdOnWorkRecordTasks migrating
09:39:04.342 -------------------------------------------------------------------------------
09:39:04.343 [+] Beginning Transaction
09:39:04.343 [+] CreateIndex work_record_tasks (task_assignment_id)
09:39:04.345 [+] Committing Transaction
09:39:04.346 [+] 184: AddIndexTaskAssignmentIdOnWorkRecordTasks migrated
09:39:04.347 -------------------------------------------------------------------------------
09:39:04.347 185: AddIndexTypeAndWorkRecordIdOnToDoItems migrating
09:39:04.347 -------------------------------------------------------------------------------
09:39:04.347 [+] Beginning Transaction
09:39:04.348 [+] CreateIndex todo_items (type, work_record_task_id)
09:39:04.350 [+] Committing Transaction
09:39:04.352 [+] 185: AddIndexTypeAndWorkRecordIdOnToDoItems migrated
09:39:04.357 -------------------------------------------------------------------------------
09:39:04.359 186: AddGOMigrationProcessTable migrating
09:39:04.359 -------------------------------------------------------------------------------
09:39:04.360 [+] Beginning Transaction
09:39:04.361 [+] CreateTable go_migration_process
09:39:04.365 [+] Committing Transaction
09:39:04.367 [+] 186: AddGOMigrationProcessTable migrated
09:39:04.368 -------------------------------------------------------------------------------
09:39:04.368 187: RemovePPIDColumnOfStaff migrating
09:39:04.369 -------------------------------------------------------------------------------
09:39:04.369 [+] Beginning Transaction
09:39:04.371 [+] DeleteIndex staff ()
09:39:04.373 [+] DeleteColumn staff ppid
09:39:04.390 [+] Committing Transaction
09:39:04.391 [+] 187: RemovePPIDColumnOfStaff migrated
09:39:04.391 -------------------------------------------------------------------------------
09:39:04.391 188: AddIndexOfCountryIdOnTypesOfService migrating
09:39:04.391 -------------------------------------------------------------------------------
09:39:04.392 [+] Beginning Transaction
09:39:04.392 [+] CreateIndex types_of_service (country_id)
09:39:04.394 [+] Committing Transaction
09:39:04.394 [+] 188: AddIndexOfCountryIdOnTypesOfService migrated
09:39:04.395 -------------------------------------------------------------------------------
09:39:04.395 189: AddIndexOfWorkRecordIdAndResponsibleOfficeIdOnWorkRecordTaskAssignments migrating
09:39:04.395 -------------------------------------------------------------------------------
09:39:04.395 [+] Beginning Transaction
09:39:04.396 [+] CreateIndex work_record_task_assignments (work_record_id, responsible_office_id)
09:39:04.397 [+] DeleteIndex work_record_task_assignments ()
09:39:04.398 [+] Committing Transaction
09:39:04.399 [+] 189: AddIndexOfWorkRecordIdAndResponsibleOfficeIdOnWorkRecordTaskAssignments migrated
09:39:04.399 -------------------------------------------------------------------------------
09:39:04.399 190: AddIndexOfIdIncludingFirstNameAndLastNameOnAssignees migrating
09:39:04.399 -------------------------------------------------------------------------------
09:39:04.399 [+] Beginning Transaction
09:39:04.400 [+] ExecuteSqlStatement 
09:39:04.401                 CREATE NONCLUSTERED INDEX [idx_assignees_id_including_first_name_and_last_name] ON [assignees] 
09:39:04.401                 (
09:39:04.401 	                [id] ASC
09:39:04.401                 )
09:39:04.401                 INCLUDE ([first_name], [last_name])
09:39:04.401             
09:39:04.402 [+] Committing Transaction
09:39:04.403 [+] 190: AddIndexOfIdIncludingFirstNameAndLastNameOnAssignees migrated
09:39:04.403 -------------------------------------------------------------------------------
09:39:04.403 191: AddIndexOfWorkRecordIdAndReceivedAtOnMissingItems migrating
09:39:04.403 -------------------------------------------------------------------------------
09:39:04.403 [+] Beginning Transaction
09:39:04.404 [+] CreateIndex missing_items (work_record_id, received_at)
09:39:04.405 [+] Committing Transaction
09:39:04.406 [+] 191: AddIndexOfWorkRecordIdAndReceivedAtOnMissingItems migrated
09:39:04.406 -------------------------------------------------------------------------------
09:39:04.406 192: AddUniqueContraintForEmployeeIdColumnOnStaffTable migrating
09:39:04.407 -------------------------------------------------------------------------------
09:39:04.407 [+] Beginning Transaction
09:39:04.407 [+] ExecuteSqlStatement 
09:39:04.407                 declare @id int, @employee_id nvarchar(255),@email nvarchar(255), @count int
09:39:04.408                 declare staffs cursor for SELECT id, employee_id,internet_email_address FROM staff 
09:39:04.408                 open staffs
09:39:04.408                 fetch next from staffs into @id, @employee_id, @email
09:39:04.408                 While @@fetch_status=0     
09:39:04.408                 Begin
09:39:04.408 	                select @count = count(*) from staff where employee_id = @employee_id
09:39:04.408 	                if @count > 1
09:39:04.408 	                begin
09:39:04.408 		                update staff set employee_id = newid() where id = @id
09:39:04.408 	                end
09:39:04.408 	                
09:39:04.408 	                select @count = count(*) from staff where internet_email_address = @email
09:39:04.408 	                if @count > 1
09:39:04.408 	                begin
09:39:04.408 		                update staff set internet_email_address = newid() where id = @id
09:39:04.408 	                end
09:39:04.408 	                fetch next from staffs into @id, @employee_id, @email
09:39:04.409                 End   
09:39:04.409                 close staffs
09:39:04.409                 Deallocate staffs
09:39:04.409             
09:39:04.413 [+] ExecuteSqlStatement  
09:39:04.413                 ALTER TABLE staff 
09:39:04.413                 ADD CONSTRAINT employee_id_unique UNIQUE NONCLUSTERED (employee_id ASC)
09:39:04.413             
09:39:04.415 [+] ExecuteSqlStatement  
09:39:04.416                 ALTER TABLE staff 
09:39:04.416                 ADD CONSTRAINT internet_email_address_unique UNIQUE NONCLUSTERED (internet_email_address ASC)
09:39:04.416             
09:39:04.422 [+] Committing Transaction
09:39:04.424 [+] 192: AddUniqueContraintForEmployeeIdColumnOnStaffTable migrated
09:39:04.424 -------------------------------------------------------------------------------
09:39:04.424 193: AddEngagementCulture migrating
09:39:04.424 -------------------------------------------------------------------------------
09:39:04.425 [+] Beginning Transaction
09:39:04.425 [+] CreateTable engagement_culture
09:39:04.427 [+] Committing Transaction
09:39:04.428 [+] 193: AddEngagementCulture migrated
09:39:04.428 -------------------------------------------------------------------------------
09:39:04.428 194: RemoveFeatureToggleBatchUpdateWorkMilestones migrating
09:39:04.428 -------------------------------------------------------------------------------
09:39:04.429 [+] Beginning Transaction
09:39:04.430 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.431 [+] Committing Transaction
09:39:04.432 [+] 194: RemoveFeatureToggleBatchUpdateWorkMilestones migrated
09:39:04.432 -------------------------------------------------------------------------------
09:39:04.432 195: RemoveFeatureToggleFileDownloadHistory migrating
09:39:04.432 -------------------------------------------------------------------------------
09:39:04.433 [+] Beginning Transaction
09:39:04.433 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.434 [+] Committing Transaction
09:39:04.435 [+] 195: RemoveFeatureToggleFileDownloadHistory migrated
09:39:04.435 -------------------------------------------------------------------------------
09:39:04.435 196: RemoveFeatureToggleNewBatchCreateWr migrating
09:39:04.436 -------------------------------------------------------------------------------
09:39:04.436 [+] Beginning Transaction
09:39:04.436 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.437 [+] Committing Transaction
09:39:04.438 [+] 196: RemoveFeatureToggleNewBatchCreateWr migrated
09:39:04.438 -------------------------------------------------------------------------------
09:39:04.438 197: RemoveFeatureToggleNewSingleCreateWr migrating
09:39:04.438 -------------------------------------------------------------------------------
09:39:04.438 [+] Beginning Transaction
09:39:04.439 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.440 [+] Committing Transaction
09:39:04.441 [+] 197: RemoveFeatureToggleNewSingleCreateWr migrated
09:39:04.441 -------------------------------------------------------------------------------
09:39:04.441 198: RemoveFeatureToggleAdvancedToDoList migrating
09:39:04.441 -------------------------------------------------------------------------------
09:39:04.441 [+] Beginning Transaction
09:39:04.442 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.443 [+] Committing Transaction
09:39:04.444 [+] 198: RemoveFeatureToggleAdvancedToDoList migrated
09:39:04.444 -------------------------------------------------------------------------------
09:39:04.444 199: RemoveFeatureToggleNewAssigneeDetailUI migrating
09:39:04.444 -------------------------------------------------------------------------------
09:39:04.444 [+] Beginning Transaction
09:39:04.445 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.446 [+] Committing Transaction
09:39:04.447 [+] 199: RemoveFeatureToggleNewAssigneeDetailUI migrated
09:39:04.447 -------------------------------------------------------------------------------
09:39:04.447 200: RemoveFeatureToggleToDoList migrating
09:39:04.447 -------------------------------------------------------------------------------
09:39:04.448 [+] Beginning Transaction
09:39:04.448 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.449 [+] Committing Transaction
09:39:04.450 [+] 200: RemoveFeatureToggleToDoList migrated
09:39:04.450 -------------------------------------------------------------------------------
09:39:04.450 201: RemoveFeatureToggleUploadMyVisasFile migrating
09:39:04.450 -------------------------------------------------------------------------------
09:39:04.451 [+] Beginning Transaction
09:39:04.451 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.452 [+] Committing Transaction
09:39:04.453 [+] 201: RemoveFeatureToggleUploadMyVisasFile migrated
09:39:04.454 -------------------------------------------------------------------------------
09:39:04.454 202: AddPracticeTypeFieldToChecklistTemplateTable migrating
09:39:04.454 -------------------------------------------------------------------------------
09:39:04.454 [+] Beginning Transaction
09:39:04.455 [+] AlterTable checklist_templates
09:39:04.456 [+] CreateColumn checklist_templates practice_type Int32
09:39:04.458 [+] Committing Transaction
09:39:04.459 [+] 202: AddPracticeTypeFieldToChecklistTemplateTable migrated
09:39:04.460 -------------------------------------------------------------------------------
09:39:04.460 203: AddFeatureToggleForSocialSecurityPracticeType migrating
09:39:04.460 -------------------------------------------------------------------------------
09:39:04.460 [+] Beginning Transaction
09:39:04.462 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.464 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:04.465 [+] Committing Transaction
09:39:04.465 [+] 203: AddFeatureToggleForSocialSecurityPracticeType migrated
09:39:04.466 -------------------------------------------------------------------------------
09:39:04.466 204: AddPracticeTypeColumnOnTaskTemplateTable migrating
09:39:04.466 -------------------------------------------------------------------------------
09:39:04.466 [+] Beginning Transaction
09:39:04.470 [+] ExecuteSqlStatement update [task_templates] set name = 'DEFAULT_TAX_TASK_TEMPLATE' where name = 'DEFAULT_TASK_TEMPLATE'
09:39:04.477 [+] ExecuteSqlStatement 
09:39:04.477                 declare @templateid bigint 
09:39:04.478                 SELECT  @templateid = [id] FROM [task_templates] where name = 'DEFAULT_TAX_TASK_TEMPLATE'  
09:39:04.478                 update [task_definitions] set name = 'Service Initiated', is_retired = 0 where [task_template_id] = @templateid and [milestone] = 10
09:39:04.478                 update [task_definitions] set name = 'In Preparation', is_retired = 0 where [task_template_id] = @templateid and [milestone] = 20
09:39:04.478                 update [task_definitions] set name = 'In Review', is_retired = 0 where [task_template_id] = @templateid and [milestone] = 30
09:39:04.478                 update [task_definitions] set name = 'Delivered', is_retired = 0 where [task_template_id] = @templateid and [milestone] = 40
09:39:04.478                 update [task_definitions] set name = 'Complete', is_retired = 0 where [task_template_id] = @templateid and [milestone] = 50
09:39:04.478             
09:39:04.487 [+] AlterTable task_templates
09:39:04.488 [+] CreateColumn task_templates practice_type Int16
09:39:04.491 [+] ExecuteSqlStatement 
09:39:04.491                 INSERT INTO task_templates(name, owned_by, is_default, practice_type) VALUES('DEFAULT_IMMIGRATION_TASK_TEMPLATE', 0, 1, 1)
09:39:04.492                 DECLARE @id bigint
09:39:04.492                 SELECT @id = @@IDENTITY;
09:39:04.492             INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Service Initiated', @id, 0, 10, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Received', @id, 0, 20, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Submitted', @id, 0, 30, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Complete', @id, 0, 40, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Post Work', @id, 0, 50, 1, 0);
09:39:04.506 [+] ExecuteSqlStatement 
09:39:04.507                 INSERT INTO task_templates(name, owned_by, is_default, practice_type) VALUES('DEFAULT_SOCIAL_SECURITY_TASK_TEMPLATE', 0, 1, 2)
09:39:04.507                 DECLARE @id bigint
09:39:04.507                 SELECT @id = @@IDENTITY;
09:39:04.507             INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Initiated', @id, 0, 10, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Information Request Issued', @id, 0, 20, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('In Preparation', @id, 0, 30, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Submitted to Authorities', @id, 0, 40, 1, 0);INSERT INTO task_definitions(name, task_template_id, task_index, milestone, is_default, is_retired) VALUES('Certificate Received', @id, 0, 50, 1, 0);
09:39:04.522 [+] Committing Transaction
09:39:04.524 [+] 204: AddPracticeTypeColumnOnTaskTemplateTable migrated
09:39:04.526 -------------------------------------------------------------------------------
09:39:04.526 205: RemoveFeatureToggleMissingInformation migrating
09:39:04.526 -------------------------------------------------------------------------------
09:39:04.527 [+] Beginning Transaction
09:39:04.528 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.531 [+] Committing Transaction
09:39:04.533 [+] 205: RemoveFeatureToggleMissingInformation migrated
09:39:04.534 -------------------------------------------------------------------------------
09:39:04.534 206: RemoveFeatureToggleTaskTemplate migrating
09:39:04.534 -------------------------------------------------------------------------------
09:39:04.535 [+] Beginning Transaction
09:39:04.537 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:04.539 [+] Committing Transaction
09:39:04.541 [+] 206: RemoveFeatureToggleTaskTemplate migrated
09:39:04.543 -------------------------------------------------------------------------------
09:39:04.543 207: ChangeWorkRecordTaxYearColumnToBeNullable migrating
09:39:04.543 -------------------------------------------------------------------------------
09:39:04.543 [+] Beginning Transaction
09:39:04.545 [+] AlterTable work_records
09:39:04.546 [+] AlterColumn work_records tax_year Int16
09:39:04.552 [+] ExecuteSqlStatement update work_records set tax_year = NULL where practice_type <> 0
09:39:04.562 [+] Committing Transaction
09:39:04.563 [+] 207: ChangeWorkRecordTaxYearColumnToBeNullable migrated
09:39:04.564 -------------------------------------------------------------------------------
09:39:04.564 208: AddIndexOfEntityIdAndEntityTypeOnHistoryItem migrating
09:39:04.564 -------------------------------------------------------------------------------
09:39:04.564 [+] Beginning Transaction
09:39:04.565 [+] CreateIndex history_item (entity_id, entity_type)
09:39:04.568 [+] Committing Transaction
09:39:04.570 [+] 208: AddIndexOfEntityIdAndEntityTypeOnHistoryItem migrated
09:39:04.571 -------------------------------------------------------------------------------
09:39:04.571 209: ChangeAssigneeIdColumnToBeNullable migrating
09:39:04.572 -------------------------------------------------------------------------------
09:39:04.586 [+] Beginning Transaction
09:39:04.586 [+] AlterTable custom_fields_value
09:39:04.587 [+] AlterColumn custom_fields_value assignee_id Int64
09:39:04.587 [+] Committing Transaction
09:39:04.587 [+] 209: ChangeAssigneeIdColumnToBeNullable migrated
09:39:04.589 -------------------------------------------------------------------------------
09:39:04.589 210: AddIndexOnBatchIdForTableBatchItems migrating
09:39:04.589 -------------------------------------------------------------------------------
09:39:04.589 [+] Beginning Transaction
09:39:04.590 [+] CreateIndex batch_items (batch_id)
09:39:04.594 [+] Committing Transaction
09:39:04.596 [+] 210: AddIndexOnBatchIdForTableBatchItems migrated
09:39:04.597 -------------------------------------------------------------------------------
09:39:04.597 211: ChangeValueColumnToBeNullable migrating
09:39:04.598 -------------------------------------------------------------------------------
09:39:04.598 [+] Beginning Transaction
09:39:04.599 [+] AlterTable custom_fields_value
09:39:04.601 [+] AlterColumn custom_fields_value value String
09:39:04.604 [+] Committing Transaction
09:39:04.606 [+] 211: ChangeValueColumnToBeNullable migrated
09:39:04.607 -------------------------------------------------------------------------------
09:39:04.607 212: AddColumnStaffIdAndDateTimeToCustomFieldsTable migrating
09:39:04.607 -------------------------------------------------------------------------------
09:39:04.608 [+] Beginning Transaction
09:39:04.610 [+] AlterTable custom_fields
09:39:04.611 [+] CreateColumn custom_fields staff_id Int64
09:39:04.620 [+] CreateForeignKey fk_custom_fields_ref_staff custom_fields(staff_id) staff(id)
09:39:04.625 [+] AlterTable custom_fields
09:39:04.626 [+] CreateColumn custom_fields created_at DateTime
09:39:04.630 [+] Committing Transaction
09:39:04.632 [+] 212: AddColumnStaffIdAndDateTimeToCustomFieldsTable migrated
09:39:04.632 -------------------------------------------------------------------------------
09:39:04.632 220: AddFeatureToggleForConsent migrating
09:39:04.632 -------------------------------------------------------------------------------
09:39:04.633 [+] Beginning Transaction
09:39:04.635 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:04.637 [+] Committing Transaction
09:39:04.638 [+] 220: AddFeatureToggleForConsent migrated
09:39:04.639 -------------------------------------------------------------------------------
09:39:04.639 221: AddColumnServiceStatusOnWorkrecordsTable migrating
09:39:04.639 -------------------------------------------------------------------------------
09:39:04.639 [+] Beginning Transaction
09:39:04.639 [+] AlterTable work_records
09:39:04.640 [+] CreateColumn work_records service_status Int16
09:39:04.642 [+] Committing Transaction
09:39:04.642 [+] 221: AddColumnServiceStatusOnWorkrecordsTable migrated
09:39:04.643 -------------------------------------------------------------------------------
09:39:04.643 222: AddFeatureToggleForServiceStatus migrating
09:39:04.643 -------------------------------------------------------------------------------
09:39:04.643 [+] Beginning Transaction
09:39:04.644 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:04.645 [+] Committing Transaction
09:39:04.645 [+] 222: AddFeatureToggleForServiceStatus migrated
09:39:04.646 -------------------------------------------------------------------------------
09:39:04.646 223: AddWorkRecordCustomFieldsValueTable migrating
09:39:04.646 -------------------------------------------------------------------------------
09:39:04.646 [+] Beginning Transaction
09:39:04.647 [+] CreateTable work_record_custom_fields_value
09:39:04.648 [+] CreateForeignKey fk_work_record_custom_fields_value_ref_work_records work_record_custom_fields_value(work_record_id) work_records(id)
09:39:04.649 [+] CreateForeignKey fk_work_record_custom_fields_value_ref_custom_fields work_record_custom_fields_value(customfields_id) custom_fields(id)
09:39:04.651 [+] Committing Transaction
09:39:04.652 [+] 223: AddWorkRecordCustomFieldsValueTable migrated
09:39:04.652 -------------------------------------------------------------------------------
09:39:04.653 224: ChangeWorkRecordServiceStatusColumnToBeNullable migrating
09:39:04.653 -------------------------------------------------------------------------------
09:39:04.653 [+] Beginning Transaction
09:39:04.655 [+] AlterTable work_records
09:39:04.656 [+] AlterColumn work_records service_status Int16
09:39:04.659 [+] DeleteDefaultConstraint .work_records service_status
09:39:04.673 [+] ExecuteSqlStatement update work_records set service_status = NULL where practice_type <> 0 or id NOT IN (select work_record_id from organizers)
09:39:04.675 [+] Committing Transaction
09:39:04.676 [+] 224: ChangeWorkRecordServiceStatusColumnToBeNullable migrated
09:39:04.677 -------------------------------------------------------------------------------
09:39:04.678 225: RenameColumnCustomFieldsIdOfWorkRecordCustomFieldsValueTable migrating
09:39:04.678 -------------------------------------------------------------------------------
09:39:04.681 [+] Beginning Transaction
09:39:04.683 [+] RenameColumn work_record_custom_fields_value customfields_id to custom_field_id
09:39:04.686 [+] Committing Transaction
09:39:04.687 [+] 225: RenameColumnCustomFieldsIdOfWorkRecordCustomFieldsValueTable migrated
09:39:04.688 -------------------------------------------------------------------------------
09:39:04.688 226: RenameCustomFieldsValueTableAndColumnCustomfieldsId migrating
09:39:04.689 -------------------------------------------------------------------------------
09:39:04.689 [+] Beginning Transaction
09:39:04.690 [+] RenameColumn custom_fields_value customfields_id to custom_field_id
09:39:04.694 [+] RenameTable custom_fields_value assignee_custom_fields_value
09:39:04.697 [+] Committing Transaction
09:39:04.699 [+] 226: RenameCustomFieldsValueTableAndColumnCustomfieldsId migrated
09:39:04.700 -------------------------------------------------------------------------------
09:39:04.701 227: RenameColumnStaffIdToCreatedByCustomFieldTable migrating
09:39:04.701 -------------------------------------------------------------------------------
09:39:04.701 [+] Beginning Transaction
09:39:04.703 [+] RenameColumn custom_fields staff_id to created_by
09:39:04.707 [+] Committing Transaction
09:39:04.709 [+] 227: RenameColumnStaffIdToCreatedByCustomFieldTable migrated
09:39:04.710 -------------------------------------------------------------------------------
09:39:04.711 228: ChangeWorkRecordIdColumnToBeNullable migrating
09:39:04.711 -------------------------------------------------------------------------------
09:39:04.711 [+] Beginning Transaction
09:39:04.713 [+] AlterTable work_record_custom_fields_value
09:39:04.714 [+] AlterColumn work_record_custom_fields_value work_record_id Int64
09:39:04.717 [+] Committing Transaction
09:39:04.719 [+] 228: ChangeWorkRecordIdColumnToBeNullable migrated
09:39:04.721 -------------------------------------------------------------------------------
09:39:04.721 229: AddRestrictedColumnOnCustomFieldTable migrating
09:39:04.721 -------------------------------------------------------------------------------
09:39:04.721 [+] Beginning Transaction
09:39:04.723 [+] AlterTable custom_fields
09:39:04.725 [+] CreateColumn custom_fields restricted Boolean
09:39:04.729 [+] Committing Transaction
09:39:04.731 [+] 229: AddRestrictedColumnOnCustomFieldTable migrated
09:39:04.732 -------------------------------------------------------------------------------
09:39:04.733 230: AddFeatureToggleForCustomFieldPhaseII migrating
09:39:04.733 -------------------------------------------------------------------------------
09:39:04.733 [+] Beginning Transaction
09:39:04.735 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:04.737 [+] Committing Transaction
09:39:04.739 [+] 230: AddFeatureToggleForCustomFieldPhaseII migrated
09:39:04.740 -------------------------------------------------------------------------------
09:39:04.740 231: AddFeatureToggleForClientEngagement migrating
09:39:04.741 -------------------------------------------------------------------------------
09:39:04.741 [+] Beginning Transaction
09:39:04.746 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:04.752 [+] Committing Transaction
09:39:04.753 [+] 231: AddFeatureToggleForClientEngagement migrated
09:39:04.754 -------------------------------------------------------------------------------
09:39:04.755 232: AddColumnRoleOnEngagedOfficeStaffTable migrating
09:39:04.755 -------------------------------------------------------------------------------
09:39:04.755 [+] Beginning Transaction
09:39:04.758 [+] AlterTable engaged_office_staff
09:39:04.759 [+] CreateColumn engaged_office_staff role Int16
09:39:04.763 [+] UpdateData 
09:39:04.768 [+] Committing Transaction
09:39:04.770 [+] 232: AddColumnRoleOnEngagedOfficeStaffTable migrated
09:39:04.771 -------------------------------------------------------------------------------
09:39:04.771 233: AddEngagedStaffsTable migrating
09:39:04.771 -------------------------------------------------------------------------------
09:39:04.772 [+] Beginning Transaction
09:39:04.774 [+] CreateTable engaged_staffs
09:39:04.779 [+] Committing Transaction
09:39:04.781 [+] 233: AddEngagedStaffsTable migrated
09:39:04.782 -------------------------------------------------------------------------------
09:39:04.783 234: MigratePartnerFromCoordinatingOfficeToEngagement migrating
09:39:04.783 -------------------------------------------------------------------------------
09:39:04.783 [+] Beginning Transaction
09:39:04.785 [+] ExecuteSqlStatement 
09:39:04.785 /*migrate from milestone to assignments*/ 
09:39:04.785 
09:39:04.786 INSERT INTO engaged_staffs
09:39:04.786             ([staff_id], 
09:39:04.786              [engagement_id],
09:39:04.786              [role])
09:39:04.786 ( SELECT eos.staff_id,
09:39:04.787          eo.engagement_id,
09:39:04.787          eos.role
09:39:04.787  FROM   engaged_office_staff eos 
09:39:04.787         INNER JOIN engaged_offices eo
09:39:04.788                 ON eos.engaged_office_id = eo.id 
09:39:04.788  WHERE  eo.role = 'CoordinatingOffice') 
09:39:04.788  
09:39:04.788 
09:39:04.788  DELETE engaged_office_staff FROM engaged_office_staff eos
09:39:04.788  WHERE eos.engaged_office_id IN(
09:39:04.789 	SELECT eo.id
09:39:04.789 	FROM engaged_offices eo
09:39:04.789 	WHERE eo.role = 'CoordinatingOffice'
09:39:04.789 )
09:39:04.789 
09:39:04.789 
09:39:04.798 [+] Committing Transaction
09:39:04.800 [+] 234: MigratePartnerFromCoordinatingOfficeToEngagement migrated
09:39:04.802 -------------------------------------------------------------------------------
09:39:04.802 235: AddColumnTypeOnWorkRecordTaskTable migrating
09:39:04.802 -------------------------------------------------------------------------------
09:39:04.803 [+] Beginning Transaction
09:39:04.807 [+] AlterTable work_record_tasks
09:39:04.811 [+] CreateColumn work_record_tasks type Int32
09:39:04.818 [+] AlterTable work_record_tasks
09:39:04.820 [+] AlterColumn work_record_tasks task_definition_id Int64
09:39:04.823 [+] AlterTable work_record_task_assignments
09:39:04.824 [+] AlterColumn work_record_task_assignments task_definition_id Int64
09:39:04.828 [+] UpdateData 
09:39:04.833 [+] Committing Transaction
09:39:04.835 [+] 235: AddColumnTypeOnWorkRecordTaskTable migrated
09:39:04.836 -------------------------------------------------------------------------------
09:39:04.837 236: AddColumnPracticeTypeOnEngagementTable migrating
09:39:04.837 -------------------------------------------------------------------------------
09:39:04.837 [+] Beginning Transaction
09:39:04.839 [+] AlterTable engagements
09:39:04.840 [+] CreateColumn engagements practice_type Int32
09:39:04.844 [+] Committing Transaction
09:39:04.846 [+] 236: AddColumnPracticeTypeOnEngagementTable migrated
09:39:04.848 -------------------------------------------------------------------------------
09:39:04.848 237: AddColumnNoFilingRequirementOnTableOrganizers migrating
09:39:04.848 -------------------------------------------------------------------------------
09:39:04.849 [+] Beginning Transaction
09:39:04.851 [+] AlterTable organizers
09:39:04.852 [+] CreateColumn organizers no_filing_requirement Boolean
09:39:04.855 [+] ExecuteSqlStatement 
09:39:04.855 DECLARE @work_record_id BIGINT
09:39:04.856 
09:39:04.856 DECLARE organizer_ids CURSOR FOR 
09:39:04.856   SELECT wr.id
09:39:04.856   FROM   work_records wr
09:39:04.856   INNER JOIN organizers o on o.work_record_id = wr.id
09:39:04.856   WHERE wr.practice_type = 0
09:39:04.857 OPEN organizer_ids
09:39:04.857 
09:39:04.857 FETCH next FROM organizer_ids INTO @work_record_id
09:39:04.857 
09:39:04.857 WHILE @@fetch_status = 0 
09:39:04.857   BEGIN 
09:39:04.857     UPDATE organizers SET no_filing_requirement=0 WHERE work_record_id = @work_record_id
09:39:04.858     FETCH next FROM organizer_ids INTO @work_record_id 
09:39:04.858   END 
09:39:04.858 
09:39:04.858 CLOSE organizer_ids
09:39:04.858 
09:39:04.866 [+] Committing Transaction
09:39:04.868 [+] 237: AddColumnNoFilingRequirementOnTableOrganizers migrated
09:39:04.869 -------------------------------------------------------------------------------
09:39:04.869 238: AddClientAuditorsTable migrating
09:39:04.870 -------------------------------------------------------------------------------
09:39:04.870 [+] Beginning Transaction
09:39:04.872 [+] CreateTable client_auditors
09:39:04.881 [+] Committing Transaction
09:39:04.883 [+] 238: AddClientAuditorsTable migrated
09:39:04.884 -------------------------------------------------------------------------------
09:39:04.884 239: AddColumnsOnClientsTable migrating
09:39:04.885 -------------------------------------------------------------------------------
09:39:04.885 [+] Beginning Transaction
09:39:04.887 [+] AlterTable clients
09:39:04.888 [+] CreateColumn clients client_since String
09:39:04.892 [+] CreateColumn clients request_by String
09:39:04.902 [+] CreateColumn clients note String
09:39:04.902 [+] Committing Transaction
09:39:04.902 [+] 239: AddColumnsOnClientsTable migrated
09:39:04.904 -------------------------------------------------------------------------------
09:39:04.904 240: AddFeatureToggleCustomFieldListType migrating
09:39:04.904 -------------------------------------------------------------------------------
09:39:04.904 [+] Beginning Transaction
09:39:04.908 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:04.911 [+] Committing Transaction
09:39:04.914 [+] 240: AddFeatureToggleCustomFieldListType migrated
09:39:04.916 -------------------------------------------------------------------------------
09:39:04.916 241: AlterColumnNoFilingRequirementOnTableOrganizers migrating
09:39:04.916 -------------------------------------------------------------------------------
09:39:04.918 [+] Beginning Transaction
09:39:04.925 [+] UpdateData 
09:39:04.931 [+] AlterTable organizers
09:39:04.932 [+] AlterColumn organizers no_filing_requirement Boolean
09:39:04.938 [+] Committing Transaction
09:39:04.943 [+] 241: AlterColumnNoFilingRequirementOnTableOrganizers migrated
09:39:04.945 -------------------------------------------------------------------------------
09:39:04.945 242: MigrateRequestByOfClients migrating
09:39:04.945 -------------------------------------------------------------------------------
09:39:04.945 [+] Beginning Transaction
09:39:04.950 [+] DeleteDefaultConstraint .clients request_by
09:39:04.963 [+] AlterTable clients
09:39:04.964 [+] AlterColumn clients request_by Int64
09:39:04.965 [+] AlterDefaultConstraint .clients request_by 1
09:39:04.979 [+] DeleteDefaultConstraint .clients request_by
09:39:04.982 [+] ExecuteSqlStatement 
09:39:04.982 UPDATE clients 
09:39:04.982 SET request_by = s.id 
09:39:04.982 from staff s
09:39:04.982 	inner join engaged_staffs es on s.id = es.staff_id
09:39:04.982 	inner join engagements e on es.engagement_id = e.id AND es.role = 0
09:39:04.982 	inner join clients c on e.client_id = c.id
09:39:04.983 
09:39:05.002 [+] Committing Transaction
09:39:05.003 [+] 242: MigrateRequestByOfClients migrated
09:39:05.003 -------------------------------------------------------------------------------
09:39:05.003 243: AddRequestReasonOnClientsTable migrating
09:39:05.003 -------------------------------------------------------------------------------
09:39:05.004 [+] Beginning Transaction
09:39:05.006 [+] AlterTable clients
09:39:05.006 [+] CreateColumn clients request_reason String
09:39:05.008 [+] Committing Transaction
09:39:05.009 [+] 243: AddRequestReasonOnClientsTable migrated
09:39:05.009 -------------------------------------------------------------------------------
09:39:05.010 244: ChangeIdOnClientsAuditorTable migrating
09:39:05.010 -------------------------------------------------------------------------------
09:39:05.010 [+] Beginning Transaction
09:39:05.011 [+] DeleteConstraint pk_client_auditors
09:39:05.012 [+] DeleteColumn client_auditors id
09:39:05.019 [+] ExecuteSqlStatement ALTER TABLE [dbo].[client_auditors] Add [id] BIGINT identity(1,1) primary key
09:39:05.021 [+] Committing Transaction
09:39:05.022 [+] 244: ChangeIdOnClientsAuditorTable migrated
09:39:05.023 -------------------------------------------------------------------------------
09:39:05.023 245: AddCustomFieldListContentTable migrating
09:39:05.023 -------------------------------------------------------------------------------
09:39:05.023 [+] Beginning Transaction
09:39:05.024 [+] CreateTable custom_field_list_contents
09:39:05.026 [+] CreateForeignKey fk_custom_field_list_contents_ref_custom_fields custom_field_list_contents(custom_field_id) custom_fields(id)
09:39:05.027 [+] CreateIndex custom_field_list_contents (custom_field_id)
09:39:05.028 [+] Committing Transaction
09:39:05.029 [+] 245: AddCustomFieldListContentTable migrated
09:39:05.029 -------------------------------------------------------------------------------
09:39:05.029 246: AllowCustomFieldListContentsIdNullable migrating
09:39:05.030 -------------------------------------------------------------------------------
09:39:05.030 [+] Beginning Transaction
09:39:05.030 [+] AlterColumn custom_field_list_contents custom_field_id Int64
09:39:05.032 [+] Committing Transaction
09:39:05.033 [+] 246: AllowCustomFieldListContentsIdNullable migrated
09:39:05.033 -------------------------------------------------------------------------------
09:39:05.033 247: AddFeatureToggleForWorkPool migrating
09:39:05.034 -------------------------------------------------------------------------------
09:39:05.034 [+] Beginning Transaction
09:39:05.035 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:05.035 [+] Committing Transaction
09:39:05.036 [+] 247: AddFeatureToggleForWorkPool migrated
09:39:05.036 -------------------------------------------------------------------------------
09:39:05.037 248: AddRestrictedOnEngagementTable migrating
09:39:05.037 -------------------------------------------------------------------------------
09:39:05.037 [+] Beginning Transaction
09:39:05.038 [+] AlterTable engagements
09:39:05.038 [+] CreateColumn engagements restricted Boolean
09:39:05.040 [+] Committing Transaction
09:39:05.041 [+] 248: AddRestrictedOnEngagementTable migrated
09:39:05.041 -------------------------------------------------------------------------------
09:39:05.042 249: UpdateHistoryActivityOfNoFilingRequirement migrating
09:39:05.042 -------------------------------------------------------------------------------
09:39:05.042 [+] Beginning Transaction
09:39:05.046 [+] UpdateData 
09:39:05.048 [+] UpdateData 
09:39:05.049 [+] Committing Transaction
09:39:05.051 [+] 249: UpdateHistoryActivityOfNoFilingRequirement migrated
09:39:05.052 -------------------------------------------------------------------------------
09:39:05.052 250: AddFeatureToggleForEFile migrating
09:39:05.052 -------------------------------------------------------------------------------
09:39:05.053 [+] Beginning Transaction
09:39:05.054 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:05.055 [+] Committing Transaction
09:39:05.056 [+] 250: AddFeatureToggleForEFile migrated
09:39:05.057 -------------------------------------------------------------------------------
09:39:05.057 251: AddFeatureToggleCountryCustomField migrating
09:39:05.057 -------------------------------------------------------------------------------
09:39:05.058 [+] Beginning Transaction
09:39:05.059 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:05.060 [+] Committing Transaction
09:39:05.061 [+] 251: AddFeatureToggleCountryCustomField migrated
09:39:05.062 -------------------------------------------------------------------------------
09:39:05.062 252: AddCountryCustomFieldTable migrating
09:39:05.062 -------------------------------------------------------------------------------
09:39:05.062 [+] Beginning Transaction
09:39:05.065 [+] CreateTable country_custom_fields
09:39:05.072 [+] CreateForeignKey fk_country_custom_fields_ref_countries country_custom_fields(country_id) countries(id)
09:39:05.076 [+] CreateForeignKey fk_country_custom_fields_ref_staff country_custom_fields(created_by) staff(id)
09:39:05.080 [+] Committing Transaction
09:39:05.082 [+] 252: AddCountryCustomFieldTable migrated
09:39:05.084 -------------------------------------------------------------------------------
09:39:05.084 253: AddTeamColumnsInEngagedOfficeTable migrating
09:39:05.084 -------------------------------------------------------------------------------
09:39:05.085 [+] Beginning Transaction
09:39:05.087 [+] AlterTable engaged_offices
09:39:05.088 [+] CreateColumn engaged_offices team_mailbox String
09:39:05.090 [+] AlterTable engaged_offices
09:39:05.091 [+] CreateColumn engaged_offices team_phone_number String
09:39:05.095 [+] AlterTable engaged_offices
09:39:05.096 [+] CreateColumn engaged_offices team_name String
09:39:05.100 [+] Committing Transaction
09:39:05.102 [+] 253: AddTeamColumnsInEngagedOfficeTable migrated
09:39:05.103 -------------------------------------------------------------------------------
09:39:05.103 254: AddFeatureToggleForCentralMailbox migrating
09:39:05.103 -------------------------------------------------------------------------------
09:39:05.104 [+] Beginning Transaction
09:39:05.106 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:05.108 [+] Committing Transaction
09:39:05.314 [+] 254: AddFeatureToggleForCentralMailbox migrated
09:39:05.314 -------------------------------------------------------------------------------
09:39:05.315 255: AddGOMigrationWorkRecordTable migrating
09:39:05.315 -------------------------------------------------------------------------------
09:39:05.315 [+] Beginning Transaction
09:39:05.316 [+] CreateTable go_migration_workrecord
09:39:05.320 [+] Committing Transaction
09:39:05.323 [+] 255: AddGOMigrationWorkRecordTable migrated
09:39:05.323 -------------------------------------------------------------------------------
09:39:05.324 256: RemoveFeatureToggleSocialSecurity migrating
09:39:05.324 -------------------------------------------------------------------------------
09:39:05.324 [+] Beginning Transaction
09:39:05.324 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.326 [+] Committing Transaction
09:39:05.327 [+] 256: RemoveFeatureToggleSocialSecurity migrated
09:39:05.328 -------------------------------------------------------------------------------
09:39:05.328 257: AdjustCustomFieldTables migrating
09:39:05.328 -------------------------------------------------------------------------------
09:39:05.328 [+] Beginning Transaction
09:39:05.330 [+] CreateTable engagement_custom_fields
09:39:05.333 [+] CreateForeignKey fk_engagement_custom_fields_ref_custom_fields engagement_custom_fields(custom_field_id) custom_fields(id)
09:39:05.338 [+] CreateForeignKey fk_engagement_custom_fields_ref_engagements engagement_custom_fields(engagement_id) engagements(id)
09:39:05.341 [+] ExecuteSqlStatement insert into engagement_custom_fields (custom_field_id, engagement_id) select id, engagement_id from custom_fields
09:39:05.344 [+] DeleteForeignKey fk_custom_fields_ref_engagements custom_fields ()  ()
09:39:05.345 [+] DeleteColumn custom_fields engagement_id
09:39:05.353 [+] ExecuteSqlStatement truncate table country_custom_fields
09:39:05.356 [+] AlterTable country_custom_fields
09:39:05.358 [+] CreateColumn country_custom_fields custom_field_id Int64
09:39:05.359 [+] CreateForeignKey fk_country_custom_fields_ref_custom_fields country_custom_fields(custom_field_id) custom_fields(id)
09:39:05.360 [+] DeleteForeignKey fk_country_custom_fields_ref_staff country_custom_fields ()  ()
09:39:05.362 [+] DeleteColumn country_custom_fields type, name, location, created_by, created_at, restricted
09:39:05.414 [+] Committing Transaction
09:39:05.416 [+] 257: AdjustCustomFieldTables migrated
09:39:05.416 -------------------------------------------------------------------------------
09:39:05.416 258: RemoveFeatureToggleCustomFieldPhaseI migrating
09:39:05.416 -------------------------------------------------------------------------------
09:39:05.416 [+] Beginning Transaction
09:39:05.417 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.418 [+] Committing Transaction
09:39:05.419 [+] 258: RemoveFeatureToggleCustomFieldPhaseI migrated
09:39:05.419 -------------------------------------------------------------------------------
09:39:05.419 259: RemoveFeatureToggleConsent migrating
09:39:05.420 -------------------------------------------------------------------------------
09:39:05.420 [+] Beginning Transaction
09:39:05.420 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.421 [+] Committing Transaction
09:39:05.421 [+] 259: RemoveFeatureToggleConsent migrated
09:39:05.421 -------------------------------------------------------------------------------
09:39:05.421 260: RemoveFeatureToggleAdfs migrating
09:39:05.421 -------------------------------------------------------------------------------
09:39:05.421 [+] Beginning Transaction
09:39:05.422 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.423 [+] DeleteColumn users password
09:39:05.430 [+] DeleteColumn users username
09:39:05.437 [+] DeleteColumn users is_initial_password
09:39:05.444 [+] Committing Transaction
09:39:05.445 [+] 260: RemoveFeatureToggleAdfs migrated
09:39:05.445 -------------------------------------------------------------------------------
09:39:05.446 261: AddColumnPracticeTypeToStaff migrating
09:39:05.446 -------------------------------------------------------------------------------
09:39:05.446 [+] Beginning Transaction
09:39:05.447 [+] AlterTable staff
09:39:05.448 [+] CreateColumn staff practice_type Int64
09:39:05.449 [+] Committing Transaction
09:39:05.450 [+] 261: AddColumnPracticeTypeToStaff migrated
09:39:05.450 -------------------------------------------------------------------------------
09:39:05.450 262: AddFeatureToggleUACPracticeType migrating
09:39:05.451 -------------------------------------------------------------------------------
09:39:05.451 [+] Beginning Transaction
09:39:05.452 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:05.452 [+] Committing Transaction
09:39:05.453 [+] 262: AddFeatureToggleUACPracticeType migrated
09:39:05.453 -------------------------------------------------------------------------------
09:39:05.453 263: RemoveFeatureToggleUACPracticeType migrating
09:39:05.453 -------------------------------------------------------------------------------
09:39:05.454 [+] Beginning Transaction
09:39:05.454 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.455 [+] Committing Transaction
09:39:05.456 [+] 263: RemoveFeatureToggleUACPracticeType migrated
09:39:05.456 -------------------------------------------------------------------------------
09:39:05.456 264: RemoveFeatureToggleCustomFieldPhaseII migrating
09:39:05.456 -------------------------------------------------------------------------------
09:39:05.456 [+] Beginning Transaction
09:39:05.457 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.458 [+] Committing Transaction
09:39:05.458 [+] 264: RemoveFeatureToggleCustomFieldPhaseII migrated
09:39:05.459 -------------------------------------------------------------------------------
09:39:05.459 265: AddColAccessToStaffTable migrating
09:39:05.459 -------------------------------------------------------------------------------
09:39:05.459 [+] Beginning Transaction
09:39:05.460 [+] CreateColumn staff access Int32
09:39:05.462 [+] Committing Transaction
09:39:05.464 [+] 265: AddColAccessToStaffTable migrated
09:39:05.464 -------------------------------------------------------------------------------
09:39:05.464 266: AddFeatureToggleForRole migrating
09:39:05.464 -------------------------------------------------------------------------------
09:39:05.465 [+] Beginning Transaction
09:39:05.466 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:05.467 [+] Committing Transaction
09:39:05.468 [+] 266: AddFeatureToggleForRole migrated
09:39:05.469 -------------------------------------------------------------------------------
09:39:05.469 267: AddFeatureToggleForGetMyDataPhaseI migrating
09:39:05.469 -------------------------------------------------------------------------------
09:39:05.469 [+] Beginning Transaction
09:39:05.471 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:05.472 [+] Committing Transaction
09:39:05.473 [+] 267: AddFeatureToggleForGetMyDataPhaseI migrated
09:39:05.474 -------------------------------------------------------------------------------
09:39:05.475 268: AddWorkRecordEventsTable migrating
09:39:05.475 -------------------------------------------------------------------------------
09:39:05.475 [+] Beginning Transaction
09:39:05.477 [+] CreateTable events
09:39:05.480 [+] Committing Transaction
09:39:05.482 [+] 268: AddWorkRecordEventsTable migrated
09:39:05.484 -------------------------------------------------------------------------------
09:39:05.484 269: DropAggragateColumnForEventsTable migrating
09:39:05.484 -------------------------------------------------------------------------------
09:39:05.485 [+] Beginning Transaction
09:39:05.486 [+] DeleteColumn events aggregate_id
09:39:05.496 [+] Committing Transaction
09:39:05.497 [+] 269: DropAggragateColumnForEventsTable migrated
09:39:05.497 -------------------------------------------------------------------------------
09:39:05.498 270: AddAccountColumnsToAssignee migrating
09:39:05.498 -------------------------------------------------------------------------------
09:39:05.498 [+] Beginning Transaction
09:39:05.498 [+] AlterTable assignees
09:39:05.499 [+] CreateColumn assignees date_of_birth DateTime
09:39:05.500 [+] CreateColumn assignees gender String
09:39:05.501 [+] CreateColumn assignees employeeId String
09:39:05.504 [+] Committing Transaction
09:39:05.505 [+] 270: AddAccountColumnsToAssignee migrated
09:39:05.506 -------------------------------------------------------------------------------
09:39:05.506 271: RemoveAccountColumnsToAssignee migrating
09:39:05.506 -------------------------------------------------------------------------------
09:39:05.507 [+] Beginning Transaction
09:39:05.508 [+] DeleteColumn assignees date_of_birth
09:39:05.523 [+] DeleteColumn assignees gender
09:39:05.531 [+] DeleteColumn assignees employeeId
09:39:05.538 [+] Committing Transaction
09:39:05.539 [+] 271: RemoveAccountColumnsToAssignee migrated
09:39:05.539 -------------------------------------------------------------------------------
09:39:05.540 272: CleanEventBodyWithoutTypeInEventsTable migrating
09:39:05.540 -------------------------------------------------------------------------------
09:39:05.540 [+] Beginning Transaction
09:39:05.540 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.542 [+] Committing Transaction
09:39:05.542 [+] 272: CleanEventBodyWithoutTypeInEventsTable migrated
09:39:05.543 -------------------------------------------------------------------------------
09:39:05.543 273: AddColumnModifierTypeToEventsTable migrating
09:39:05.543 -------------------------------------------------------------------------------
09:39:05.543 [+] Beginning Transaction
09:39:05.544 [+] AlterTable events
09:39:05.544 [+] CreateColumn events modifier_type Int32
09:39:05.546 [+] Committing Transaction
09:39:05.546 [+] 273: AddColumnModifierTypeToEventsTable migrated
09:39:05.546 -------------------------------------------------------------------------------
09:39:05.546 274: RenameColumnModifiedByOnEventsTable migrating
09:39:05.546 -------------------------------------------------------------------------------
09:39:05.546 [+] Beginning Transaction
09:39:05.547 [+] RenameColumn events modified_by to modifier
09:39:05.549 [+] Committing Transaction
09:39:05.549 [+] 274: RenameColumnModifiedByOnEventsTable migrated
09:39:05.550 -------------------------------------------------------------------------------
09:39:05.550 275: AddApproveByAndApproveTimeInClientTable migrating
09:39:05.550 -------------------------------------------------------------------------------
09:39:05.550 [+] Beginning Transaction
09:39:05.551 [+] AlterTable clients
09:39:05.552 [+] CreateColumn clients approve_by Int64
09:39:05.555 [+] AlterTable clients
09:39:05.556 [+] CreateColumn clients approve_time DateTime
09:39:05.558 [+] Committing Transaction
09:39:05.559 [+] 275: AddApproveByAndApproveTimeInClientTable migrated
09:39:05.560 -------------------------------------------------------------------------------
09:39:05.560 276: AddStatusColumnToStaffTable migrating
09:39:05.561 -------------------------------------------------------------------------------
09:39:05.561 [+] Beginning Transaction
09:39:05.563 [+] CreateColumn staff status Int32
09:39:05.567 [+] ExecuteSqlStatement update staff set status=1
09:39:05.570 [+] AlterTable staff
09:39:05.571 [+] AlterColumn staff status Int32
09:39:05.582 [+] Committing Transaction
09:39:05.583 [+] 276: AddStatusColumnToStaffTable migrated
09:39:05.585 -------------------------------------------------------------------------------
09:39:05.585 277: AddEntityIdForEvent migrating
09:39:05.585 -------------------------------------------------------------------------------
09:39:05.585 [+] Beginning Transaction
09:39:05.587 [+] AlterTable events
09:39:05.588 [+] CreateColumn events entity_id Int64
09:39:05.596 [+] ExecuteSqlStatement UPDATE events SET entity_id = Substring(body, Charindex(':', body, Charindex('"EntityId"', body, 0)) + 1, Charindex(',', body, Charindex('"EntityId"', body, 0)) -  Charindex(':', body, Charindex('"EntityId"', body, 0)) - 1) FROM events
09:39:05.602 [+] Committing Transaction
09:39:05.604 [+] 277: AddEntityIdForEvent migrated
09:39:05.606 -------------------------------------------------------------------------------
09:39:05.606 278: InitailizeAssigneeEvents migrating
09:39:05.606 -------------------------------------------------------------------------------
09:39:05.607 [+] Beginning Transaction
09:39:05.608 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.613 [+] ExecuteSqlStatement insert into events (occured_at,modifier,[type],body,modifier_type,entity_id) select getdate(),0,2,'{"$type":"assn-created","EntityId":'+cast(id as varchar)+',"Snapshot":{"$type":"assn-snapshot","FirstName":"'+cast(first_name as varchar)+'","LastName":"'+cast(last_name as varchar)+'","Id":'+cast(id as varchar)+'},"DomainEventType":2}',0,id from assignees
09:39:05.619 [+] Committing Transaction
09:39:05.621 [+] 278: InitailizeAssigneeEvents migrated
09:39:05.622 -------------------------------------------------------------------------------
09:39:05.622 279: AddVersionColumnToEventsTable migrating
09:39:05.622 -------------------------------------------------------------------------------
09:39:05.622 [+] Beginning Transaction
09:39:05.624 [+] CreateColumn events event_version Int64
09:39:05.629 [+] Committing Transaction
09:39:05.630 [+] 279: AddVersionColumnToEventsTable migrated
09:39:05.632 -------------------------------------------------------------------------------
09:39:05.632 280: AddIndexOfAssigneeIdOnAssigneeCustomFieldsValueTable migrating
09:39:05.632 -------------------------------------------------------------------------------
09:39:05.632 [+] Beginning Transaction
09:39:05.634 [+] CreateIndex assignee_custom_fields_value (assignee_id)
09:39:05.638 [+] Committing Transaction
09:39:05.640 [+] 280: AddIndexOfAssigneeIdOnAssigneeCustomFieldsValueTable migrated
09:39:05.641 -------------------------------------------------------------------------------
09:39:05.641 281: AddIndexOfAssigneeIdOnAssigneeReportsTable migrating
09:39:05.642 -------------------------------------------------------------------------------
09:39:05.642 [+] Beginning Transaction
09:39:05.644 [+] CreateIndex assignee_reports (assignee_id)
09:39:05.648 [+] Committing Transaction
09:39:05.650 [+] 281: AddIndexOfAssigneeIdOnAssigneeReportsTable migrated
09:39:05.651 -------------------------------------------------------------------------------
09:39:05.651 282: AddIndexOfEngagementIdOnEngagedOfficesTable migrating
09:39:05.651 -------------------------------------------------------------------------------
09:39:05.652 [+] Beginning Transaction
09:39:05.654 [+] CreateIndex engaged_offices (engagement_id)
09:39:05.662 [+] Committing Transaction
09:39:05.666 [+] 282: AddIndexOfEngagementIdOnEngagedOfficesTable migrated
09:39:05.667 -------------------------------------------------------------------------------
09:39:05.667 283: AddIndexOfWorkRecordIdOnWorkRecordCustomFieldsValueTable migrating
09:39:05.667 -------------------------------------------------------------------------------
09:39:05.668 [+] Beginning Transaction
09:39:05.669 [+] CreateIndex work_record_custom_fields_value (work_record_id)
09:39:05.672 [+] Committing Transaction
09:39:05.674 [+] 283: AddIndexOfWorkRecordIdOnWorkRecordCustomFieldsValueTable migrated
09:39:05.675 -------------------------------------------------------------------------------
09:39:05.676 284: AddIndexOfWorkRecordIdOnWorkRecordNominationTable migrating
09:39:05.676 -------------------------------------------------------------------------------
09:39:05.676 [+] Beginning Transaction
09:39:05.678 [+] CreateIndex work_record_nomination (work_record_id)
09:39:05.682 [+] Committing Transaction
09:39:05.684 [+] 284: AddIndexOfWorkRecordIdOnWorkRecordNominationTable migrated
09:39:05.685 -------------------------------------------------------------------------------
09:39:05.685 285: AddFeatureToggleForAssigneeEngagements migrating
09:39:05.686 -------------------------------------------------------------------------------
09:39:05.686 [+] Beginning Transaction
09:39:05.688 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:05.690 [+] Committing Transaction
09:39:05.692 [+] 285: AddFeatureToggleForAssigneeEngagements migrated
09:39:05.693 -------------------------------------------------------------------------------
09:39:05.693 286: AddEngagementIdToAssigneeContactTable migrating
09:39:05.693 -------------------------------------------------------------------------------
09:39:05.694 [+] Beginning Transaction
09:39:05.695 [+] AlterTable assignee_contact
09:39:05.696 [+] CreateColumn assignee_contact engagement_id Int64
09:39:05.700 [+] CreateForeignKey fk_assignee_contact_ref_engagements assignee_contact(engagement_id) engagements(id)
09:39:05.704 [+] Committing Transaction
09:39:05.706 [+] 286: AddEngagementIdToAssigneeContactTable migrated
09:39:05.707 -------------------------------------------------------------------------------
09:39:05.707 287: ChangeAssigneeIdColumnToBeNullableForConfirmedUnsignConsent migrating
09:39:05.707 -------------------------------------------------------------------------------
09:39:05.708 [+] Beginning Transaction
09:39:05.710 [+] AlterTable confirmed_unsigned_consent
09:39:05.711 [+] AlterColumn confirmed_unsigned_consent assignee_id Int64
09:39:05.714 [+] Committing Transaction
09:39:05.715 [+] 287: ChangeAssigneeIdColumnToBeNullableForConfirmedUnsignConsent migrated
09:39:05.716 -------------------------------------------------------------------------------
09:39:05.716 288: AddAccountIdToEventBody migrating
09:39:05.717 -------------------------------------------------------------------------------
09:39:05.717 [+] Beginning Transaction
09:39:05.719 [+] ExecuteSqlStatement   UPDATE events
09:39:05.719   SET events.body = replace(events.body, '"assn-snapshot","First', '"assn-snapshot","AccountId":"'+ cast(assignees.account_id as varchar(48))+'","First')
09:39:05.719   FROM events
09:39:05.719   INNER JOIN work_records
09:39:05.719   ON work_records.id = events.entity_id
09:39:05.719   INNER JOIN assignees
09:39:05.720   ON assignees.id = work_records.assignee_id
09:39:05.720   WHERE events.type >= 50
09:39:05.735 [+] Committing Transaction
09:39:05.737 [+] 288: AddAccountIdToEventBody migrated
09:39:05.738 -------------------------------------------------------------------------------
09:39:05.738 289: UpdateImmigrationQuestionnaireSubmittedEventTypeInEvents migrating
09:39:05.738 -------------------------------------------------------------------------------
09:39:05.739 [+] Beginning Transaction
09:39:05.740 [+] ExecuteSqlStatement UPDATE events
09:39:05.740   SET events.body = replace(events.body, '"DomainEventType":51}', '"DomainEventType":60}'),
09:39:05.741   events.type=60
09:39:05.741   FROM events
09:39:05.741   WHERE events.type=51
09:39:05.746 [+] Committing Transaction
09:39:05.747 [+] 289: UpdateImmigrationQuestionnaireSubmittedEventTypeInEvents migrated
09:39:05.749 -------------------------------------------------------------------------------
09:39:05.749 290: AddMyDataCriteriaTable migrating
09:39:05.749 -------------------------------------------------------------------------------
09:39:05.750 [+] Beginning Transaction
09:39:05.752 [+] CreateTable mydata_criteria
09:39:05.754 [+] CreateIndex mydata_criteria (id)
09:39:05.758 [+] Committing Transaction
09:39:05.760 [+] 290: AddMyDataCriteriaTable migrated
09:39:05.762 -------------------------------------------------------------------------------
09:39:05.762 291: AddPwCChannelFieldInClientTable migrating
09:39:05.762 -------------------------------------------------------------------------------
09:39:05.763 [+] Beginning Transaction
09:39:05.764 [+] AlterTable clients
09:39:05.766 [+] CreateColumn clients pwc_channel String
09:39:05.769 [+] Committing Transaction
09:39:05.771 [+] 291: AddPwCChannelFieldInClientTable migrated
09:39:05.773 -------------------------------------------------------------------------------
09:39:05.773 292: UpdateQuestionnaireEventTypeInEvents migrating
09:39:05.773 -------------------------------------------------------------------------------
09:39:05.774 [+] Beginning Transaction
09:39:05.779 [+] ExecuteSqlStatement UPDATE events
09:39:05.779   SET events.body = replace(events.body, '"DomainEventType":60}', '"DomainEventType":50}'),
09:39:05.779   events.type=50
09:39:05.780   FROM events
09:39:05.780   WHERE events.type=60
09:39:05.784 [+] ExecuteSqlStatement UPDATE events
09:39:05.784   SET events.body = replace(events.body, '"DomainEventType":62}', '"DomainEventType":52}'),
09:39:05.784   events.type=52
09:39:05.784   FROM events
09:39:05.785   WHERE events.type=62
09:39:05.792 [+] ExecuteSqlStatement UPDATE events
09:39:05.793   SET events.body = replace(events.body, '"DomainEventType":63}', '"DomainEventType":53}'),
09:39:05.793   events.type=53
09:39:05.794   FROM events
09:39:05.794   WHERE events.type=63
09:39:05.798 [+] ExecuteSqlStatement UPDATE events
09:39:05.798   SET events.body = replace(events.body, '"DomainEventType":64}', '"DomainEventType":53}'),
09:39:05.798   events.type=53
09:39:05.798   FROM events
09:39:05.798   WHERE events.type=64
09:39:05.802 [+] ExecuteSqlStatement UPDATE events
09:39:05.803   SET events.body = replace(events.body, '"DomainEventType":54}', '"DomainEventType":53}'),
09:39:05.803   events.type=53
09:39:05.803   FROM events
09:39:05.803   WHERE events.type=54
09:39:05.808 [+] Committing Transaction
09:39:05.810 [+] 292: UpdateQuestionnaireEventTypeInEvents migrated
09:39:05.812 -------------------------------------------------------------------------------
09:39:05.812 293: UpdateQuestionnaireUserEventTypeInEvents migrating
09:39:05.812 -------------------------------------------------------------------------------
09:39:05.813 [+] Beginning Transaction
09:39:05.815 [+] ExecuteSqlStatement UPDATE events
09:39:05.815   SET events.body = replace(events.body, '"$type":"tax-questionnaire-submitted"', '"$type":"questionnaire-submitted"')
09:39:05.815   FROM events
09:39:05.819 [+] ExecuteSqlStatement UPDATE events
09:39:05.819   SET events.body = replace(events.body, '"$type":"tax-questionnaire-activated"', '"$type":"questionnaire-activated"')
09:39:05.819   FROM events
09:39:05.822 [+] ExecuteSqlStatement UPDATE events
09:39:05.823   SET events.body = replace(events.body, '"$type":"tax-questionnaire-started"', '"$type":"questionnaire-started"')
09:39:05.823   FROM events
09:39:05.826 [+] ExecuteSqlStatement UPDATE events
09:39:05.826   SET events.body = replace(events.body, '"$type":"tax-questionnaire-restarted"', '"$type":"questionnaire-started"')
09:39:05.826   FROM events
09:39:05.829 [+] ExecuteSqlStatement UPDATE events
09:39:05.829   SET events.body = replace(events.body, '"$type":"immigration-questionnaire-submitted"', '"$type":"questionnaire-submitted"')
09:39:05.829   FROM events
09:39:05.832 [+] ExecuteSqlStatement UPDATE events
09:39:05.833   SET events.body = replace(events.body, '"$type":"immi-questionnaire-activated"', '"$type":"questionnaire-activated"')
09:39:05.833   FROM events
09:39:05.836 [+] ExecuteSqlStatement UPDATE events
09:39:05.836   SET events.body = replace(events.body, '"$type":"immi-questionnaire-started"', '"$type":"questionnaire-started"')
09:39:05.836   FROM events
09:39:05.839 [+] ExecuteSqlStatement UPDATE events
09:39:05.839   SET events.body = replace(events.body, '"$type":"immi-questionnaire-restarted"', '"$type":"questionnaire-started"')
09:39:05.839   FROM events
09:39:05.843 [+] Committing Transaction
09:39:05.845 [+] 293: UpdateQuestionnaireUserEventTypeInEvents migrated
09:39:05.846 -------------------------------------------------------------------------------
09:39:05.847 294: MigrateOriginalEngagementIdToAssigneeContactTable migrating
09:39:05.847 -------------------------------------------------------------------------------
09:39:05.848 [+] Beginning Transaction
09:39:05.849 [+] ExecuteSqlStatement 
09:39:05.849                 UPDATE ac SET ac.engagement_id = ae.engagement_id
09:39:05.849                 FROM dbo.assignee_contact ac
09:39:05.850 	                INNER JOIN dbo.assignees_engagements ae
09:39:05.850 		                ON ac.assignee_id = ae.assignee_id
09:39:05.850 	                INNER JOIN dbo.staff s
09:39:05.850 		                ON ac.staff_id = s.id
09:39:05.850                 WHERE EXISTS (
09:39:05.850 	                SELECT TOP(1) 1
09:39:05.850 	                FROM dbo.engaged_offices eo
09:39:05.850 	                WHERE eo.engagement_id = ae.engagement_id
09:39:05.850 		                AND eo.office_id = s.office_id
09:39:05.850                 )                
09:39:05.850             
09:39:05.892 [+] Committing Transaction
09:39:05.893 [+] 294: MigrateOriginalEngagementIdToAssigneeContactTable migrated
09:39:05.893 -------------------------------------------------------------------------------
09:39:05.893 295: AddEngagedAccessControlListTable migrating
09:39:05.893 -------------------------------------------------------------------------------
09:39:05.893 [+] Beginning Transaction
09:39:05.894 [+] CreateTable engaged_access_controls
09:39:05.896 [+] CreateIndex engaged_access_controls (id)
09:39:05.897 [+] Committing Transaction
09:39:05.898 [+] 295: AddEngagedAccessControlListTable migrated
09:39:05.898 -------------------------------------------------------------------------------
09:39:05.898 296: InitAccessControlsForExistEngagement migrating
09:39:05.898 -------------------------------------------------------------------------------
09:39:05.898 [+] Beginning Transaction
09:39:05.899 [+] ExecuteSqlStatement     insert into engaged_access_controls (engagement_id,staff_id)
09:39:05.899                       select   office.engagement_id   engagement_id
09:39:05.899                               ,staff.staff_id         staff_id 
09:39:05.899                         from   engaged_offices        office
09:39:05.899                               ,engaged_office_staff   staff 
09:39:05.899                        where   staff.role=0 
09:39:05.899                          and   office.office_id  =  staff.engaged_office_id
09:39:05.899                        union
09:39:05.899                       select   engagement_id
09:39:05.899                               ,staff_id 
09:39:05.899                         from   dbo.engaged_staffs
09:39:05.899                        where   role=0
09:39:05.900                       
09:39:05.909 [+] Committing Transaction
09:39:05.911 [+] 296: InitAccessControlsForExistEngagement migrated
09:39:05.912 -------------------------------------------------------------------------------
09:39:05.912 298: InitailizeWorkrecordEvents migrating
09:39:05.912 -------------------------------------------------------------------------------
09:39:05.913 [+] Beginning Transaction
09:39:05.913 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.915 [+] ExecuteSqlStatement insert into [events] (occured_at,modifier,[type],body,modifier_type,entity_id) select getdate(),0,0,'{"$type":"wr-created","EntityId":'+cast(w.id as varchar)+',"Snapshot":{"$type":"wr-snapshot","WorkRecordId":'+cast(w.id as varchar)+',"PracticeType":'+cast(w.practice_type as varchar)+',"Name":"'+ w.name+'","TargetMilestone":'+cast(w.current_milestone_name as varchar)+',"Jurisdiction":{"$type":"country","Name":"'+c.name+'","Abbreviation":"'+c.abbreviation+'","Id":'+cast(c.id as varchar)+' },"AssigneeId":'+cast(w.assignee_id as varchar)+',"AssigneeFirstName":"'+a.first_name+'","AssigneeLastName":"'+a.last_name+'"},"DomainEventType":0}',0,w.id from work_records w inner join assignees a on w.assignee_id = a.id inner join types_of_service t on w.primary_service_id = t.id inner join countries c on t.country_id = c.id
09:39:05.922 [+] Committing Transaction
09:39:05.924 [+] 298: InitailizeWorkrecordEvents migrated
09:39:05.925 -------------------------------------------------------------------------------
09:39:05.925 299: MigratePracticeTypeInEventsBody migrating
09:39:05.926 -------------------------------------------------------------------------------
09:39:05.926 [+] Beginning Transaction
09:39:05.928 [+] ExecuteSqlStatement UPDATE events SET events.body = replace(events.body, '"PracticeType":0', '"PracticeType":"Tax"')
09:39:05.931 [+] ExecuteSqlStatement UPDATE events SET events.body = replace(events.body, '"PracticeType":1', '"PracticeType":"Immigration"')
09:39:05.933 [+] ExecuteSqlStatement UPDATE events SET events.body = replace(events.body, '"PracticeType":2', '"PracticeType":"Social Security"')
09:39:05.935 [+] Committing Transaction
09:39:05.937 [+] 299: MigratePracticeTypeInEventsBody migrated
09:39:05.938 -------------------------------------------------------------------------------
09:39:05.938 300: CleanupEvents migrating
09:39:05.938 -------------------------------------------------------------------------------
09:39:05.939 [+] Beginning Transaction
09:39:05.941 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.943 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.944 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.946 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.949 [+] Committing Transaction
09:39:05.950 [+] 300: CleanupEvents migrated
09:39:05.952 -------------------------------------------------------------------------------
09:39:05.952 301: AddFeatureToggleForEfileReport migrating
09:39:05.952 -------------------------------------------------------------------------------
09:39:05.953 [+] Beginning Transaction
09:39:05.955 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:05.956 [+] Committing Transaction
09:39:05.958 [+] 301: AddFeatureToggleForEfileReport migrated
09:39:05.959 -------------------------------------------------------------------------------
09:39:05.960 302: ReInitailizeAssigneeEvents migrating
09:39:05.960 -------------------------------------------------------------------------------
09:39:05.960 [+] Beginning Transaction
09:39:05.962 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.964 [+] ExecuteSqlStatement insert into events (occured_at,modifier,[type],body,modifier_type,entity_id) select getutcdate(),0,2,'{"$type":"assn-created","EntityId":'+cast(id as varchar)+',"Snapshot":{"$type":"assn-snapshot","FirstName":"'+cast(first_name as varchar)+'","LastName":"'+cast(last_name as varchar)+'","Id":'+cast(id as varchar)+'},"DomainEventType":2}',0,id from assignees
09:39:05.968 [+] Committing Transaction
09:39:05.970 [+] 302: ReInitailizeAssigneeEvents migrated
09:39:05.972 -------------------------------------------------------------------------------
09:39:05.972 303: ReInitailizeWorkrecordEvents migrating
09:39:05.972 -------------------------------------------------------------------------------
09:39:05.973 [+] Beginning Transaction
09:39:05.974 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:05.976 [+] ExecuteSqlStatement insert into [events] (occured_at,modifier,[type],body,modifier_type,entity_id) select getutcdate(),0,0,'{"$type":"wr-created","EntityId":'+cast(w.id as varchar)+',"Snapshot":{"$type":"wr-snapshot","WorkRecordId":'+cast(w.id as varchar)+',"PracticeType":'+cast(w.practice_type as varchar)+',"Name":"'+ w.name+'","TargetMilestone":'+cast(w.current_milestone_name as varchar)+',"Jurisdiction":{"$type":"country","Name":"'+c.name+'","Abbreviation":"'+c.abbreviation+'","Id":'+cast(c.id as varchar)+' },"AssigneeId":'+cast(w.assignee_id as varchar)+',"AssigneeFirstName":"'+a.first_name+'","AssigneeLastName":"'+a.last_name+'"},"DomainEventType":0}',0,w.id from work_records w inner join assignees a on w.assignee_id = a.id inner join types_of_service t on w.primary_service_id = t.id inner join countries c on t.country_id = c.id
09:39:05.986 [+] Committing Transaction
09:39:05.988 [+] 303: ReInitailizeWorkrecordEvents migrated
09:39:05.989 -------------------------------------------------------------------------------
09:39:05.989 304: ReMigratePracticeTypeInEventsBody migrating
09:39:05.989 -------------------------------------------------------------------------------
09:39:05.990 [+] Beginning Transaction
09:39:05.991 [+] ExecuteSqlStatement UPDATE events SET events.body = replace(events.body, '"PracticeType":0', '"PracticeType":"Tax"')
09:39:05.992 [+] ExecuteSqlStatement UPDATE events SET events.body = replace(events.body, '"PracticeType":1', '"PracticeType":"Immigration"')
09:39:05.994 [+] ExecuteSqlStatement UPDATE events SET events.body = replace(events.body, '"PracticeType":2', '"PracticeType":"Social Security"')
09:39:05.996 [+] Committing Transaction
09:39:05.998 [+] 304: ReMigratePracticeTypeInEventsBody migrated
09:39:06.000 -------------------------------------------------------------------------------
09:39:06.000 305: RemoveFeatureToggleServiceStatusAndWorkPool migrating
09:39:06.000 -------------------------------------------------------------------------------
09:39:06.000 [+] Beginning Transaction
09:39:06.002 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.003 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.005 [+] Committing Transaction
09:39:06.007 [+] 305: RemoveFeatureToggleServiceStatusAndWorkPool migrated
09:39:06.009 -------------------------------------------------------------------------------
09:39:06.009 306: DeleteTableClientAuditorAndClientSince migrating
09:39:06.009 -------------------------------------------------------------------------------
09:39:06.010 [+] Beginning Transaction
09:39:06.011 [+] DeleteTable client_auditors
09:39:06.015 [+] DeleteColumn clients client_since
09:39:06.034 [+] Committing Transaction
09:39:06.036 [+] 306: DeleteTableClientAuditorAndClientSince migrated
09:39:06.038 -------------------------------------------------------------------------------
09:39:06.038 307: AddFeatureToggleForNavigation migrating
09:39:06.038 -------------------------------------------------------------------------------
09:39:06.039 [+] Beginning Transaction
09:39:06.041 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.043 [+] Committing Transaction
09:39:06.044 [+] 307: AddFeatureToggleForNavigation migrated
09:39:06.045 -------------------------------------------------------------------------------
09:39:06.045 308: AddEfileGroupMembersTable migrating
09:39:06.045 -------------------------------------------------------------------------------
09:39:06.048 [+] Beginning Transaction
09:39:06.053 [+] CreateTable efile_group_members
09:39:06.057 [+] CreateIndex efile_group_members (country_id, staff_id)
09:39:06.061 [+] CreateIndex efile_group_members (id)
09:39:06.065 [+] Committing Transaction
09:39:06.067 [+] 308: AddEfileGroupMembersTable migrated
09:39:06.068 -------------------------------------------------------------------------------
09:39:06.069 309: AddEfileGroupTable migrating
09:39:06.069 -------------------------------------------------------------------------------
09:39:06.069 [+] Beginning Transaction
09:39:06.071 [+] CreateTable efile_groups
09:39:06.075 [+] CreateIndex efile_groups (id)
09:39:06.078 [+] Committing Transaction
09:39:06.080 [+] 309: AddEfileGroupTable migrated
09:39:06.082 -------------------------------------------------------------------------------
09:39:06.082 310: AddUkDeIeEfileGroups migrating
09:39:06.082 -------------------------------------------------------------------------------
09:39:06.083 [+] Beginning Transaction
09:39:06.084 [+] ExecuteSqlStatement INSERT INTO efile_groups(country_id, email) SELECT id, '' FROM countries WHERE abbreviation IN ('UK', 'DE', 'IE')
09:39:06.090 [+] Committing Transaction
09:39:06.092 [+] 310: AddUkDeIeEfileGroups migrated
09:39:06.093 -------------------------------------------------------------------------------
09:39:06.093 311: RemoveFeatureToggleClientEngagementAndCentralMailbox migrating
09:39:06.093 -------------------------------------------------------------------------------
09:39:06.094 [+] Beginning Transaction
09:39:06.096 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.098 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.100 [+] Committing Transaction
09:39:06.102 [+] 311: RemoveFeatureToggleClientEngagementAndCentralMailbox migrated
09:39:06.103 -------------------------------------------------------------------------------
09:39:06.104 312: AddFeatureToggleForUac2 migrating
09:39:06.104 -------------------------------------------------------------------------------
09:39:06.104 [+] Beginning Transaction
09:39:06.107 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.108 [+] Committing Transaction
09:39:06.110 [+] 312: AddFeatureToggleForUac2 migrated
09:39:06.112 -------------------------------------------------------------------------------
09:39:06.113 313: RemoveFeatureToggleUac migrating
09:39:06.114 -------------------------------------------------------------------------------
09:39:06.118 [+] Beginning Transaction
09:39:06.120 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.122 [+] Committing Transaction
09:39:06.124 [+] 313: RemoveFeatureToggleUac migrated
09:39:06.125 -------------------------------------------------------------------------------
09:39:06.125 314: RemoveFeatureToggleRole migrating
09:39:06.126 -------------------------------------------------------------------------------
09:39:06.126 [+] Beginning Transaction
09:39:06.128 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.129 [+] Committing Transaction
09:39:06.131 [+] 314: RemoveFeatureToggleRole migrated
09:39:06.132 -------------------------------------------------------------------------------
09:39:06.133 315: AddPrimaryKeyForWorkRecord migrating
09:39:06.133 -------------------------------------------------------------------------------
09:39:06.133 [+] Beginning Transaction
09:39:06.135 [+] ExecuteSqlStatement ALTER TABLE work_records ADD CONSTRAINT PK_work_records_id PRIMARY KEY NONCLUSTERED (id) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
09:39:06.140 [+] Committing Transaction
09:39:06.142 [+] 315: AddPrimaryKeyForWorkRecord migrated
09:39:06.143 -------------------------------------------------------------------------------
09:39:06.143 316: AddPrimaryKeyForAssigneeEngagements migrating
09:39:06.143 -------------------------------------------------------------------------------
09:39:06.144 [+] Beginning Transaction
09:39:06.145 [+] ExecuteSqlStatement ALTER TABLE assignees_engagements ADD CONSTRAINT PK_assignees_engagements PRIMARY KEY CLUSTERED (assignee_id,engagement_id) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
09:39:06.151 [+] Committing Transaction
09:39:06.153 [+] 316: AddPrimaryKeyForAssigneeEngagements migrated
09:39:06.154 -------------------------------------------------------------------------------
09:39:06.155 317: AddPrimaryKeyForMilestone migrating
09:39:06.155 -------------------------------------------------------------------------------
09:39:06.155 [+] Beginning Transaction
09:39:06.157 [+] ExecuteSqlStatement ALTER TABLE milestones ADD CONSTRAINT PK_milestones_id PRIMARY KEY NONCLUSTERED (id) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
09:39:06.162 [+] Committing Transaction
09:39:06.164 [+] 317: AddPrimaryKeyForMilestone migrated
09:39:06.166 -------------------------------------------------------------------------------
09:39:06.166 318: AddPrimaryKeyForEfileGroup migrating
09:39:06.166 -------------------------------------------------------------------------------
09:39:06.166 [+] Beginning Transaction
09:39:06.168 [+] ExecuteSqlStatement ALTER TABLE efile_groups ADD CONSTRAINT PK_efile_groups_id PRIMARY KEY CLUSTERED (id) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
09:39:06.174 [+] Committing Transaction
09:39:06.178 [+] 318: AddPrimaryKeyForEfileGroup migrated
09:39:06.184 -------------------------------------------------------------------------------
09:39:06.184 319: AddPrimaryKeyForEfileGroupMember migrating
09:39:06.185 -------------------------------------------------------------------------------
09:39:06.185 [+] Beginning Transaction
09:39:06.187 [+] ExecuteSqlStatement ALTER TABLE efile_group_members ADD CONSTRAINT PK_efile_group_members_id PRIMARY KEY NONCLUSTERED (id) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
09:39:06.192 [+] Committing Transaction
09:39:06.194 [+] 319: AddPrimaryKeyForEfileGroupMember migrated
09:39:06.196 -------------------------------------------------------------------------------
09:39:06.196 320: AddPrimaryKeyForEngagedAccessControl migrating
09:39:06.196 -------------------------------------------------------------------------------
09:39:06.196 [+] Beginning Transaction
09:39:06.198 [+] ExecuteSqlStatement ALTER TABLE engaged_access_controls ADD CONSTRAINT PK_engaged_access_controls_id PRIMARY KEY CLUSTERED (id) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
09:39:06.204 [+] Committing Transaction
09:39:06.206 [+] 320: AddPrimaryKeyForEngagedAccessControl migrated
09:39:06.208 -------------------------------------------------------------------------------
09:39:06.208 321: RemoveFeatureToggleCustomField migrating
09:39:06.208 -------------------------------------------------------------------------------
09:39:06.208 [+] Beginning Transaction
09:39:06.210 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.211 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.214 [+] Committing Transaction
09:39:06.215 [+] 321: RemoveFeatureToggleCustomField migrated
09:39:06.217 -------------------------------------------------------------------------------
09:39:06.217 322: AddSuspendedForWorkRecord migrating
09:39:06.217 -------------------------------------------------------------------------------
09:39:06.217 [+] Beginning Transaction
09:39:06.219 [+] ExecuteSqlStatement update work_records set service_status = isnull(service_status, 0)
09:39:06.224 [+] AlterTable work_records
09:39:06.225 [+] CreateColumn work_records suspended Boolean
09:39:06.229 [+] ExecuteSqlStatement update work_records set suspended = (case w.service_status + isnull(o.no_filing_requirement, 0) when 0 then 0 else 1 end) from work_records w left join organizers o on w.id = o.work_record_id
09:39:06.237 [+] Committing Transaction
09:39:06.239 [+] 322: AddSuspendedForWorkRecord migrated
09:39:06.240 -------------------------------------------------------------------------------
09:39:06.240 323: AddEntityTypeIntoEventsTable migrating
09:39:06.241 -------------------------------------------------------------------------------
09:39:06.242 [+] Beginning Transaction
09:39:06.251 [+] RenameColumn events type to event_type
09:39:06.254 [+] AlterTable events
09:39:06.255 [+] CreateColumn events entity_type String
09:39:06.259 [+] Committing Transaction
09:39:06.261 [+] 323: AddEntityTypeIntoEventsTable migrated
09:39:06.262 -------------------------------------------------------------------------------
09:39:06.263 324: MigrateEntityTypeIntoEvents migrating
09:39:06.263 -------------------------------------------------------------------------------
09:39:06.263 [+] Beginning Transaction
09:39:06.272 [+] ExecuteSqlStatement UPDATE events SET entity_type = 2 WHERE event_type=0
09:39:06.277 [+] ExecuteSqlStatement UPDATE events SET entity_type = 2 WHERE event_type=1
09:39:06.279 [+] ExecuteSqlStatement UPDATE events SET entity_type = 2 WHERE event_type=101
09:39:06.281 [+] ExecuteSqlStatement UPDATE events SET entity_type = 2 WHERE event_type=50
09:39:06.283 [+] ExecuteSqlStatement UPDATE events SET entity_type = 2 WHERE event_type=52
09:39:06.284 [+] ExecuteSqlStatement UPDATE events SET entity_type = 2 WHERE event_type=53
09:39:06.286 [+] ExecuteSqlStatement UPDATE events SET entity_type = 1 WHERE event_type=2
09:39:06.288 [+] ExecuteSqlStatement UPDATE events SET entity_type = 1 WHERE event_type=3
09:39:06.290 [+] ExecuteSqlStatement UPDATE events SET entity_type = 3 WHERE event_type=100
09:39:06.291 [+] ExecuteSqlStatement UPDATE events SET entity_type = 3 WHERE event_type=102
09:39:06.294 [+] Committing Transaction
09:39:06.295 [+] 324: MigrateEntityTypeIntoEvents migrated
09:39:06.296 -------------------------------------------------------------------------------
09:39:06.296 325: MigrateEntityTypeToIntIntoEvents migrating
09:39:06.297 -------------------------------------------------------------------------------
09:39:06.297 [+] Beginning Transaction
09:39:06.300 [+] ExecuteSqlStatement UPDATE events SET entity_type = 1 WHERE entity_type='Assignee'
09:39:06.306 [+] ExecuteSqlStatement UPDATE events SET entity_type = 2 WHERE entity_type='WorkRecord'
09:39:06.308 [+] ExecuteSqlStatement UPDATE events SET entity_type = 3 WHERE entity_type='Engagement'
09:39:06.310 [+] Committing Transaction
09:39:06.318 [+] 325: MigrateEntityTypeToIntIntoEvents migrated
09:39:06.320 -------------------------------------------------------------------------------
09:39:06.320 326: MigrateAssigneeCreatedEvents migrating
09:39:06.320 -------------------------------------------------------------------------------
09:39:06.321 [+] Beginning Transaction
09:39:06.323 [+] ExecuteSqlStatement  UPDATE events
09:39:06.323 SET events.body = replace(events.body, '"assn-snapshot",', '"assn-snapshot","HomeCountry":{"$type":"country","Name":"'+ cast(countries.name as varchar)+'", "Abbreviation": "'+ cast(countries.abbreviation as varchar) + '", "Id":'+ cast(countries.id as varchar)+'},')
09:39:06.323   FROM events
09:39:06.323   INNER JOIN assignees
09:39:06.323   ON assignees.id = events.entity_id
09:39:06.323   INNER JOIN countries
09:39:06.324   ON countries.id = assignees.home_country_id
09:39:06.324   WHERE events.entity_id = 27
09:39:06.324   and events.event_type = 2
09:39:06.324   and not (events.body like '%HomeCountry%')
09:39:06.348 [+] Committing Transaction
09:39:06.350 [+] 326: MigrateAssigneeCreatedEvents migrated
09:39:06.352 -------------------------------------------------------------------------------
09:39:06.352 327: AddEntityIdIndexToEvents migrating
09:39:06.352 -------------------------------------------------------------------------------
09:39:06.353 [+] Beginning Transaction
09:39:06.354 [+] ExecuteSqlStatement CREATE NONCLUSTERED INDEX events_entity_type ON events ([entity_id])INCLUDE ([entity_type],[event_type])
09:39:06.358 [+] Committing Transaction
09:39:06.371 [+] 327: AddEntityIdIndexToEvents migrated
09:39:06.373 -------------------------------------------------------------------------------
09:39:06.373 328: RemoveWorkRecordTaskForeignKeyFromTodoItems migrating
09:39:06.373 -------------------------------------------------------------------------------
09:39:06.374 [+] Beginning Transaction
09:39:06.375 [+] DeleteForeignKey fk_todo_items_ref_work_record_tasks todo_items ()  ()
09:39:06.382 [+] Committing Transaction
09:39:06.384 [+] 328: RemoveWorkRecordTaskForeignKeyFromTodoItems migrated
09:39:06.385 -------------------------------------------------------------------------------
09:39:06.386 329: RemoveFeatureToggleNavigation migrating
09:39:06.386 -------------------------------------------------------------------------------
09:39:06.386 [+] Beginning Transaction
09:39:06.388 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.391 [+] Committing Transaction
09:39:06.404 [+] 329: RemoveFeatureToggleNavigation migrated
09:39:06.406 -------------------------------------------------------------------------------
09:39:06.406 330: MoveIRMarkToWorkRecord migrating
09:39:06.406 -------------------------------------------------------------------------------
09:39:06.407 [+] Beginning Transaction
09:39:06.409 [+] AlterTable work_records
09:39:06.410 [+] CreateColumn work_records ir_mark String
09:39:06.413 [+] ExecuteSqlStatement update work_records set ir_mark = o.ir_mark from work_records w left join organizers o on w.id = o.work_record_id
09:39:06.420 [+] DeleteColumn organizers ir_mark
09:39:06.435 [+] Committing Transaction
09:39:06.437 [+] 330: MoveIRMarkToWorkRecord migrated
09:39:06.438 -------------------------------------------------------------------------------
09:39:06.438 331: MoveNoFilingToWorkRecord migrating
09:39:06.438 -------------------------------------------------------------------------------
09:39:06.439 [+] Beginning Transaction
09:39:06.440 [+] AlterTable work_records
09:39:06.442 [+] CreateColumn work_records no_filing_requirement Boolean
09:39:06.451 [+] ExecuteSqlStatement update work_records set no_filing_requirement = isnull(o.no_filing_requirement, 0) from work_records w left join organizers o on w.id = o.work_record_id
09:39:06.454 [+] DeleteColumn organizers no_filing_requirement
09:39:06.463 [+] Committing Transaction
09:39:06.465 [+] 331: MoveNoFilingToWorkRecord migrated
09:39:06.466 -------------------------------------------------------------------------------
09:39:06.467 332: AddFeatureToggleForEngagementRole migrating
09:39:06.467 -------------------------------------------------------------------------------
09:39:06.467 [+] Beginning Transaction
09:39:06.470 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.471 [+] Committing Transaction
09:39:06.483 [+] 332: AddFeatureToggleForEngagementRole migrated
09:39:06.484 -------------------------------------------------------------------------------
09:39:06.485 334: MigrateCountryInEventBody migrating
09:39:06.485 -------------------------------------------------------------------------------
09:39:06.485 [+] Beginning Transaction
09:39:06.487 [+] ExecuteSqlStatement delete from [events] where entity_type = 2 and entity_id not in (select id from work_records)
09:39:06.494 [+] ExecuteSqlStatement update [events] set [body] = replace([body], 
09:39:06.494   (select '"Jurisdiction":{"$type":"country","Name":"'+c.name+'","Abbreviation":"'+c.Abbreviation+'","Id":'+cast(tos.country_id as varchar)+'}'
09:39:06.495   from work_records wr
09:39:06.495   left join types_of_service tos on wr.primary_service_id = tos.id
09:39:06.495   left join countries c on tos.country_id = c.id
09:39:06.495   where wr.id = entity_id), 
09:39:06.495   
09:39:06.496   (select '"CountryName":"'+c.name+'"'
09:39:06.496   from work_records wr
09:39:06.496   left join types_of_service tos on wr.primary_service_id = tos.id
09:39:06.496   left join countries c on tos.country_id = c.id
09:39:06.497   where wr.id = entity_id))
09:39:06.497   
09:39:06.497   FROM [events]
09:39:06.497   where event_type in (1,52,53,50)
09:39:06.523 [+] Committing Transaction
09:39:06.524 [+] 334: MigrateCountryInEventBody migrated
09:39:06.525 -------------------------------------------------------------------------------
09:39:06.525 336: InitializeEngagementEvents migrating
09:39:06.525 -------------------------------------------------------------------------------
09:39:06.525 [+] Beginning Transaction
09:39:06.526 [+] ExecuteSqlStatement insert into events (occured_at,modifier,event_type,entity_type,body,modifier_type,entity_id) select getutcdate(),0,4,3,'{"$type":"en-created","EntityId":' + cast(id as varchar) +',"EntityType":3,"Snapshot":null,"DomainEventType":4}', 0, id from engagements
09:39:06.529 [+] Committing Transaction
09:39:06.541 [+] 336: InitializeEngagementEvents migrated
09:39:06.542 -------------------------------------------------------------------------------
09:39:06.543 337: AddDayInHouseAndMiDaysInWorkRecordTable migrating
09:39:06.543 -------------------------------------------------------------------------------
09:39:06.543 [+] Beginning Transaction
09:39:06.544 [+] AlterTable work_records
09:39:06.545 [+] CreateColumn work_records days_in_house Int32
09:39:06.549 [+] AlterTable work_records
09:39:06.550 [+] CreateColumn work_records mi_days Int32
09:39:06.555 [+] Committing Transaction
09:39:06.558 [+] 337: AddDayInHouseAndMiDaysInWorkRecordTable migrated
09:39:06.559 -------------------------------------------------------------------------------
09:39:06.559 338: AddIndexOfAccountIdOfAssigneeTable migrating
09:39:06.559 -------------------------------------------------------------------------------
09:39:06.560 [+] Beginning Transaction
09:39:06.561 [+] CreateIndex assignees (account_id)
09:39:06.565 [+] Committing Transaction
09:39:06.588 [+] 338: AddIndexOfAccountIdOfAssigneeTable migrated
09:39:06.589 -------------------------------------------------------------------------------
09:39:06.589 339: AddExpiryDateColumnToWorkRecordTable migrating
09:39:06.589 -------------------------------------------------------------------------------
09:39:06.590 [+] Beginning Transaction
09:39:06.591 [+] CreateColumn work_records expiry_date 
09:39:06.595 [+] Committing Transaction
09:39:06.597 [+] 339: AddExpiryDateColumnToWorkRecordTable migrated
09:39:06.598 -------------------------------------------------------------------------------
09:39:06.599 340: AddEngagementAdminForExistingEngagement migrating
09:39:06.599 -------------------------------------------------------------------------------
09:39:06.599 [+] Beginning Transaction
09:39:06.601 [+] ExecuteSqlStatement 
09:39:06.601 DECLARE @engagement_id BIGINT
09:39:06.601 DECLARE @counter BIGINT
09:39:06.601 DECLARE @staff_id BIGINT
09:39:06.601 DECLARE engagement_cur CURSOR FOR
09:39:06.601 	SELECT id FROM engagements 
09:39:06.602 	
09:39:06.602 OPEN engagement_cur
09:39:06.602 FETCH NEXT FROM engagement_cur INTO @engagement_id
09:39:06.602 
09:39:06.602 WHILE @@fetch_status = 0
09:39:06.602 	BEGIN
09:39:06.602 		SELECT @counter = count(*) FROM engaged_staffs WHERE engagement_id = @engagement_id and [role] = 3
09:39:06.603 		if @counter = 0
09:39:06.603 		BEGIN 
09:39:06.603 			SELECT TOP 1 @staff_id = staff_id FROM engaged_staffs WHERE engagement_id = @engagement_id ORDER BY id
09:39:06.603 
09:39:06.603             if @staff_id is null
09:39:06.603             begin
09:39:06.603                   SELECT @staff_id = s.id
09:39:06.603                   FROM [engaged_offices] eo join [staff] s on eo.office_id = s.office_id
09:39:06.604                   where role = 'CoordinatingOffice' and engagement_id = @engagement_id
09:39:06.604 
09:39:06.604                   INSERT INTO engaged_staffs (staff_id, engagement_id, [role])
09:39:06.604 				  SELECT @staff_id, @engagement_id, 0
09:39:06.604             end
09:39:06.604 			SELECT @counter = count(*) FROM [engaged_offices] eo JOIN staff s ON eo.[office_id] = s.[office_id] 
09:39:06.604 			WHERE eo.[engagement_id] = @engagement_id and s.id = @staff_id
09:39:06.605 			
09:39:06.605 			IF @counter = 0
09:39:06.605 			BEGIN
09:39:06.605 				INSERT INTO engaged_offices (office_id, engagement_id, [role])
09:39:06.605 				SELECT office_id, @engagement_id, 'WorkOffice' FROM staff WHERE id = @staff_id
09:39:06.605 				
09:39:06.605 				INSERT INTO engaged_office_staff (engaged_office_id, staff_id, [role]) 
09:39:06.606 				SELECT @@identity, @staff_id, 0 FROM staff WHERE id = @staff_id
09:39:06.606 			END	
09:39:06.606 			INSERT INTO engaged_staffs(staff_id, engagement_id, [role])
09:39:06.606 			SELECT @staff_id, @engagement_id, 3
09:39:06.606 		END
09:39:06.606 		
09:39:06.606 		SET @engagement_id = NULL
09:39:06.607 		SET @counter = NULL
09:39:06.607 		SET @staff_id = NULL
09:39:06.607 		
09:39:06.607 		FETCH NEXT FROM engagement_cur INTO @engagement_id
09:39:06.607 	END
09:39:06.607 
09:39:06.607 CLOSE engagement_cur
09:39:06.607 DEALLOCATE engagement_cur
09:39:06.608 
09:39:06.615 [+] Committing Transaction
09:39:06.616 [+] 340: AddEngagementAdminForExistingEngagement migrated
09:39:06.616 -------------------------------------------------------------------------------
09:39:06.616 341: AddEfileStatusTable migrating
09:39:06.617 -------------------------------------------------------------------------------
09:39:06.617 [+] Beginning Transaction
09:39:06.619 [+] CreateTable efile_status
09:39:06.623 [+] CreateConstraint PK_efile_status
09:39:06.627 [+] Committing Transaction
09:39:06.628 [+] 341: AddEfileStatusTable migrated
09:39:06.629 -------------------------------------------------------------------------------
09:39:06.630 342: AddFeatureToggleForTeamWorkSpaceLink migrating
09:39:06.630 -------------------------------------------------------------------------------
09:39:06.630 [+] Beginning Transaction
09:39:06.632 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.634 [+] Committing Transaction
09:39:06.646 [+] 342: AddFeatureToggleForTeamWorkSpaceLink migrated
09:39:06.648 -------------------------------------------------------------------------------
09:39:06.648 343: RemoveMyDataCriteria migrating
09:39:06.648 -------------------------------------------------------------------------------
09:39:06.649 [+] Beginning Transaction
09:39:06.651 [+] DeleteTable mydata_criteria
09:39:06.655 [+] Committing Transaction
09:39:06.657 [+] 343: RemoveMyDataCriteria migrated
09:39:06.659 -------------------------------------------------------------------------------
09:39:06.659 344: AddPrivateColumnInClientsTable migrating
09:39:06.659 -------------------------------------------------------------------------------
09:39:06.660 [+] Beginning Transaction
09:39:06.662 [+] AlterTable clients
09:39:06.663 [+] CreateColumn clients is_private Boolean
09:39:06.668 [+] Committing Transaction
09:39:06.681 [+] 344: AddPrivateColumnInClientsTable migrated
09:39:06.683 -------------------------------------------------------------------------------
09:39:06.683 349: AddCustomFieldIdIndexForWorkRecordsCustomFieldsValue migrating
09:39:06.683 -------------------------------------------------------------------------------
09:39:06.684 [+] Beginning Transaction
09:39:06.686 [+] CreateIndex work_record_custom_fields_value (custom_field_id)
09:39:06.690 [+] Committing Transaction
09:39:06.692 [+] 349: AddCustomFieldIdIndexForWorkRecordsCustomFieldsValue migrated
09:39:06.694 -------------------------------------------------------------------------------
09:39:06.694 351: AddRestrictedOnAssigneeTable migrating
09:39:06.694 -------------------------------------------------------------------------------
09:39:06.695 [+] Beginning Transaction
09:39:06.697 [+] AlterTable assignees
09:39:06.698 [+] CreateColumn assignees restricted Boolean
09:39:06.706 [+] Committing Transaction
09:39:06.711 [+] 351: AddRestrictedOnAssigneeTable migrated
09:39:06.713 -------------------------------------------------------------------------------
09:39:06.713 352: AddFeatureToggleForRestrictedAssignee migrating
09:39:06.713 -------------------------------------------------------------------------------
09:39:06.713 [+] Beginning Transaction
09:39:06.716 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:06.717 [+] Committing Transaction
09:39:06.720 [+] 352: AddFeatureToggleForRestrictedAssignee migrated
09:39:06.721 -------------------------------------------------------------------------------
09:39:06.721 353: AddAssigneeAccessControlListTable migrating
09:39:06.721 -------------------------------------------------------------------------------
09:39:06.722 [+] Beginning Transaction
09:39:06.724 [+] CreateTable assignee_access_controls
09:39:06.729 [+] Committing Transaction
09:39:06.731 [+] 353: AddAssigneeAccessControlListTable migrated
09:39:06.732 -------------------------------------------------------------------------------
09:39:06.733 354: AddFeatureToggleForSearchFilterByGOMigrInactive migrating
09:39:06.733 -------------------------------------------------------------------------------
09:39:06.733 [+] Beginning Transaction
09:39:06.736 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.737 [+] Committing Transaction
09:39:06.751 [+] 354: AddFeatureToggleForSearchFilterByGOMigrInactive migrated
09:39:06.751 -------------------------------------------------------------------------------
09:39:06.752 355: AddIdColumnAndChangePrimaryKeyOnAssigneeReportTable migrating
09:39:06.752 -------------------------------------------------------------------------------
09:39:06.752 [+] Beginning Transaction
09:39:06.754 [+] DeleteConstraint PK_assignee_reports
09:39:06.760 [+] AlterTable assignee_reports
09:39:06.761 [+] CreateColumn assignee_reports id Int64
09:39:06.764 [+] CreateConstraint PK_assignee_reports
09:39:06.771 [+] ExecuteSqlStatement 
09:39:06.771                 insert into assignee_reports
09:39:06.771                 select assignee_reports.assignee_id,
09:39:06.772 	                assignees_engagements.engagement_id,
09:39:06.773 	                assignee_reports.account_status,
09:39:06.773 	                assignee_reports.subscription
09:39:06.773                 from assignees_engagements
09:39:06.773                 inner join assignee_reports on assignees_engagements.assignee_id = assignee_reports.assignee_id and assignees_engagements.engagement_id != assignee_reports.engagement_Id
09:39:06.773                 where assignees_engagements.assignee_id in (
09:39:06.773 	                SELECT assignee_id
09:39:06.773 	                FROM assignees_engagements
09:39:06.774 	                group by assignee_id having count(*) > 1
09:39:06.774                 )
09:39:06.791 [+] Committing Transaction
09:39:06.792 [+] 355: AddIdColumnAndChangePrimaryKeyOnAssigneeReportTable migrated
09:39:06.793 -------------------------------------------------------------------------------
09:39:06.793 356: AddStartDateColumnToWorkRecordTaskTable migrating
09:39:06.793 -------------------------------------------------------------------------------
09:39:06.794 [+] Beginning Transaction
09:39:06.795 [+] AlterTable work_record_tasks
09:39:06.796 [+] CreateColumn work_record_tasks start_date 
09:39:06.800 [+] Committing Transaction
09:39:06.813 [+] 356: AddStartDateColumnToWorkRecordTaskTable migrated
09:39:06.815 -------------------------------------------------------------------------------
09:39:06.815 357: AddFeatureToggleForBatchAssign migrating
09:39:06.815 -------------------------------------------------------------------------------
09:39:06.815 [+] Beginning Transaction
09:39:06.817 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.819 [+] Committing Transaction
09:39:06.831 [+] 357: AddFeatureToggleForBatchAssign migrated
09:39:06.832 -------------------------------------------------------------------------------
09:39:06.832 358: ChangeDaysInHouseAndMiDaysNotNullable migrating
09:39:06.832 -------------------------------------------------------------------------------
09:39:06.836 [+] Beginning Transaction
09:39:06.841 [+] ExecuteSqlStatement UPDATE work_records SET days_in_house = 0 WHERE days_in_house is null
09:39:06.847 [+] ExecuteSqlStatement UPDATE work_records SET mi_days = 0 WHERE mi_days is null
09:39:06.863 [+] AlterTable work_records
09:39:06.864 [+] AlterColumn work_records days_in_house Int32
09:39:06.870 [+] AlterDefaultConstraint .work_records days_in_house 0
09:39:06.890 [+] AlterTable work_records
09:39:06.891 [+] AlterColumn work_records mi_days Int32
09:39:06.897 [+] AlterDefaultConstraint .work_records mi_days 0
09:39:06.915 [+] Committing Transaction
09:39:06.917 [+] 358: ChangeDaysInHouseAndMiDaysNotNullable migrated
09:39:06.917 -------------------------------------------------------------------------------
09:39:06.917 359: AddFeatureToggleForMissingItem migrating
09:39:06.917 -------------------------------------------------------------------------------
09:39:06.918 [+] Beginning Transaction
09:39:06.920 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.922 [+] Committing Transaction
09:39:06.936 [+] 359: AddFeatureToggleForMissingItem migrated
09:39:06.937 -------------------------------------------------------------------------------
09:39:06.937 360: AddCreatedAtForConfirmedUnsignedConsentTable migrating
09:39:06.938 -------------------------------------------------------------------------------
09:39:06.938 [+] Beginning Transaction
09:39:06.940 [+] AlterTable confirmed_unsigned_consent
09:39:06.942 [+] CreateColumn confirmed_unsigned_consent created_at 
09:39:06.946 [+] ExecuteSqlStatement update [confirmed_unsigned_consent] set created_at = date where created_at is null
09:39:06.951 [+] Committing Transaction
09:39:06.953 [+] 360: AddCreatedAtForConfirmedUnsignedConsentTable migrated
09:39:06.955 -------------------------------------------------------------------------------
09:39:06.955 361: RemoveFeatureToggleForSearchFilterByGOMigrInactive migrating
09:39:06.955 -------------------------------------------------------------------------------
09:39:06.956 [+] Beginning Transaction
09:39:06.958 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:06.959 [+] Committing Transaction
09:39:06.972 [+] 361: RemoveFeatureToggleForSearchFilterByGOMigrInactive migrated
09:39:06.974 -------------------------------------------------------------------------------
09:39:06.974 362: AddFeatureToggleForTeamMailbox migrating
09:39:06.974 -------------------------------------------------------------------------------
09:39:06.975 [+] Beginning Transaction
09:39:06.978 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:06.979 [+] Committing Transaction
09:39:06.993 [+] 362: AddFeatureToggleForTeamMailbox migrated
09:39:06.994 -------------------------------------------------------------------------------
09:39:06.994 363: AddActionColumnToHistoryItem migrating
09:39:06.994 -------------------------------------------------------------------------------
09:39:06.995 [+] Beginning Transaction
09:39:06.997 [+] CreateColumn history_item action Int32
09:39:07.001 [+] Committing Transaction
09:39:07.002 [+] 363: AddActionColumnToHistoryItem migrated
09:39:07.004 -------------------------------------------------------------------------------
09:39:07.004 364: RemoveFeatureToggleBatchAssign migrating
09:39:07.004 -------------------------------------------------------------------------------
09:39:07.005 [+] Beginning Transaction
09:39:07.007 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:07.009 [+] Committing Transaction
09:39:07.023 [+] 364: RemoveFeatureToggleBatchAssign migrated
09:39:07.024 -------------------------------------------------------------------------------
09:39:07.024 365: RemoveFeatureToggleEfileReport migrating
09:39:07.025 -------------------------------------------------------------------------------
09:39:07.025 [+] Beginning Transaction
09:39:07.027 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:07.036 [+] Committing Transaction
09:39:07.038 [+] 365: RemoveFeatureToggleEfileReport migrated
09:39:07.040 -------------------------------------------------------------------------------
09:39:07.040 366: RemoveFeatureToggleGetMyDataPhaseI migrating
09:39:07.040 -------------------------------------------------------------------------------
09:39:07.041 [+] Beginning Transaction
09:39:07.042 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:07.045 [+] Committing Transaction
09:39:07.057 [+] 366: RemoveFeatureToggleGetMyDataPhaseI migrated
09:39:07.059 -------------------------------------------------------------------------------
09:39:07.059 367: AddCountryDMSLinkCatetoriesTable migrating
09:39:07.059 -------------------------------------------------------------------------------
09:39:07.060 [+] Beginning Transaction
09:39:07.062 [+] CreateTable country_dms_link_categories
09:39:07.066 [+] CreateForeignKey fk_country_dms_link_categories_ref_countries country_dms_link_categories(country_id) countries(id)
09:39:07.070 [+] Committing Transaction
09:39:07.072 [+] 367: AddCountryDMSLinkCatetoriesTable migrated
09:39:07.074 -------------------------------------------------------------------------------
09:39:07.074 368: AddWorkRecordCountryDMSLinkValuesTable migrating
09:39:07.074 -------------------------------------------------------------------------------
09:39:07.074 [+] Beginning Transaction
09:39:07.076 [+] CreateTable work_record_country_dms_links
09:39:07.081 [+] CreateForeignKey fk_work_record_country_dms_links_ref_country_dms_link_categories work_record_country_dms_links(category_id) country_dms_link_categories(id)
09:39:07.083 [+] CreateForeignKey fk_work_record_country_dms_links_ref_work_records work_record_country_dms_links(work_record_id) work_records(id)
09:39:07.087 [+] Committing Transaction
09:39:07.102 [+] 368: AddWorkRecordCountryDMSLinkValuesTable migrated
09:39:07.104 -------------------------------------------------------------------------------
09:39:07.104 369: AddFeatureToggleForDmsLink migrating
09:39:07.105 -------------------------------------------------------------------------------
09:39:07.105 [+] Beginning Transaction
09:39:07.108 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:07.111 [+] Committing Transaction
09:39:07.113 [+] 369: AddFeatureToggleForDmsLink migrated
09:39:07.114 -------------------------------------------------------------------------------
09:39:07.114 370: RemoveFeatureToggleForAssigneeEngagements migrating
09:39:07.115 -------------------------------------------------------------------------------
09:39:07.115 [+] Beginning Transaction
09:39:07.117 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:07.119 [+] Committing Transaction
09:39:07.132 [+] 370: RemoveFeatureToggleForAssigneeEngagements migrated
09:39:07.133 -------------------------------------------------------------------------------
09:39:07.133 371: RenameDmsLinkCategoryToDmsLinkListField migrating
09:39:07.134 -------------------------------------------------------------------------------
09:39:07.134 [+] Beginning Transaction
09:39:07.136 [+] RenameTable country_dms_link_categories country_dms_link_list_fields
09:39:07.140 [+] Committing Transaction
09:39:07.142 [+] 371: RenameDmsLinkCategoryToDmsLinkListField migrated
09:39:07.143 -------------------------------------------------------------------------------
09:39:07.144 372: RenameColumnCategoryNameToFieldNameInDmsLinkListField migrating
09:39:07.144 -------------------------------------------------------------------------------
09:39:07.144 [+] Beginning Transaction
09:39:07.146 [+] RenameColumn country_dms_link_list_fields category_name to field_name
09:39:07.150 [+] Committing Transaction
09:39:07.166 [+] 372: RenameColumnCategoryNameToFieldNameInDmsLinkListField migrated
09:39:07.167 -------------------------------------------------------------------------------
09:39:07.167 373: AddLocationToCountryDmsLinkListField migrating
09:39:07.167 -------------------------------------------------------------------------------
09:39:07.168 [+] Beginning Transaction
09:39:07.170 [+] AlterTable country_dms_link_list_fields
09:39:07.171 [+] CreateColumn country_dms_link_list_fields location Int16
09:39:07.183 [+] Committing Transaction
09:39:07.183 [+] 373: AddLocationToCountryDmsLinkListField migrated
09:39:07.183 -------------------------------------------------------------------------------
09:39:07.184 374: AddPracticeTypeToCountryDmsLinkListField migrating
09:39:07.185 -------------------------------------------------------------------------------
09:39:07.185 [+] Beginning Transaction
09:39:07.185 [+] AlterTable country_dms_link_list_fields
09:39:07.185 [+] CreateColumn country_dms_link_list_fields practice_type Int16
09:39:07.190 [+] Committing Transaction
09:39:07.192 [+] 374: AddPracticeTypeToCountryDmsLinkListField migrated
09:39:07.194 -------------------------------------------------------------------------------
09:39:07.194 375: AddFeatureToggleForMyMobility migrating
09:39:07.194 -------------------------------------------------------------------------------
09:39:07.194 [+] Beginning Transaction
09:39:07.197 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:07.198 [+] Committing Transaction
09:39:07.210 [+] 375: AddFeatureToggleForMyMobility migrated
09:39:07.212 -------------------------------------------------------------------------------
09:39:07.213 376: RemoveHasQuestionnaireFromWorkRecord migrating
09:39:07.213 -------------------------------------------------------------------------------
09:39:07.213 [+] Beginning Transaction
09:39:07.215 [+] DeleteColumn work_records has_questionnaire
09:39:07.228 [+] Committing Transaction
09:39:07.229 [+] 376: RemoveHasQuestionnaireFromWorkRecord migrated
09:39:07.231 -------------------------------------------------------------------------------
09:39:07.231 377: RemoveResponsibilityFromWorkRecordTask migrating
09:39:07.231 -------------------------------------------------------------------------------
09:39:07.231 [+] Beginning Transaction
09:39:07.233 [+] DeleteForeignKey fk_work_record_tasks_ref_offices work_record_tasks ()  ()
09:39:07.236 [+] DeleteForeignKey fk_work_record_tasks_ref_staff work_record_tasks ()  ()
09:39:07.239 [+] DeleteColumn work_record_tasks responsible_office_id, responsibility_id
09:39:07.260 [+] Committing Transaction
09:39:07.263 [+] 377: RemoveResponsibilityFromWorkRecordTask migrated
09:39:07.264 -------------------------------------------------------------------------------
09:39:07.264 378: RemoveFeatureToggleForUac2 migrating
09:39:07.265 -------------------------------------------------------------------------------
09:39:07.265 [+] Beginning Transaction
09:39:07.267 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:07.269 [+] Committing Transaction
09:39:07.281 [+] 378: RemoveFeatureToggleForUac2 migrated
09:39:07.283 -------------------------------------------------------------------------------
09:39:07.283 379: AllowOrganizerContactIdColumnNullable migrating
09:39:07.283 -------------------------------------------------------------------------------
09:39:07.284 [+] Beginning Transaction
09:39:07.286 [+] AlterColumn organizers contact_id Int64
09:39:07.291 [+] Committing Transaction
09:39:07.294 [+] 379: AllowOrganizerContactIdColumnNullable migrated
09:39:07.294 -------------------------------------------------------------------------------
09:39:07.294 380: AddFeatureToggleForEmailHistory migrating
09:39:07.294 -------------------------------------------------------------------------------
09:39:07.295 [+] Beginning Transaction
09:39:07.297 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:07.299 [+] Committing Transaction
09:39:07.311 [+] 380: AddFeatureToggleForEmailHistory migrated
09:39:07.313 -------------------------------------------------------------------------------
09:39:07.313 381: AddEmailHistoryTable migrating
09:39:07.313 -------------------------------------------------------------------------------
09:39:07.314 [+] Beginning Transaction
09:39:07.316 [+] CreateTable email_history
09:39:07.320 [+] Committing Transaction
09:39:07.322 [+] 381: AddEmailHistoryTable migrated
09:39:07.324 -------------------------------------------------------------------------------
09:39:07.324 382: AddTaxReturnFilesTable migrating
09:39:07.324 -------------------------------------------------------------------------------
09:39:07.324 [+] Beginning Transaction
09:39:07.326 [+] CreateTable tax_return_files
09:39:07.330 [+] CreateIndex tax_return_files (work_record_id)
09:39:07.333 [+] Committing Transaction
09:39:07.334 [+] 382: AddTaxReturnFilesTable migrated
09:39:07.335 -------------------------------------------------------------------------------
09:39:07.336 383: AddColumnAbbreviationOnTimezonesTable migrating
09:39:07.336 -------------------------------------------------------------------------------
09:39:07.336 [+] Beginning Transaction
09:39:07.341 [+] AlterTable timezones
09:39:07.343 [+] CreateColumn timezones abbreviation AnsiString
09:39:07.347 [+] ExecuteSqlStatement update [timezones] set abbreviation='IDL' where id=1
09:39:07.351 [+] ExecuteSqlStatement update [timezones] set abbreviation='SST' where id=2
09:39:07.353 [+] ExecuteSqlStatement update [timezones] set abbreviation='HST' where id=3
09:39:07.354 [+] ExecuteSqlStatement update [timezones] set abbreviation='AKST' where id=4
09:39:07.360 [+] ExecuteSqlStatement update [timezones] set abbreviation='PST' where id=5
09:39:07.363 [+] ExecuteSqlStatement update [timezones] set abbreviation='MST' where id=6
09:39:07.365 [+] ExecuteSqlStatement update [timezones] set abbreviation='MST' where id=7
09:39:07.367 [+] ExecuteSqlStatement update [timezones] set abbreviation='MST' where id=8
09:39:07.369 [+] ExecuteSqlStatement update [timezones] set abbreviation='CST' where id=9
09:39:07.371 [+] ExecuteSqlStatement update [timezones] set abbreviation='CST' where id=10
09:39:07.373 [+] ExecuteSqlStatement update [timezones] set abbreviation='CST' where id=11
09:39:07.374 [+] ExecuteSqlStatement update [timezones] set abbreviation='CST' where id=12
09:39:07.376 [+] ExecuteSqlStatement update [timezones] set abbreviation='EST' where id=13
09:39:07.378 [+] ExecuteSqlStatement update [timezones] set abbreviation='EST' where id=14
09:39:07.379 [+] ExecuteSqlStatement update [timezones] set abbreviation='COT' where id=15
09:39:07.381 [+] ExecuteSqlStatement update [timezones] set abbreviation='AST' where id=16
09:39:07.383 [+] ExecuteSqlStatement update [timezones] set abbreviation='VET' where id=17
09:39:07.385 [+] ExecuteSqlStatement update [timezones] set abbreviation='CLT' where id=18
09:39:07.386 [+] ExecuteSqlStatement update [timezones] set abbreviation='NST' where id=19
09:39:07.388 [+] ExecuteSqlStatement update [timezones] set abbreviation='BRT' where id=20
09:39:07.390 [+] ExecuteSqlStatement update [timezones] set abbreviation='ART' where id=21
09:39:07.392 [+] ExecuteSqlStatement update [timezones] set abbreviation='WGT' where id=22
09:39:07.394 [+] ExecuteSqlStatement update [timezones] set abbreviation='MAT' where id=23
09:39:07.396 [+] ExecuteSqlStatement update [timezones] set abbreviation='AZOST' where id=24
09:39:07.398 [+] ExecuteSqlStatement update [timezones] set abbreviation='CVT' where id=25
09:39:07.400 [+] ExecuteSqlStatement update [timezones] set abbreviation='GMT' where id=26
09:39:07.402 [+] ExecuteSqlStatement update [timezones] set abbreviation='WET' where id=27
09:39:07.404 [+] ExecuteSqlStatement update [timezones] set abbreviation='CET' where id=28
09:39:07.405 [+] ExecuteSqlStatement update [timezones] set abbreviation='CET' where id=29
09:39:07.407 [+] ExecuteSqlStatement update [timezones] set abbreviation='CET' where id=30
09:39:07.408 [+] ExecuteSqlStatement update [timezones] set abbreviation='CET' where id=31
09:39:07.410 [+] ExecuteSqlStatement update [timezones] set abbreviation='WAT' where id=32
09:39:07.412 [+] ExecuteSqlStatement update [timezones] set abbreviation='EET' where id=33
09:39:07.414 [+] ExecuteSqlStatement update [timezones] set abbreviation='EET' where id=34
09:39:07.416 [+] ExecuteSqlStatement update [timezones] set abbreviation='EET' where id=35
09:39:07.417 [+] ExecuteSqlStatement update [timezones] set abbreviation='EET' where id=36
09:39:07.419 [+] ExecuteSqlStatement update [timezones] set abbreviation='IST' where id=37
09:39:07.420 [+] ExecuteSqlStatement update [timezones] set abbreviation='SAST' where id=38
09:39:07.427 [+] ExecuteSqlStatement update [timezones] set abbreviation='MSK' where id=39
09:39:07.430 [+] ExecuteSqlStatement update [timezones] set abbreviation='AST' where id=40
09:39:07.432 [+] ExecuteSqlStatement update [timezones] set abbreviation='EAT' where id=41
09:39:07.434 [+] ExecuteSqlStatement update [timezones] set abbreviation='AST' where id=42
09:39:07.436 [+] ExecuteSqlStatement update [timezones] set abbreviation='IRST' where id=43
09:39:07.437 [+] ExecuteSqlStatement update [timezones] set abbreviation='GST' where id=44
09:39:07.439 [+] ExecuteSqlStatement update [timezones] set abbreviation='GET' where id=45
09:39:07.441 [+] ExecuteSqlStatement update [timezones] set abbreviation='AFT' where id=46
09:39:07.443 [+] ExecuteSqlStatement update [timezones] set abbreviation='YEKT' where id=47
09:39:07.445 [+] ExecuteSqlStatement update [timezones] set abbreviation='PKT' where id=48
09:39:07.446 [+] ExecuteSqlStatement update [timezones] set abbreviation='IST' where id=49
09:39:07.448 [+] ExecuteSqlStatement update [timezones] set abbreviation='NPT' where id=50
09:39:07.450 [+] ExecuteSqlStatement update [timezones] set abbreviation='BST' where id=51
09:39:07.452 [+] ExecuteSqlStatement update [timezones] set abbreviation='SLST' where id=52
09:39:07.454 [+] ExecuteSqlStatement update [timezones] set abbreviation='NOVT' where id=53
09:39:07.455 [+] ExecuteSqlStatement update [timezones] set abbreviation='MMT' where id=54
09:39:07.457 [+] ExecuteSqlStatement update [timezones] set abbreviation='ICT' where id=55
09:39:07.458 [+] ExecuteSqlStatement update [timezones] set abbreviation='KRAT' where id=56
09:39:07.461 [+] ExecuteSqlStatement update [timezones] set abbreviation='CST' where id=57
09:39:07.462 [+] ExecuteSqlStatement update [timezones] set abbreviation='SGT' where id=58
09:39:07.464 [+] ExecuteSqlStatement update [timezones] set abbreviation='CST' where id=59
09:39:07.466 [+] ExecuteSqlStatement update [timezones] set abbreviation='AWST' where id=60
09:39:07.468 [+] ExecuteSqlStatement update [timezones] set abbreviation='ULAT' where id=61
09:39:07.470 [+] ExecuteSqlStatement update [timezones] set abbreviation='KST' where id=62
09:39:07.472 [+] ExecuteSqlStatement update [timezones] set abbreviation='JST' where id=63
09:39:07.474 [+] ExecuteSqlStatement update [timezones] set abbreviation='YAKT' where id=64
09:39:07.476 [+] ExecuteSqlStatement update [timezones] set abbreviation='ACST' where id=65
09:39:07.477 [+] ExecuteSqlStatement update [timezones] set abbreviation='ACST' where id=66
09:39:07.479 [+] ExecuteSqlStatement update [timezones] set abbreviation='AEST' where id=67
09:39:07.481 [+] ExecuteSqlStatement update [timezones] set abbreviation='AEST' where id=68
09:39:07.483 [+] ExecuteSqlStatement update [timezones] set abbreviation='AEST' where id=69
09:39:07.485 [+] ExecuteSqlStatement update [timezones] set abbreviation='VLAT' where id=70
09:39:07.490 [+] ExecuteSqlStatement update [timezones] set abbreviation='ChST' where id=71
09:39:07.495 [+] ExecuteSqlStatement update [timezones] set abbreviation='NCT' where id=72
09:39:07.497 [+] ExecuteSqlStatement update [timezones] set abbreviation='FJT' where id=73
09:39:07.498 [+] ExecuteSqlStatement update [timezones] set abbreviation='NZST' where id=74
09:39:07.499 [+] ExecuteSqlStatement update [timezones] set abbreviation='TOT' where id=75
09:39:07.502 [+] Committing Transaction
09:39:07.504 [+] 383: AddColumnAbbreviationOnTimezonesTable migrated
09:39:07.506 -------------------------------------------------------------------------------
09:39:07.506 384: AddFeatureToggleForVIP migrating
09:39:07.506 -------------------------------------------------------------------------------
09:39:07.507 [+] Beginning Transaction
09:39:07.509 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:07.510 [+] Committing Transaction
09:39:07.512 [+] 384: AddFeatureToggleForVIP migrated
09:39:07.514 -------------------------------------------------------------------------------
09:39:07.514 385: AddIsVIPOnAssigneeTable migrating
09:39:07.514 -------------------------------------------------------------------------------
09:39:07.515 [+] Beginning Transaction
09:39:07.516 [+] AlterTable assignees
09:39:07.518 [+] CreateColumn assignees is_vip Boolean
09:39:07.521 [+] Committing Transaction
09:39:07.522 [+] 385: AddIsVIPOnAssigneeTable migrated
09:39:07.523 -------------------------------------------------------------------------------
09:39:07.523 386: AddDataMigrationInfoTable migrating
09:39:07.523 -------------------------------------------------------------------------------
09:39:07.523 [+] Beginning Transaction
09:39:07.524 [+] CreateTable DataMigrationInfo
09:39:07.526 [+] Committing Transaction
09:39:07.527 [+] 386: AddDataMigrationInfoTable migrated
09:39:07.528 -------------------------------------------------------------------------------
09:39:07.528 387: RemoveFeatureToggleTeamMailbox migrating
09:39:07.528 -------------------------------------------------------------------------------
09:39:07.528 [+] Beginning Transaction
09:39:07.529 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:07.530 [+] Committing Transaction
09:39:07.530 [+] 387: RemoveFeatureToggleTeamMailbox migrated
09:39:07.531 -------------------------------------------------------------------------------
09:39:07.531 388: AddFeatureToggleForInactiveStaff migrating
09:39:07.531 -------------------------------------------------------------------------------
09:39:07.531 [+] Beginning Transaction
09:39:07.532 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:07.533 [+] Committing Transaction
09:39:07.533 [+] 388: AddFeatureToggleForInactiveStaff migrated
09:39:07.534 -------------------------------------------------------------------------------
09:39:07.534 389: ResetAssigneeRestrictedEvents migrating
09:39:07.534 -------------------------------------------------------------------------------
09:39:07.534 [+] Beginning Transaction
09:39:07.535 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:07.537 [+] Committing Transaction
09:39:07.538 [+] 389: ResetAssigneeRestrictedEvents migrated
09:39:07.538 -------------------------------------------------------------------------------
09:39:07.538 390: MovePrimaryContactFromEngagedStaffToEngagement migrating
09:39:07.538 -------------------------------------------------------------------------------
09:39:07.538 [+] Beginning Transaction
09:39:07.539 [+] AlterTable engagements
09:39:07.539 [+] CreateColumn engagements staff_id Int64
09:39:07.540 [+] ExecuteSqlStatement update engagements set engagements.staff_id = engaged_staffs.staff_id 
09:39:07.540                           from engagements left join engaged_staffs 
09:39:07.540                           on engagements.id = engaged_staffs.engagement_id and engaged_staffs.role = 0;
09:39:07.540                           delete from engaged_staffs where role = 0
09:39:07.548 [+] Committing Transaction
09:39:07.550 [+] 390: MovePrimaryContactFromEngagedStaffToEngagement migrated
09:39:07.550 -------------------------------------------------------------------------------
09:39:07.550 391: RemoveContactFromEngagedAccessControls migrating
09:39:07.551 -------------------------------------------------------------------------------
09:39:07.554 [+] Beginning Transaction
09:39:07.559 [+] ExecuteSqlStatement DELETE FROM engaged_access_controls 
09:39:07.559   WHERE id in 
09:39:07.560   (SELECT eac.id FROM engaged_office_staff  eof
09:39:07.560   INNER JOIN engaged_offices eo ON eo.id = eof.engaged_office_id
09:39:07.560   INNER JOIN engaged_access_controls eac ON eac.engagement_id = eo.engagement_id AND eac.staff_id = eof.staff_id)
09:39:07.599 [+] ExecuteSqlStatement DELETE FROM engaged_access_controls
09:39:07.599   WHERE id in 
09:39:07.599   (select eac.id from engaged_access_controls eac 
09:39:07.599   INNER JOIN engagements e on e.staff_id =  eac.staff_id and e.id = eac.engagement_id)
09:39:07.622 [+] Committing Transaction
09:39:07.625 [+] 391: RemoveContactFromEngagedAccessControls migrated
09:39:07.627 -------------------------------------------------------------------------------
09:39:07.627 392: AddColumnSendedByToTableMissingItemsMails migrating
09:39:07.627 -------------------------------------------------------------------------------
09:39:07.627 [+] Beginning Transaction
09:39:07.629 [+] AlterTable missing_items_mails
09:39:07.631 [+] CreateColumn missing_items_mails sended_by AnsiString
09:39:07.635 [+] Committing Transaction
09:39:07.637 [+] 392: AddColumnSendedByToTableMissingItemsMails migrated
09:39:07.639 -------------------------------------------------------------------------------
09:39:07.639 393: AddTeamsTable migrating
09:39:07.639 -------------------------------------------------------------------------------
09:39:07.639 [+] Beginning Transaction
09:39:07.641 [+] CreateTable teams
09:39:07.645 [+] Committing Transaction
09:39:07.658 [+] 393: AddTeamsTable migrated
09:39:07.660 -------------------------------------------------------------------------------
09:39:07.660 394: AddFeatureToggleForTeam migrating
09:39:07.660 -------------------------------------------------------------------------------
09:39:07.661 [+] Beginning Transaction
09:39:07.663 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:07.664 [+] Committing Transaction
09:39:07.676 [+] 394: AddFeatureToggleForTeam migrated
09:39:07.677 -------------------------------------------------------------------------------
09:39:07.677 395: AddIsMandatoryOnTaskTemplatesTable migrating
09:39:07.678 -------------------------------------------------------------------------------
09:39:07.678 [+] Beginning Transaction
09:39:07.680 [+] AlterTable task_templates
09:39:07.681 [+] CreateColumn task_templates is_mandatory Boolean
09:39:07.693 [+] Committing Transaction
09:39:07.695 [+] 395: AddIsMandatoryOnTaskTemplatesTable migrated
09:39:07.696 -------------------------------------------------------------------------------
09:39:07.697 396: AddTaskTemplateServicesTable migrating
09:39:07.697 -------------------------------------------------------------------------------
09:39:07.697 [+] Beginning Transaction
09:39:07.699 [+] CreateTable task_template_services
09:39:07.703 [+] Committing Transaction
09:39:07.715 [+] 396: AddTaskTemplateServicesTable migrated
09:39:07.717 -------------------------------------------------------------------------------
09:39:07.717 397: ChangeColumnSendedByDefaultValue migrating
09:39:07.718 -------------------------------------------------------------------------------
09:39:07.718 [+] Beginning Transaction
09:39:07.719 [+] ExecuteSqlStatement UPDATE [missing_items_mails] SET [sended_by] = '' WHERE [sended_by] = 'PwC'
09:39:07.737 [+] Committing Transaction
09:39:07.754 [+] 397: ChangeColumnSendedByDefaultValue migrated
09:39:07.755 -------------------------------------------------------------------------------
09:39:07.756 398: AddColumnResponseEntityInBatchItem migrating
09:39:07.756 -------------------------------------------------------------------------------
09:39:07.756 [+] Beginning Transaction
09:39:07.758 [+] AlterTable batch_items
09:39:07.759 [+] CreateColumn batch_items response_entity String
09:39:07.764 [+] Committing Transaction
09:39:07.767 [+] 398: AddColumnResponseEntityInBatchItem migrated
09:39:07.768 -------------------------------------------------------------------------------
09:39:07.768 399: AddColumnTeamIdToTableWorkRecordTaskAssignments migrating
09:39:07.768 -------------------------------------------------------------------------------
09:39:07.768 [+] Beginning Transaction
09:39:07.770 [+] AlterTable work_record_task_assignments
09:39:07.772 [+] CreateColumn work_record_task_assignments team_id Int64
09:39:07.776 [+] Committing Transaction
09:39:07.778 [+] 399: AddColumnTeamIdToTableWorkRecordTaskAssignments migrated
09:39:07.779 -------------------------------------------------------------------------------
09:39:07.779 400: AddColumnTeamIdToTableWorkRecordChecklistItems migrating
09:39:07.779 -------------------------------------------------------------------------------
09:39:07.780 [+] Beginning Transaction
09:39:07.781 [+] AlterTable work_record_checklist_items
09:39:07.783 [+] CreateColumn work_record_checklist_items team_id Int64
09:39:07.787 [+] Committing Transaction
09:39:07.788 [+] 400: AddColumnTeamIdToTableWorkRecordChecklistItems migrated
09:39:07.789 -------------------------------------------------------------------------------
09:39:07.789 401: AddFeatureToggleForFileSharing migrating
09:39:07.790 -------------------------------------------------------------------------------
09:39:07.790 [+] Beginning Transaction
09:39:07.792 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:07.793 [+] Committing Transaction
09:39:07.806 [+] 401: AddFeatureToggleForFileSharing migrated
09:39:07.809 -------------------------------------------------------------------------------
09:39:07.809 402: ChangeTeamHistoryItemToTag migrating
09:39:07.809 -------------------------------------------------------------------------------
09:39:07.810 [+] Beginning Transaction
09:39:07.811 [+] ExecuteSqlStatement update [dbo].[history_item] set what='Tag' where what='Team'
09:39:07.823 [+] Committing Transaction
09:39:07.825 [+] 402: ChangeTeamHistoryItemToTag migrated
09:39:07.827 -------------------------------------------------------------------------------
09:39:07.827 403: ChangeTableTeamsToTags migrating
09:39:07.827 -------------------------------------------------------------------------------
09:39:07.828 [+] Beginning Transaction
09:39:07.830 [+] RenameTable teams tags
09:39:07.834 [+] Committing Transaction
09:39:07.836 [+] 403: ChangeTableTeamsToTags migrated
09:39:07.837 -------------------------------------------------------------------------------
09:39:07.837 404: AddStaffSubscriptionTable migrating
09:39:07.837 -------------------------------------------------------------------------------
09:39:07.838 [+] Beginning Transaction
09:39:07.840 [+] CreateTable staff_subscriptions
09:39:07.844 [+] CreateIndex staff_subscriptions (staff_id)
09:39:07.848 [+] Committing Transaction
09:39:07.850 [+] 404: AddStaffSubscriptionTable migrated
09:39:07.851 -------------------------------------------------------------------------------
09:39:07.851 405: AddFeatureToggleForToDoListPhaseII migrating
09:39:07.851 -------------------------------------------------------------------------------
09:39:07.852 [+] Beginning Transaction
09:39:07.854 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:07.856 [+] Committing Transaction
09:39:07.869 [+] 405: AddFeatureToggleForToDoListPhaseII migrated
09:39:07.871 -------------------------------------------------------------------------------
09:39:07.871 406: AddFeatureToggleForFrontDoor migrating
09:39:07.871 -------------------------------------------------------------------------------
09:39:07.872 [+] Beginning Transaction
09:39:07.873 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:07.875 [+] Committing Transaction
09:39:07.879 [+] 406: AddFeatureToggleForFrontDoor migrated
09:39:07.881 -------------------------------------------------------------------------------
09:39:07.882 407: AddColumnPendingPracticeTypeAndRejectedPracticeTypeToTableStaff migrating
09:39:07.882 -------------------------------------------------------------------------------
09:39:07.883 [+] Beginning Transaction
09:39:07.885 [+] AlterTable staff
09:39:07.886 [+] CreateColumn staff pending_practice_type Int32
09:39:07.890 [+] AlterTable staff
09:39:07.891 [+] CreateColumn staff rejected_practice_type Int32
09:39:07.895 [+] ExecuteSqlStatement   
09:39:07.895 DECLARE @id BIGINT
09:39:07.895 DECLARE @pt BIGINT
09:39:07.895 
09:39:07.896 DECLARE db_cursor CURSOR FOR  
09:39:07.896 SELECT id, [practice_type] FROM [dbo].[staff]
09:39:07.896 WHERE [status] = 0;
09:39:07.896 
09:39:07.896 OPEN db_cursor;
09:39:07.896  
09:39:07.896 FETCH NEXT FROM db_cursor INTO @id, @pt;
09:39:07.897 
09:39:07.897 WHILE @@FETCH_STATUS = 0 
09:39:07.897   BEGIN
09:39:07.897 	UPDATE [dbo].[staff] SET pending_practice_type=@pt, practice_type=0 WHERE id = @id;
09:39:07.897     FETCH NEXT FROM db_cursor INTO @id, @pt;
09:39:07.897   END;
09:39:07.898 
09:39:07.898 CLOSE db_cursor;   
09:39:07.898 DEALLOCATE db_cursor;
09:39:07.903 [+] Committing Transaction
09:39:07.905 [+] 407: AddColumnPendingPracticeTypeAndRejectedPracticeTypeToTableStaff migrated
09:39:07.907 -------------------------------------------------------------------------------
09:39:07.907 408: AddCurrenciesTable migrating
09:39:07.907 -------------------------------------------------------------------------------
09:39:07.908 [+] Beginning Transaction
09:39:07.910 [+] CreateTable currencies
09:39:07.914 [+] Committing Transaction
09:39:07.915 [+] 408: AddCurrenciesTable migrated
09:39:07.916 -------------------------------------------------------------------------------
09:39:07.916 409: AddWorkRecordTEQTable migrating
09:39:07.917 -------------------------------------------------------------------------------
09:39:07.917 [+] Beginning Transaction
09:39:07.919 [+] CreateTable work_record_teq
09:39:07.923 [+] CreateConstraint PK_work_record_teq
09:39:07.929 [+] Committing Transaction
09:39:07.932 [+] 409: AddWorkRecordTEQTable migrated
09:39:07.933 -------------------------------------------------------------------------------
09:39:07.933 410: AddTEQFeatureToggle migrating
09:39:07.934 -------------------------------------------------------------------------------
09:39:07.934 [+] Beginning Transaction
09:39:07.937 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:07.939 [+] Committing Transaction
09:39:07.941 [+] 410: AddTEQFeatureToggle migrated
09:39:07.943 -------------------------------------------------------------------------------
09:39:07.943 411: AddColumnLevelToTableStaff migrating
09:39:07.943 -------------------------------------------------------------------------------
09:39:07.946 [+] Beginning Transaction
09:39:07.951 [+] AlterTable staff
09:39:07.953 [+] CreateColumn staff level Int32
09:39:07.956 [+] Committing Transaction
09:39:07.958 [+] 411: AddColumnLevelToTableStaff migrated
09:39:07.960 -------------------------------------------------------------------------------
09:39:07.960 412: AddFeatureToggleForBatchUpdateCheckListItems migrating
09:39:07.960 -------------------------------------------------------------------------------
09:39:07.960 [+] Beginning Transaction
09:39:07.963 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:07.964 [+] Committing Transaction
09:39:07.966 [+] 412: AddFeatureToggleForBatchUpdateCheckListItems migrated
09:39:07.968 -------------------------------------------------------------------------------
09:39:07.968 413: InitializeCurrenciesTable migrating
09:39:07.968 -------------------------------------------------------------------------------
09:39:07.969 [+] Beginning Transaction
09:39:08.080 [+] -> 162 Insert operations completed in 00:00:00.1015560 taking an average of 00:00:00.0006268
09:39:08.081 [+] Committing Transaction
09:39:08.083 [+] 413: InitializeCurrenciesTable migrated
09:39:08.084 -------------------------------------------------------------------------------
09:39:08.085 414: AddFeatureToggleForEngagementEnhancement migrating
09:39:08.085 -------------------------------------------------------------------------------
09:39:08.085 [+] Beginning Transaction
09:39:08.087 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:08.089 [+] Committing Transaction
09:39:08.091 [+] 414: AddFeatureToggleForEngagementEnhancement migrated
09:39:08.093 -------------------------------------------------------------------------------
09:39:08.093 415: AddFeatureToggleForVipPhaseII migrating
09:39:08.093 -------------------------------------------------------------------------------
09:39:08.093 [+] Beginning Transaction
09:39:08.096 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:08.097 [+] Committing Transaction
09:39:08.099 [+] 415: AddFeatureToggleForVipPhaseII migrated
09:39:08.100 -------------------------------------------------------------------------------
09:39:08.100 416: AddIndexesOfWorkRecordTaskAssignmentTable migrating
09:39:08.100 -------------------------------------------------------------------------------
09:39:08.101 [+] Beginning Transaction
09:39:08.102 [+] CreateIndex work_record_task_assignments (work_record_id)
09:39:08.105 [+] CreateIndex work_record_task_assignments (task_definition_id)
09:39:08.108 [+] Committing Transaction
09:39:08.110 [+] 416: AddIndexesOfWorkRecordTaskAssignmentTable migrated
09:39:08.112 -------------------------------------------------------------------------------
09:39:08.112 417: AddIndexesOfWorkRecordCheckListTable migrating
09:39:08.112 -------------------------------------------------------------------------------
09:39:08.113 [+] Beginning Transaction
09:39:08.115 [+] CreateIndex work_record_checklist_templates (work_record_id)
09:39:08.118 [+] Committing Transaction
09:39:08.120 [+] 417: AddIndexesOfWorkRecordCheckListTable migrated
09:39:08.121 -------------------------------------------------------------------------------
09:39:08.121 418: RemoveFeatureToggleEngagementRole migrating
09:39:08.121 -------------------------------------------------------------------------------
09:39:08.122 [+] Beginning Transaction
09:39:08.123 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.125 [+] Committing Transaction
09:39:08.127 [+] 418: RemoveFeatureToggleEngagementRole migrated
09:39:08.128 -------------------------------------------------------------------------------
09:39:08.129 419: AddFeatureToggleForHiddenAssignee migrating
09:39:08.129 -------------------------------------------------------------------------------
09:39:08.129 [+] Beginning Transaction
09:39:08.132 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.134 [+] Committing Transaction
09:39:08.135 [+] 419: AddFeatureToggleForHiddenAssignee migrated
09:39:08.137 -------------------------------------------------------------------------------
09:39:08.137 420: AddStaffEmailWhiteListTable migrating
09:39:08.137 -------------------------------------------------------------------------------
09:39:08.141 [+] Beginning Transaction
09:39:08.143 [+] CreateTable staff_email_white_list
09:39:08.148 [+] Committing Transaction
09:39:08.151 [+] 420: AddStaffEmailWhiteListTable migrated
09:39:08.152 -------------------------------------------------------------------------------
09:39:08.153 421: MigrateDataForStaffEmailWhiteList migrating
09:39:08.153 -------------------------------------------------------------------------------
09:39:08.153 [+] Beginning Transaction
09:39:08.155 [+] ExecuteSqlStatement insert into [dbo].[staff_email_white_list] values ('@us.pwc.com');
09:39:08.155                         insert into [dbo].[staff_email_white_list] values ('@uk.pwc.com');
09:39:08.156                         insert into [dbo].[staff_email_white_list] values ('@ch.pwc.com');
09:39:08.156                         insert into [dbo].[staff_email_white_list] values ('@jp.pwc.com');
09:39:08.156                         insert into [dbo].[staff_email_white_list] values ('@pwclegal.com');
09:39:08.156                         insert into [dbo].[staff_email_white_list] values ('@be.pwc.com');
09:39:08.156                         insert into [dbo].[staff_email_white_list] values ('@nl.pwc.com');
09:39:08.156                         insert into [dbo].[staff_email_white_list] values ('@ca.pwc.com');
09:39:08.157                         insert into [dbo].[staff_email_white_list] values ('@de.pwc.com');
09:39:08.157                         insert into [dbo].[staff_email_white_list] values ('@es.landwell.com');
09:39:08.157                         insert into [dbo].[staff_email_white_list] values ('@cn.pwc.com');
09:39:08.157                         insert into [dbo].[staff_email_white_list] values ('@br.pwc.com');
09:39:08.157                         insert into [dbo].[staff_email_white_list] values ('@fr.landwell.com');
09:39:08.157                         insert into [dbo].[staff_email_white_list] values ('@hu.pwc.com');
09:39:08.157                         insert into [dbo].[staff_email_white_list] values ('@in.pwc.com');
09:39:08.158                         insert into [dbo].[staff_email_white_list] values ('@it.pwc.com');
09:39:08.158                         insert into [dbo].[staff_email_white_list] values ('@lu.pwc.com');
09:39:08.158                         insert into [dbo].[staff_email_white_list] values ('@mx.pwc.com');
09:39:08.158                         insert into [dbo].[staff_email_white_list] values ('@pl.pwc.com');
09:39:08.158                         insert into [dbo].[staff_email_white_list] values ('@kr.pwc.com');
09:39:08.158                         insert into [dbo].[staff_email_white_list] values ('@au.pwc.com');
09:39:08.159                         insert into [dbo].[staff_email_white_list] values ('@pwc.be');
09:39:08.159                         insert into [dbo].[staff_email_white_list] values ('@cl.pwc.com');
09:39:08.159                         insert into [dbo].[staff_email_white_list] values ('@my.pwc.com');
09:39:08.159                         insert into [dbo].[staff_email_white_list] values ('@ph.pwc.com');
09:39:08.159                         insert into [dbo].[staff_email_white_list] values ('@es.pwc.com');
09:39:08.159                         insert into [dbo].[staff_email_white_list] values ('@sg.pwc.com');
09:39:08.159                         insert into [dbo].[staff_email_white_list] values ('@qa.pwc.com');
09:39:08.160                         insert into [dbo].[staff_email_white_list] values ('@at.pwc.com');
09:39:08.160                         insert into [dbo].[staff_email_white_list] values ('@no.pwc.com');
09:39:08.160                         insert into [dbo].[staff_email_white_list] values ('@fi.pwc.com');
09:39:08.160                         insert into [dbo].[staff_email_white_list] values ('@se.pwc.com');
09:39:08.160                         insert into [dbo].[staff_email_white_list] values ('@cz.pwc.com');
09:39:08.160                         insert into [dbo].[staff_email_white_list] values ('@ro.pwc.com');
09:39:08.160                         insert into [dbo].[staff_email_white_list] values ('@ru.pwc.com');
09:39:08.161                         insert into [dbo].[staff_email_white_list] values ('@tr.pwc.com');
09:39:08.161                         insert into [dbo].[staff_email_white_list] values ('@hk.pwc.com');
09:39:08.161                         insert into [dbo].[staff_email_white_list] values ('@za.pwc.com');
09:39:08.161                         insert into [dbo].[staff_email_white_list] values ('@pt.pwc.com');
09:39:08.161                         insert into [dbo].[staff_email_white_list] values ('@dk.pwc.com');
09:39:08.161                         insert into [dbo].[staff_email_white_list] values ('@xa.pwc.com');
09:39:08.161                         insert into [dbo].[staff_email_white_list] values ('@th.pwc.com');
09:39:08.162                         insert into [dbo].[staff_email_white_list] values ('@tw.pwc.com');
09:39:08.162                         insert into [dbo].[staff_email_white_list] values ('@lk.pwc.com');
09:39:08.162                         insert into [dbo].[staff_email_white_list] values ('@ae.pwc.com');
09:39:08.162                         insert into [dbo].[staff_email_white_list] values ('@nz.pwc.com');
09:39:08.162                         insert into [dbo].[staff_email_white_list] values ('@kwt.pwc.com');
09:39:08.162                         insert into [dbo].[staff_email_white_list] values ('@ie.pwc.com');
09:39:08.163                         insert into [dbo].[staff_email_white_list] values ('@id.pwc.com');
09:39:08.163                         insert into [dbo].[staff_email_white_list] values ('@jo.pwc.com');
09:39:08.163                         insert into [dbo].[staff_email_white_list] values ('@pe.pwc.com');
09:39:08.163                         insert into [dbo].[staff_email_white_list] values ('@ar.pwc.com');
09:39:08.163                         insert into [dbo].[staff_email_white_list] values ('@sk.pwc.com');
09:39:08.163                         insert into [dbo].[staff_email_white_list] values ('@co.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@fr.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@gr.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@ma.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@uy.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@ng.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@cr.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@kz.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@ua.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@vn.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@mu.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@il.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@ec.pwc.com');
09:39:08.164                         insert into [dbo].[staff_email_white_list] values ('@bg.pwc.com');
09:39:08.165                         insert into [dbo].[staff_email_white_list] values ('@pa.pwc.com');
09:39:08.165                         insert into [dbo].[staff_email_white_list] values ('@ve.pwc.com');
09:39:08.165                         insert into [dbo].[staff_email_white_list] values ('@zm.pwc.com');
09:39:08.165                         insert into [dbo].[staff_email_white_list] values ('@ke.pwc.com');
09:39:08.165                         insert into [dbo].[staff_email_white_list] values ('@pk.pwc.com');
09:39:08.165                         insert into [dbo].[staff_email_white_list] values ('@sv.pwc.com');
09:39:08.165                         insert into [dbo].[staff_email_white_list] values ('@hn.pwc.com');
09:39:08.166                         insert into [dbo].[staff_email_white_list] values ('@tt.pwc.com');
09:39:08.166                         insert into [dbo].[staff_email_white_list] values ('@ni.pwc.com');
09:39:08.166                         insert into [dbo].[staff_email_white_list] values ('@eg.pwc.com');
09:39:08.166                         insert into [dbo].[staff_email_white_list] values ('@hr.pwc.com');
09:39:08.166                         insert into [dbo].[staff_email_white_list] values ('@lv.pwc.com');
09:39:08.166                         insert into [dbo].[staff_email_white_list] values ('@ee.pwc.com');
09:39:08.166                         insert into [dbo].[staff_email_white_list] values ('@az.pwc.com');
09:39:08.167                         insert into [dbo].[staff_email_white_list] values ('@pwc.dk');
09:39:08.167                         insert into [dbo].[staff_email_white_list] values ('@bw.pwc.com');
09:39:08.167                         insert into [dbo].[staff_email_white_list] values ('@gg.pwc.com');
09:39:08.167                         insert into [dbo].[staff_email_white_list] values ('@an.pwc.com');
09:39:08.168                         insert into [dbo].[staff_email_white_list] values ('@je.pwc.com');
09:39:08.168                         insert into [dbo].[staff_email_white_list] values ('@gt.pwc.com');
09:39:08.168                         insert into [dbo].[staff_email_white_list] values ('@sa.pwc.com');
09:39:08.168                         insert into [dbo].[staff_email_white_list] values ('@am.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@fj.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@tz.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@is.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@lt.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@na.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@gi.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@by.pwc.com');
09:39:08.169                         insert into [dbo].[staff_email_white_list] values ('@bb.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@mt.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@rw.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@sz.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@ba.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@jm.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@dz.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@zw.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@cm.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@mg.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@ge.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@ug.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@gh.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@do.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@lb.pwc.com');
09:39:08.170                         insert into [dbo].[staff_email_white_list] values ('@iom.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@rs.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@cy.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@KH.PWC.COM');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@mk.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@tn.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@cd.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@ly.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@bs.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@si.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@ga.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@br.owc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@pg.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@mn.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@mz.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@pwc.uk.org');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@br.pw.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@al.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@cg.pwc.com');
09:39:08.171                         insert into [dbo].[staff_email_white_list] values ('@mw.pwc.com');
09:39:08.172                         insert into [dbo].[staff_email_white_list] values ('@ul.pwc.com');
09:39:08.172                         insert into [dbo].[staff_email_white_list] values ('@la.pwc.com');
09:39:08.172                         insert into [dbo].[staff_email_white_list] values ('@uz.pwc.com');
09:39:08.172                         insert into [dbo].[staff_email_white_list] values ('@bm.pwc.com');
09:39:08.172                         insert into [dbo].[staff_email_white_list] values ('@be.pwc.be');    
09:39:08.172                         insert into [dbo].[staff_email_white_list] values ('@thoughtworks.com');
09:39:08.176 [+] Committing Transaction
09:39:08.177 [+] 421: MigrateDataForStaffEmailWhiteList migrated
09:39:08.178 -------------------------------------------------------------------------------
09:39:08.178 422: CreateAssigneeWorkRecordTable migrating
09:39:08.178 -------------------------------------------------------------------------------
09:39:08.178 [+] Beginning Transaction
09:39:08.180 [+] CreateTable assignee_work_records
09:39:08.186 [+] CreateForeignKey fk_assignee_work_records_ref_work_records assignee_work_records(work_record_id) work_records(id)
09:39:08.188 [+] CreateConstraint PK_assignee_work_records
09:39:08.191 [+] CreateIndex assignee_work_records (tax_year, practice_type, assignee_id)
09:39:08.194 [+] CreateIndex assignee_work_records (tax_year, practice_type)
09:39:08.196 [+] CreateIndex assignee_work_records (assignee_id)
09:39:08.200 [+] Committing Transaction
09:39:08.202 [+] 422: CreateAssigneeWorkRecordTable migrated
09:39:08.210 -------------------------------------------------------------------------------
09:39:08.210 423: DeleteStaffEvents migrating
09:39:08.211 -------------------------------------------------------------------------------
09:39:08.211 [+] Beginning Transaction
09:39:08.213 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.215 [+] Committing Transaction
09:39:08.217 [+] 423: DeleteStaffEvents migrated
09:39:08.218 -------------------------------------------------------------------------------
09:39:08.218 424: RemoveFeatureToggleEngagementEnhancement migrating
09:39:08.218 -------------------------------------------------------------------------------
09:39:08.219 [+] Beginning Transaction
09:39:08.221 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.223 [+] Committing Transaction
09:39:08.225 [+] 424: RemoveFeatureToggleEngagementEnhancement migrated
09:39:08.226 -------------------------------------------------------------------------------
09:39:08.226 425: AddEventStorePhaseIFeatureToggle migrating
09:39:08.227 -------------------------------------------------------------------------------
09:39:08.227 [+] Beginning Transaction
09:39:08.229 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.231 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.232 [+] Committing Transaction
09:39:08.234 [+] 425: AddEventStorePhaseIFeatureToggle migrated
09:39:08.235 -------------------------------------------------------------------------------
09:39:08.236 426: AddStaffEmployeeIdsTableAndMigrateStaffEmployeeIdFromStaffTable migrating
09:39:08.236 -------------------------------------------------------------------------------
09:39:08.236 [+] Beginning Transaction
09:39:08.238 [+] CreateTable staff_employee_ids
09:39:08.241 [+] ExecuteSqlStatement INSERT INTO [dbo].[staff_employee_ids] ([staff_id], [employee_id])
09:39:08.242   SELECT [id], [employee_id] FROM [dbo].[staff]
09:39:08.245 [+] Committing Transaction
09:39:08.247 [+] 426: AddStaffEmployeeIdsTableAndMigrateStaffEmployeeIdFromStaffTable migrated
09:39:08.248 -------------------------------------------------------------------------------
09:39:08.248 427: DeleteStaffEmployeeIdColumnUniqueConstraint migrating
09:39:08.248 -------------------------------------------------------------------------------
09:39:08.248 [+] Beginning Transaction
09:39:08.250 [+] ExecuteSqlStatement IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[staff]') AND name = N'employee_id_unique')
09:39:08.250 ALTER TABLE [dbo].[staff] DROP CONSTRAINT [employee_id_unique]
09:39:08.250 GO
09:39:08.260 [+] Committing Transaction
09:39:08.261 [+] 427: DeleteStaffEmployeeIdColumnUniqueConstraint migrated
09:39:08.261 -------------------------------------------------------------------------------
09:39:08.261 428: MigrateAssigneeWorkRecords migrating
09:39:08.261 -------------------------------------------------------------------------------
09:39:08.261 [+] Beginning Transaction
09:39:08.262 [+] ExecuteSqlStatement 
09:39:08.262 INSERT INTO assignee_work_records
09:39:08.262 (work_record_id, practice_type, tax_year, assignee_id, estimated_completion_date, service_status, suspended, ir_mark, no_filing_requirement, days_in_house, mi_days, expiry_date)
09:39:08.262 (SELECT id, practice_type, tax_year, assignee_id, estimated_completion_date, service_status, suspended, ir_mark, no_filing_requirement, days_in_house, mi_days, expiry_date FROM work_records);
09:39:08.262             
09:39:08.265 [+] Committing Transaction
09:39:08.266 [+] 428: MigrateAssigneeWorkRecords migrated
09:39:08.266 -------------------------------------------------------------------------------
09:39:08.266 429: AddFeatureToggleForEmployerReturnWorkRecord migrating
09:39:08.266 -------------------------------------------------------------------------------
09:39:08.266 [+] Beginning Transaction
09:39:08.270 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:08.270 [+] Committing Transaction
09:39:08.271 [+] 429: AddFeatureToggleForEmployerReturnWorkRecord migrated
09:39:08.271 -------------------------------------------------------------------------------
09:39:08.271 430: CreateEmployerWorkRecordTable migrating
09:39:08.272 -------------------------------------------------------------------------------
09:39:08.272 [+] Beginning Transaction
09:39:08.272 [+] CreateTable employer_work_records
09:39:08.274 [+] CreateForeignKey fk_employer_work_records_ref_work_records employer_work_records(work_record_id) work_records(id)
09:39:08.275 [+] CreateConstraint PK_employer_work_records
09:39:08.277 [+] Committing Transaction
09:39:08.278 [+] 430: CreateEmployerWorkRecordTable migrated
09:39:08.278 -------------------------------------------------------------------------------
09:39:08.278 431: AddWorkRecordTypeColumnToTaskTemplate migrating
09:39:08.278 -------------------------------------------------------------------------------
09:39:08.278 [+] Beginning Transaction
09:39:08.279 [+] AlterTable task_templates
09:39:08.279 [+] CreateColumn task_templates work_record_type Int16
09:39:08.282 [+] ExecuteSqlStatement declare @id int;
09:39:08.282   insert into [task_templates] (name, owned_by, engagement_id, is_default, practice_type, is_mandatory, work_record_type) 
09:39:08.282   values('DEFAULT_EMPLOYER_TAX_TASK_TEMPLATE', 0, Null, 1, 0, 0, 1);
09:39:08.282   set @id = SCOPE_IDENTITY();
09:39:08.282   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Requested',0,@id,10,1,0);
09:39:08.282   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Received',0,@id,20,1,0);
09:39:08.282   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Drafted',0,@id,30,1,0);
09:39:08.282   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Approved',0,@id,40,1,0);
09:39:08.282   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Complete',0,@id,50,1,0);
09:39:08.288 [+] Committing Transaction
09:39:08.288 [+] 431: AddWorkRecordTypeColumnToTaskTemplate migrated
09:39:08.288 -------------------------------------------------------------------------------
09:39:08.288 432: AddFeatureToggleForExternalApiJapanRequirement migrating
09:39:08.288 -------------------------------------------------------------------------------
09:39:08.288 [+] Beginning Transaction
09:39:08.289 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.290 [+] Committing Transaction
09:39:08.291 [+] 432: AddFeatureToggleForExternalApiJapanRequirement migrated
09:39:08.291 -------------------------------------------------------------------------------
09:39:08.291 433: AddFeatureToggleForServiceEvaluation migrating
09:39:08.291 -------------------------------------------------------------------------------
09:39:08.291 [+] Beginning Transaction
09:39:08.292 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.293 [+] Committing Transaction
09:39:08.294 [+] 433: AddFeatureToggleForServiceEvaluation migrated
09:39:08.294 -------------------------------------------------------------------------------
09:39:08.294 434: AddEmployerWorkRecordClientContactTable migrating
09:39:08.294 -------------------------------------------------------------------------------
09:39:08.295 [+] Beginning Transaction
09:39:08.296 [+] CreateTable employer_workrecord_client_contact
09:39:08.298 [+] CreateForeignKey FK_employer_workrecord_client_contact_employer_workrecord_id_employer_work_records_work_record_id employer_workrecord_client_contact(employer_workrecord_id) employer_work_records(work_record_id)
09:39:08.301 [+] Committing Transaction
09:39:08.301 [+] 434: AddEmployerWorkRecordClientContactTable migrated
09:39:08.302 -------------------------------------------------------------------------------
09:39:08.302 435: AddWorkRecordEvaluationTable migrating
09:39:08.302 -------------------------------------------------------------------------------
09:39:08.302 [+] Beginning Transaction
09:39:08.303 [+] CreateTable evaluation
09:39:08.305 [+] CreateForeignKey fk_evaluation_ref_work_records evaluation(work_record_id) work_records(id)
09:39:08.306 [+] CreateIndex evaluation (work_record_id)
09:39:08.307 [+] Committing Transaction
09:39:08.308 [+] 435: AddWorkRecordEvaluationTable migrated
09:39:08.308 -------------------------------------------------------------------------------
09:39:08.308 436: AddEvaluationSurveyTable migrating
09:39:08.308 -------------------------------------------------------------------------------
09:39:08.308 [+] Beginning Transaction
09:39:08.309 [+] CreateTable evaluation_survey
09:39:08.310 [+] CreateForeignKey fk_evaluation_survey_ref_evaluation evaluation_survey(evaluation_id) evaluation(id)
09:39:08.313 [+] CreateIndex evaluation_survey (evaluation_id)
09:39:08.315 [+] Committing Transaction
09:39:08.316 [+] 436: AddEvaluationSurveyTable migrated
09:39:08.316 -------------------------------------------------------------------------------
09:39:08.317 437: AddEvaluationSurveyAnswerTable migrating
09:39:08.317 -------------------------------------------------------------------------------
09:39:08.317 [+] Beginning Transaction
09:39:08.318 [+] CreateTable evaluation_survey_answer
09:39:08.319 [+] CreateForeignKey fk_evaluation_survey_answer_ref_evaluation_survey evaluation_survey_answer(survey_id) evaluation_survey(id)
09:39:08.321 [+] CreateIndex evaluation_survey_answer (survey_id)
09:39:08.325 [+] Committing Transaction
09:39:08.327 [+] 437: AddEvaluationSurveyAnswerTable migrated
09:39:08.328 -------------------------------------------------------------------------------
09:39:08.328 438: _0438_RemoveFileSharingFeatureToggle migrating
09:39:08.329 -------------------------------------------------------------------------------
09:39:08.329 [+] Beginning Transaction
09:39:08.330 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.335 [+] Committing Transaction
09:39:08.341 [+] 438: _0438_RemoveFileSharingFeatureToggle migrated
09:39:08.342 -------------------------------------------------------------------------------
09:39:08.342 439: MigrateEvaluationSurveyTable migrating
09:39:08.342 -------------------------------------------------------------------------------
09:39:08.343 [+] Beginning Transaction
09:39:08.344 [+] AlterTable evaluation_survey
09:39:08.346 [+] AlterColumn evaluation_survey token Guid
09:39:08.350 [+] RenameColumn evaluation_survey create_at to created_at
09:39:08.351 [+] Committing Transaction
09:39:08.352 [+] 439: MigrateEvaluationSurveyTable migrated
09:39:08.352 -------------------------------------------------------------------------------
09:39:08.353 440: ChangeSubmittedAtNullableOnEvaluationSurveyTable migrating
09:39:08.353 -------------------------------------------------------------------------------
09:39:08.353 [+] Beginning Transaction
09:39:08.353 [+] AlterTable evaluation_survey
09:39:08.354 [+] AlterColumn evaluation_survey submitted_at 
09:39:08.356 [+] Committing Transaction
09:39:08.357 [+] 440: ChangeSubmittedAtNullableOnEvaluationSurveyTable migrated
09:39:08.357 -------------------------------------------------------------------------------
09:39:08.357 441: AddFeatureToggleForMyMobilityInviteRebecca migrating
09:39:08.357 -------------------------------------------------------------------------------
09:39:08.357 [+] Beginning Transaction
09:39:08.358 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.359 [+] Committing Transaction
09:39:08.359 [+] 441: AddFeatureToggleForMyMobilityInviteRebecca migrated
09:39:08.360 -------------------------------------------------------------------------------
09:39:08.360 442: ChangeTokenToStringOnEvaluationSurveyTable migrating
09:39:08.360 -------------------------------------------------------------------------------
09:39:08.360 [+] Beginning Transaction
09:39:08.361 [+] AlterTable evaluation_survey
09:39:08.361 [+] AlterColumn evaluation_survey token String
09:39:08.363 [+] Committing Transaction
09:39:08.364 [+] 442: ChangeTokenToStringOnEvaluationSurveyTable migrated
09:39:08.364 -------------------------------------------------------------------------------
09:39:08.364 443: AddMyMobilitySegmentationInEngagementCustomFieldsTable migrating
09:39:08.364 -------------------------------------------------------------------------------
09:39:08.364 [+] Beginning Transaction
09:39:08.365 [+] AlterTable engagement_custom_fields
09:39:08.365 [+] CreateColumn engagement_custom_fields mymobility_segmentation Boolean
09:39:08.367 [+] Committing Transaction
09:39:08.368 [+] 443: AddMyMobilitySegmentationInEngagementCustomFieldsTable migrated
09:39:08.368 -------------------------------------------------------------------------------
09:39:08.368 444: AddEmployeeIdColumnToEventsTable migrating
09:39:08.368 -------------------------------------------------------------------------------
09:39:08.368 [+] Beginning Transaction
09:39:08.369 [+] AlterTable events
09:39:08.369 [+] CreateColumn events employeeId String
09:39:08.371 [+] Committing Transaction
09:39:08.371 [+] 444: AddEmployeeIdColumnToEventsTable migrated
09:39:08.371 -------------------------------------------------------------------------------
09:39:08.372 445: AddClientContactsEmailHistoryTable migrating
09:39:08.372 -------------------------------------------------------------------------------
09:39:08.372 [+] Beginning Transaction
09:39:08.373 [+] CreateTable client_contacts_email_history
09:39:08.376 [+] Committing Transaction
09:39:08.377 [+] 445: AddClientContactsEmailHistoryTable migrated
09:39:08.377 -------------------------------------------------------------------------------
09:39:08.378 446: AddEngagementEvaluationSettingsTable migrating
09:39:08.378 -------------------------------------------------------------------------------
09:39:08.378 [+] Beginning Transaction
09:39:08.379 [+] CreateTable engagement_evaluation_settings
09:39:08.382 [+] CreateForeignKey fk_engagement_evaluation_settings_ref_engagements engagement_evaluation_settings(engagement_id) engagements(id)
09:39:08.384 [+] CreateIndex engagement_evaluation_settings (engagement_id)
09:39:08.387 [+] Committing Transaction
09:39:08.388 [+] 446: AddEngagementEvaluationSettingsTable migrated
09:39:08.389 -------------------------------------------------------------------------------
09:39:08.390 447: ChangeStaffIdNullableOnEmailHistoryTable migrating
09:39:08.390 -------------------------------------------------------------------------------
09:39:08.390 [+] Beginning Transaction
09:39:08.391 [+] AlterTable email_history
09:39:08.393 [+] AlterColumn email_history staff_id Int64
09:39:08.396 [+] Committing Transaction
09:39:08.398 [+] 447: ChangeStaffIdNullableOnEmailHistoryTable migrated
09:39:08.404 -------------------------------------------------------------------------------
09:39:08.404 448: AddReminderEnabledColumnToEvaluationTable migrating
09:39:08.405 -------------------------------------------------------------------------------
09:39:08.405 [+] Beginning Transaction
09:39:08.408 [+] AlterTable evaluation
09:39:08.410 [+] CreateColumn evaluation reminder_enabled Boolean
09:39:08.413 [+] Committing Transaction
09:39:08.415 [+] 448: AddReminderEnabledColumnToEvaluationTable migrated
09:39:08.416 -------------------------------------------------------------------------------
09:39:08.416 449: CreateEvaluationTemplateTable migrating
09:39:08.416 -------------------------------------------------------------------------------
09:39:08.417 [+] Beginning Transaction
09:39:08.419 [+] CreateTable evaluation_template
09:39:08.422 [+] CreateIndex evaluation_template (template_id)
09:39:08.425 [+] Committing Transaction
09:39:08.427 [+] 449: CreateEvaluationTemplateTable migrated
09:39:08.428 -------------------------------------------------------------------------------
09:39:08.428 450: RenameClientContactsEmailHistory migrating
09:39:08.428 -------------------------------------------------------------------------------
09:39:08.429 [+] Beginning Transaction
09:39:08.430 [+] RenameTable client_contacts_email_history employer_work_record_email_history
09:39:08.434 [+] Committing Transaction
09:39:08.436 [+] 450: RenameClientContactsEmailHistory migrated
09:39:08.437 -------------------------------------------------------------------------------
09:39:08.437 451: CreateEvaluationReminderTable migrating
09:39:08.438 -------------------------------------------------------------------------------
09:39:08.438 [+] Beginning Transaction
09:39:08.440 [+] CreateTable evaluation_reminder
09:39:08.444 [+] CreateForeignKey fk_evaluation_reminder_ref_evaluation evaluation_reminder(evaluation_id) evaluation(id)
09:39:08.447 [+] Committing Transaction
09:39:08.449 [+] 451: CreateEvaluationReminderTable migrated
09:39:08.451 -------------------------------------------------------------------------------
09:39:08.451 452: ChangeEvaluationTemplateToStandaloneTable migrating
09:39:08.451 -------------------------------------------------------------------------------
09:39:08.451 [+] Beginning Transaction
09:39:08.456 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.459 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.465 [+] DeleteForeignKey fk_evaluation_survey_ref_evaluation evaluation_survey ()  ()
09:39:08.473 [+] DeleteForeignKey fk_evaluation_reminder_ref_evaluation evaluation_reminder ()  ()
09:39:08.477 [+] DeleteTable evaluation
09:39:08.482 [+] DeleteIndex evaluation_template ()
09:39:08.484 [+] DeleteColumn evaluation_template template_id
09:39:08.512 [+] AlterTable evaluation_template
09:39:08.512 [+] CreateColumn evaluation_template template_id Int64
09:39:08.514 [+] CreateIndex evaluation_template (template_id)
09:39:08.515 [+] AlterTable evaluation_template
09:39:08.515 [+] CreateColumn evaluation_template practice_type Int32
09:39:08.516 [+] CreateConstraint PK_evaluation_template
09:39:08.518 [+] CreateTable evaluation
09:39:08.520 [+] CreateIndex evaluation (id)
09:39:08.521 [+] CreateForeignKey fk_evaluation_ref_work_records evaluation(work_record_id) work_records(id)
09:39:08.522 [+] CreateForeignKey fk_evaluation_ref_evaluation_template evaluation(template_id) evaluation_template(template_id)
09:39:08.523 [+] CreateIndex evaluation (work_record_id)
09:39:08.524 [+] CreateForeignKey fk_evaluation_survey_ref_evaluation evaluation_survey(evaluation_id) evaluation(id)
09:39:08.526 [+] CreateForeignKey fk_evaluation_reminder_ref_evaluation evaluation_reminder(evaluation_id) evaluation(id)
09:39:08.527 [+] Committing Transaction
09:39:08.528 [+] 452: ChangeEvaluationTemplateToStandaloneTable migrated
09:39:08.528 -------------------------------------------------------------------------------
09:39:08.528 453: AddHasEfileIdColumnForEfileGroupTable migrating
09:39:08.528 -------------------------------------------------------------------------------
09:39:08.528 [+] Beginning Transaction
09:39:08.530 [+] AlterTable efile_groups
09:39:08.531 [+] CreateColumn efile_groups has_efile_id Boolean
09:39:08.534 [+] Committing Transaction
09:39:08.535 [+] 453: AddHasEfileIdColumnForEfileGroupTable migrated
09:39:08.536 -------------------------------------------------------------------------------
09:39:08.536 454: UpdateHasEfileIdColumnForExistingEfileCountries migrating
09:39:08.536 -------------------------------------------------------------------------------
09:39:08.536 [+] Beginning Transaction
09:39:08.538 [+] ExecuteSqlStatement Update efile_groups set has_efile_id = 0 where country_id in (select id from countries where abbreviation = 'IE')
09:39:08.545 [+] Committing Transaction
09:39:08.547 [+] 454: UpdateHasEfileIdColumnForExistingEfileCountries migrated
09:39:08.548 -------------------------------------------------------------------------------
09:39:08.549 455: RemoveEfileFeatureToggle migrating
09:39:08.549 -------------------------------------------------------------------------------
09:39:08.549 [+] Beginning Transaction
09:39:08.551 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.553 [+] Committing Transaction
09:39:08.555 [+] 455: RemoveEfileFeatureToggle migrated
09:39:08.556 -------------------------------------------------------------------------------
09:39:08.556 456: UpdateEventStoreFeatureToggleName migrating
09:39:08.556 -------------------------------------------------------------------------------
09:39:08.557 [+] Beginning Transaction
09:39:08.558 [+] ExecuteSqlStatement Update feature_toggle set feature_name = 'eventstore' where feature_name = 'eventstore-phase-I'
09:39:08.563 [+] Committing Transaction
09:39:08.564 [+] 456: UpdateEventStoreFeatureToggleName migrated
09:39:08.566 -------------------------------------------------------------------------------
09:39:08.566 457: AddEventStoreMigrationStatusTable migrating
09:39:08.566 -------------------------------------------------------------------------------
09:39:08.566 [+] Beginning Transaction
09:39:08.568 [+] CreateTable eventstore_migration_process
09:39:08.574 [+] CreateIndex eventstore_migration_process (entity_type)
09:39:08.577 [+] CreateIndex eventstore_migration_process (entity_id)
09:39:08.579 [+] Committing Transaction
09:39:08.580 [+] 457: AddEventStoreMigrationStatusTable migrated
09:39:08.580 -------------------------------------------------------------------------------
09:39:08.580 458: AddFeatureToggleForFourEyesReview migrating
09:39:08.580 -------------------------------------------------------------------------------
09:39:08.581 [+] Beginning Transaction
09:39:08.581 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.582 [+] Committing Transaction
09:39:08.583 [+] 458: AddFeatureToggleForFourEyesReview migrated
09:39:08.583 -------------------------------------------------------------------------------
09:39:08.583 459: AddLimeSurveyAccountTable migrating
09:39:08.583 -------------------------------------------------------------------------------
09:39:08.583 [+] Beginning Transaction
09:39:08.584 [+] CreateTable limesurvey_account
09:39:08.586 [+] Committing Transaction
09:39:08.586 [+] 459: AddLimeSurveyAccountTable migrated
09:39:08.587 -------------------------------------------------------------------------------
09:39:08.587 460: InsertDefaultValueToLimeSurveyAccountTable migrating
09:39:08.587 -------------------------------------------------------------------------------
09:39:08.587 [+] Beginning Transaction
09:39:08.590 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:08.590 [+] Committing Transaction
09:39:08.591 [+] 460: InsertDefaultValueToLimeSurveyAccountTable migrated
09:39:08.592 -------------------------------------------------------------------------------
09:39:08.592 461: AddFeatureToggleForDeleteAssignee migrating
09:39:08.592 -------------------------------------------------------------------------------
09:39:08.592 [+] Beginning Transaction
09:39:08.593 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.593 [+] Committing Transaction
09:39:08.594 [+] 461: AddFeatureToggleForDeleteAssignee migrated
09:39:08.596 -------------------------------------------------------------------------------
09:39:08.596 462: RenameEventStoreFeatureToggle migrating
09:39:08.596 -------------------------------------------------------------------------------
09:39:08.597 [+] Beginning Transaction
09:39:08.598 [+] ExecuteSqlStatement Update feature_toggle set feature_name = 'eventstore-engagement' where feature_name = 'eventstore'
09:39:08.598 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.599 [+] Committing Transaction
09:39:08.600 [+] 462: RenameEventStoreFeatureToggle migrated
09:39:08.600 -------------------------------------------------------------------------------
09:39:08.600 463: AddMyMobilityPublicationInEngagementCustomFieldsTable migrating
09:39:08.600 -------------------------------------------------------------------------------
09:39:08.600 [+] Beginning Transaction
09:39:08.601 [+] AlterTable engagement_custom_fields
09:39:08.602 [+] CreateColumn engagement_custom_fields mymobility_publication Boolean
09:39:08.603 [+] Committing Transaction
09:39:08.604 [+] 463: AddMyMobilityPublicationInEngagementCustomFieldsTable migrated
09:39:08.604 -------------------------------------------------------------------------------
09:39:08.604 464: AddPendingDeletedOnAssigneeTable migrating
09:39:08.604 -------------------------------------------------------------------------------
09:39:08.605 [+] Beginning Transaction
09:39:08.605 [+] AlterTable assignees
09:39:08.606 [+] CreateColumn assignees pending_deleted Boolean
09:39:08.608 [+] Committing Transaction
09:39:08.609 [+] 464: AddPendingDeletedOnAssigneeTable migrated
09:39:08.611 -------------------------------------------------------------------------------
09:39:08.611 465: CreateEmployerWorkRecordAssigneeTable migrating
09:39:08.611 -------------------------------------------------------------------------------
09:39:08.611 [+] Beginning Transaction
09:39:08.614 [+] CreateTable employer_work_record_assignees
09:39:08.617 [+] Committing Transaction
09:39:08.619 [+] 465: CreateEmployerWorkRecordAssigneeTable migrated
09:39:08.621 -------------------------------------------------------------------------------
09:39:08.621 466: DeletePendingDeletedCloumnOnAssigneeTable migrating
09:39:08.621 -------------------------------------------------------------------------------
09:39:08.621 [+] Beginning Transaction
09:39:08.622 [+] DeleteColumn assignees pending_deleted
09:39:08.642 [+] Committing Transaction
09:39:08.644 [+] 466: DeletePendingDeletedCloumnOnAssigneeTable migrated
09:39:08.645 -------------------------------------------------------------------------------
09:39:08.646 467: CreateFileDeletionHistoryTable migrating
09:39:08.646 -------------------------------------------------------------------------------
09:39:08.646 [+] Beginning Transaction
09:39:08.649 [+] CreateTable file_deletion_history
09:39:08.655 [+] Committing Transaction
09:39:08.657 [+] 467: CreateFileDeletionHistoryTable migrated
09:39:08.658 -------------------------------------------------------------------------------
09:39:08.659 468: AddOffices4EyesReviewStatusCloumnOnOfficesTable migrating
09:39:08.659 -------------------------------------------------------------------------------
09:39:08.661 [+] Beginning Transaction
09:39:08.666 [+] AlterTable offices
09:39:08.668 [+] CreateColumn offices four_eyes_review_status Boolean
09:39:08.673 [+] Committing Transaction
09:39:08.674 [+] 468: AddOffices4EyesReviewStatusCloumnOnOfficesTable migrated
09:39:08.675 -------------------------------------------------------------------------------
09:39:08.676 469: AddAssigneeEventstoreFeatureToggle migrating
09:39:08.676 -------------------------------------------------------------------------------
09:39:08.676 [+] Beginning Transaction
09:39:08.678 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:08.679 [+] Committing Transaction
09:39:08.680 [+] 469: AddAssigneeEventstoreFeatureToggle migrated
09:39:08.680 -------------------------------------------------------------------------------
09:39:08.681 470: RemoveFeatureToggleForVIP migrating
09:39:08.681 -------------------------------------------------------------------------------
09:39:08.681 [+] Beginning Transaction
09:39:08.681 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.682 [+] Committing Transaction
09:39:08.683 [+] 470: RemoveFeatureToggleForVIP migrated
09:39:08.685 -------------------------------------------------------------------------------
09:39:08.685 471: RemoveFeatureToggleForVIPPhaseII migrating
09:39:08.685 -------------------------------------------------------------------------------
09:39:08.685 [+] Beginning Transaction
09:39:08.687 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.689 [+] Committing Transaction
09:39:08.691 [+] 471: RemoveFeatureToggleForVIPPhaseII migrated
09:39:08.692 -------------------------------------------------------------------------------
09:39:08.692 472: UpdateCommentColumnForEvaluationSurveyAnswerTable migrating
09:39:08.693 -------------------------------------------------------------------------------
09:39:08.693 [+] Beginning Transaction
09:39:08.695 [+] AlterColumn evaluation_survey_answer comment String
09:39:08.700 [+] ExecuteSqlStatement DELETE evaluation_survey_answer WHERE survey_id in    (SELECT id     FROM evaluation_survey     WHERE submitted_at IS NULL)
09:39:08.708 [+] Committing Transaction
09:39:08.710 [+] 472: UpdateCommentColumnForEvaluationSurveyAnswerTable migrated
09:39:08.711 -------------------------------------------------------------------------------
09:39:08.711 473: AddPendingStaffEmailTable migrating
09:39:08.711 -------------------------------------------------------------------------------
09:39:08.712 [+] Beginning Transaction
09:39:08.714 [+] CreateTable pending_staff_email
09:39:08.719 [+] CreateForeignKey fk_pending_staff_email_ref_staff pending_staff_email(staff_id) staff(id)
09:39:08.722 [+] CreateIndex pending_staff_email (staff_id)
09:39:08.732 [+] Committing Transaction
09:39:08.735 [+] 473: AddPendingStaffEmailTable migrated
09:39:08.736 -------------------------------------------------------------------------------
09:39:08.736 474: AddFeatureToggleForTeamAcrossOffice migrating
09:39:08.736 -------------------------------------------------------------------------------
09:39:08.737 [+] Beginning Transaction
09:39:08.739 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:08.741 [+] Committing Transaction
09:39:08.742 [+] 474: AddFeatureToggleForTeamAcrossOffice migrated
09:39:08.743 -------------------------------------------------------------------------------
09:39:08.744 475: AddTeamAcrossOfficesTable migrating
09:39:08.744 -------------------------------------------------------------------------------
09:39:08.744 [+] Beginning Transaction
09:39:08.745 [+] CreateTable team_across_offices
09:39:08.750 [+] CreateForeignKey fk_team_across_offices_ref_offices team_across_offices(office_id) offices(id)
09:39:08.753 [+] CreateIndex team_across_offices (office_id)
09:39:08.757 [+] Committing Transaction
09:39:08.758 [+] 475: AddTeamAcrossOfficesTable migrated
09:39:08.760 -------------------------------------------------------------------------------
09:39:08.760 476: AddTeamStaffTable migrating
09:39:08.760 -------------------------------------------------------------------------------
09:39:08.760 [+] Beginning Transaction
09:39:08.763 [+] CreateTable team_staff
09:39:08.767 [+] CreateForeignKey fk_team_staff_ref_team_across_offices team_staff(team_id) team_across_offices(id)
09:39:08.770 [+] CreateForeignKey fk_team_staff_ref_staff team_staff(staff_id) staff(id)
09:39:08.773 [+] CreateIndex team_staff (team_id)
09:39:08.776 [+] CreateIndex team_staff (staff_id)
09:39:08.779 [+] Committing Transaction
09:39:08.781 [+] 476: AddTeamStaffTable migrated
09:39:08.782 -------------------------------------------------------------------------------
09:39:08.783 477: AddLastReviewedDateColumnForStaffTable migrating
09:39:08.783 -------------------------------------------------------------------------------
09:39:08.783 [+] Beginning Transaction
09:39:08.785 [+] AlterTable staff
09:39:08.786 [+] CreateColumn staff last_review_at DateTime
09:39:08.788 [+] ExecuteSqlStatement update staff set last_review_at = convert(datetime, getutcdate()) where [status] in (1, 2)
09:39:08.797 [+] Committing Transaction
09:39:08.799 [+] 477: AddLastReviewedDateColumnForStaffTable migrated
09:39:08.800 -------------------------------------------------------------------------------
09:39:08.800 478: ChangeTeamIdToNullableInTeamStaffTable migrating
09:39:08.800 -------------------------------------------------------------------------------
09:39:08.801 [+] Beginning Transaction
09:39:08.803 [+] AlterColumn team_staff team_id Int64
09:39:08.808 [+] Committing Transaction
09:39:08.810 [+] 478: ChangeTeamIdToNullableInTeamStaffTable migrated
09:39:08.812 -------------------------------------------------------------------------------
09:39:08.812 479: AddTypeColumnForAssigneeWorkRecordsTable migrating
09:39:08.812 -------------------------------------------------------------------------------
09:39:08.813 [+] Beginning Transaction
09:39:08.815 [+] AlterTable assignee_work_records
09:39:08.817 [+] CreateColumn assignee_work_records type Int32
09:39:08.821 [+] ExecuteSqlStatement UPDATE awr
09:39:08.821 SET type = 1
09:39:08.821 FROM assignee_work_records awr
09:39:08.821 where awr.practice_type = 0;
09:39:08.825 [+] ExecuteSqlStatement UPDATE awr
09:39:08.826 SET type = 2
09:39:08.826 FROM assignee_work_records awr
09:39:08.826 where awr.practice_type = 1;
09:39:08.829 [+] ExecuteSqlStatement UPDATE awr
09:39:08.830 SET type = 2
09:39:08.830 FROM assignee_work_records awr
09:39:08.830 where awr.practice_type = 2;
09:39:08.835 [+] Committing Transaction
09:39:08.836 [+] 479: AddTypeColumnForAssigneeWorkRecordsTable migrated
09:39:08.838 -------------------------------------------------------------------------------
09:39:08.838 480: MigrateTaxReturnTypeForAssigneeWorkRecordsTable migrating
09:39:08.838 -------------------------------------------------------------------------------
09:39:08.839 [+] Beginning Transaction
09:39:08.841 [+] ExecuteSqlStatement UPDATE awr
09:39:08.841 SET type = 0
09:39:08.841 FROM assignee_work_records awr
09:39:08.841 INNER JOIN organizers o on
09:39:08.841 awr.[work_record_id] = o.[work_record_id]
09:39:08.841 where awr.practice_type = 0
09:39:08.849 [+] Committing Transaction
09:39:08.851 [+] 480: MigrateTaxReturnTypeForAssigneeWorkRecordsTable migrated
09:39:08.853 -------------------------------------------------------------------------------
09:39:08.853 481: RemoveNullColumnRecordsFromAssigneeContactTable migrating
09:39:08.853 -------------------------------------------------------------------------------
09:39:08.853 [+] Beginning Transaction
09:39:08.861 [+] ExecuteSqlStatement DELETE FROM [assignee_contact] WHERE id IN (
09:39:08.862                             SELECT id FROM [assignee_contact] WHERE [assignee_id] IS NULL or [staff_id] IS NULL or [engagement_id] IS NULL)
09:39:08.872 [+] Committing Transaction
09:39:08.874 [+] 481: RemoveNullColumnRecordsFromAssigneeContactTable migrated
09:39:08.875 -------------------------------------------------------------------------------
09:39:08.875 482: RemoveAssigneeIdIndexOnAssigneeContactTable migrating
09:39:08.875 -------------------------------------------------------------------------------
09:39:08.875 [+] Beginning Transaction
09:39:08.877 [+] DeleteIndex assignee_contact ()
09:39:08.881 [+] Committing Transaction
09:39:08.883 [+] 482: RemoveAssigneeIdIndexOnAssigneeContactTable migrated
09:39:08.885 -------------------------------------------------------------------------------
09:39:08.885 483: ChangeColumnOnAssigneeContactTableToNotNullable migrating
09:39:08.885 -------------------------------------------------------------------------------
09:39:08.885 [+] Beginning Transaction
09:39:08.887 [+] AlterTable assignee_contact
09:39:08.888 [+] AlterColumn assignee_contact assignee_id Int64
09:39:08.894 [+] AlterTable assignee_contact
09:39:08.895 [+] AlterColumn assignee_contact staff_id Int64
09:39:08.900 [+] AlterTable assignee_contact
09:39:08.902 [+] AlterColumn assignee_contact engagement_id Int64
09:39:08.908 [+] Committing Transaction
09:39:08.910 [+] 483: ChangeColumnOnAssigneeContactTableToNotNullable migrated
09:39:08.912 -------------------------------------------------------------------------------
09:39:08.912 484: AddAssigneeIdIndexOnAssigneeContactTable migrating
09:39:08.912 -------------------------------------------------------------------------------
09:39:08.912 [+] Beginning Transaction
09:39:08.913 [+] CreateIndex assignee_contact (assignee_id)
09:39:08.917 [+] Committing Transaction
09:39:08.923 [+] 484: AddAssigneeIdIndexOnAssigneeContactTable migrated
09:39:08.928 -------------------------------------------------------------------------------
09:39:08.928 485: MigrateStatusOfDeletedAssigneeFromZeroToSix migrating
09:39:08.928 -------------------------------------------------------------------------------
09:39:08.929 [+] Beginning Transaction
09:39:08.931 [+] ExecuteSqlStatement UPDATE [assignees] SET [status] = 6 WHERE [status] = 0
09:39:08.937 [+] Committing Transaction
09:39:08.941 [+] 485: MigrateStatusOfDeletedAssigneeFromZeroToSix migrated
09:39:08.944 -------------------------------------------------------------------------------
09:39:08.944 486: AddWorkRecordEventstoreFeatureToggle migrating
09:39:08.944 -------------------------------------------------------------------------------
09:39:08.945 [+] Beginning Transaction
09:39:08.949 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:08.951 [+] Committing Transaction
09:39:08.954 [+] 486: AddWorkRecordEventstoreFeatureToggle migrated
09:39:08.955 -------------------------------------------------------------------------------
09:39:08.955 487: AddLastLoginTimeColumnForStaffTable migrating
09:39:08.955 -------------------------------------------------------------------------------
09:39:08.956 [+] Beginning Transaction
09:39:08.958 [+] AlterTable staff
09:39:08.959 [+] CreateColumn staff last_login_at DateTime
09:39:08.962 [+] ExecuteSqlStatement update staff set last_login_at = convert(datetime, getutcdate()) where [status] in (1, 2)
09:39:08.968 [+] Committing Transaction
09:39:08.970 [+] 487: AddLastLoginTimeColumnForStaffTable migrated
09:39:08.971 -------------------------------------------------------------------------------
09:39:08.971 488: AddTeamIdColumnOnWorkRecordTable migrating
09:39:08.971 -------------------------------------------------------------------------------
09:39:08.972 [+] Beginning Transaction
09:39:08.974 [+] AlterTable work_records
09:39:08.975 [+] CreateColumn work_records team_id Int64
09:39:08.978 [+] Committing Transaction
09:39:08.980 [+] 488: AddTeamIdColumnOnWorkRecordTable migrated
09:39:08.982 -------------------------------------------------------------------------------
09:39:08.982 489: ChangeTableNameFromTeamAcrossOfficesToTeams migrating
09:39:08.982 -------------------------------------------------------------------------------
09:39:08.982 [+] Beginning Transaction
09:39:08.984 [+] RenameTable team_across_offices teams
09:39:08.989 [+] Committing Transaction
09:39:08.992 [+] 489: ChangeTableNameFromTeamAcrossOfficesToTeams migrated
09:39:08.996 -------------------------------------------------------------------------------
09:39:08.996 490: AddFeatureToggleForMyFilesEntry migrating
09:39:08.996 -------------------------------------------------------------------------------
09:39:08.996 [+] Beginning Transaction
09:39:08.996 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:08.997 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:08.997 [+] Committing Transaction
09:39:08.999 [+] 490: AddFeatureToggleForMyFilesEntry migrated
09:39:09.000 -------------------------------------------------------------------------------
09:39:09.000 491: AddIndexesForEngagementIdInWorkRecordsTable migrating
09:39:09.000 -------------------------------------------------------------------------------
09:39:09.000 [+] Beginning Transaction
09:39:09.017 [+] CreateIndex work_records (engagement_id)
09:39:09.020 [+] Committing Transaction
09:39:09.022 [+] 491: AddIndexesForEngagementIdInWorkRecordsTable migrated
09:39:09.023 -------------------------------------------------------------------------------
09:39:09.023 492: RemoveFeatureToggleEventStoreEngagement migrating
09:39:09.023 -------------------------------------------------------------------------------
09:39:09.024 [+] Beginning Transaction
09:39:09.026 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.028 [+] Committing Transaction
09:39:09.030 [+] 492: RemoveFeatureToggleEventStoreEngagement migrated
09:39:09.031 -------------------------------------------------------------------------------
09:39:09.031 493: AddWorkRecordIdIndexOnWorkRecordTaskAssignmentTable migrating
09:39:09.031 -------------------------------------------------------------------------------
09:39:09.032 [+] Beginning Transaction
09:39:09.033 [+] ExecuteSqlStatement declare @count int
09:39:09.034                 SELECT @count = count(*) 
09:39:09.034                     FROM sys.indexes 
09:39:09.034                     WHERE name='idx_work_record_task_assignments_work_record_id_include_responsibility_id' AND object_id = OBJECT_ID('work_record_task_assignments')
09:39:09.034 
09:39:09.034                 if (@count<=0)
09:39:09.035                 begin
09:39:09.035                     CREATE NONCLUSTERED INDEX [idx_work_record_task_assignments_work_record_id_include_responsibility_id]
09:39:09.035                     ON [dbo].[work_record_task_assignments] ([work_record_id])
09:39:09.035                     INCLUDE ([responsibility_id])
09:39:09.036                 end
09:39:09.042 [+] Committing Transaction
09:39:09.044 [+] 493: AddWorkRecordIdIndexOnWorkRecordTaskAssignmentTable migrated
09:39:09.045 -------------------------------------------------------------------------------
09:39:09.045 494: AddEngagementIdIndexOnWorkRecordIncludeWorkRecordIdAndResponsibleOfficeIdAndPrimaryServiceId migrating
09:39:09.045 -------------------------------------------------------------------------------
09:39:09.046 [+] Beginning Transaction
09:39:09.048 [+] ExecuteSqlStatement declare @count int
09:39:09.048                 SELECT @count = count(*) 
09:39:09.048                 FROM sys.indexes 
09:39:09.048                 WHERE name='work_records_engagement_id' AND object_id = OBJECT_ID('work_records')
09:39:09.048                 
09:39:09.049                 if (@count>0)
09:39:09.049                 begin
09:39:09.049                 DROP INDEX work_records.work_records_engagement_id
09:39:09.049                 end
09:39:09.049 
09:39:09.049                 SELECT @count = count(*) 
09:39:09.049                 FROM sys.indexes 
09:39:09.049                 WHERE name='idx_work_records_engagement_id_include_responsible_office_id_primary_service_id' AND object_id = OBJECT_ID('work_records')
09:39:09.049                 
09:39:09.049                 if(@count<=0)
09:39:09.049                 begin
09:39:09.049                 CREATE NONCLUSTERED INDEX [idx_work_records_engagement_id_include_responsible_office_id_primary_service_id]
09:39:09.049                 ON [dbo].[work_records] ([engagement_id])
09:39:09.049                 INCLUDE ([id],[responsible_office_id],[primary_service_id])
09:39:09.049                 end
09:39:09.061 [+] Committing Transaction
09:39:09.062 [+] 494: AddEngagementIdIndexOnWorkRecordIncludeWorkRecordIdAndResponsibleOfficeIdAndPrimaryServiceId migrated
09:39:09.063 -------------------------------------------------------------------------------
09:39:09.063 495: MigrateWorkRecordTypeForAssigneeWorkRecordsTable migrating
09:39:09.063 -------------------------------------------------------------------------------
09:39:09.063 [+] Beginning Transaction
09:39:09.064 [+] ExecuteSqlStatement UPDATE awr
09:39:09.064 SET type = 1
09:39:09.064 FROM assignee_work_records awr
09:39:09.064 where awr.practice_type = 0;
09:39:09.065 [+] ExecuteSqlStatement UPDATE awr
09:39:09.065 SET type = 2
09:39:09.065 FROM assignee_work_records awr
09:39:09.065 where awr.practice_type = 1;
09:39:09.065 [+] ExecuteSqlStatement UPDATE awr
09:39:09.065 SET type = 3
09:39:09.065 FROM assignee_work_records awr
09:39:09.066 where awr.practice_type = 2;
09:39:09.067 [+] ExecuteSqlStatement UPDATE awr
09:39:09.067 SET type = 0
09:39:09.067 FROM assignee_work_records awr
09:39:09.067 INNER JOIN organizers o on
09:39:09.067 awr.[work_record_id] = o.[work_record_id]
09:39:09.067 where awr.practice_type = 0
09:39:09.068 [+] Committing Transaction
09:39:09.069 [+] 495: MigrateWorkRecordTypeForAssigneeWorkRecordsTable migrated
09:39:09.069 -------------------------------------------------------------------------------
09:39:09.069 496: AddDateRequestedColumnToAssigneeWorkRecordsTable migrating
09:39:09.069 -------------------------------------------------------------------------------
09:39:09.070 [+] Beginning Transaction
09:39:09.070 [+] AlterTable assignee_work_records
09:39:09.071 [+] CreateColumn assignee_work_records date_requested DateTime
09:39:09.072 [+] Committing Transaction
09:39:09.073 [+] 496: AddDateRequestedColumnToAssigneeWorkRecordsTable migrated
09:39:09.073 -------------------------------------------------------------------------------
09:39:09.074 497: AddWorkRecordGroupColumnToTaskTemplate migrating
09:39:09.074 -------------------------------------------------------------------------------
09:39:09.074 [+] Beginning Transaction
09:39:09.074 [+] AlterTable task_templates
09:39:09.075 [+] CreateColumn task_templates work_record_group Int16
09:39:09.076 [+] ExecuteSqlStatement update task_templates set work_record_group = work_record_type
09:39:09.078 [+] Committing Transaction
09:39:09.078 [+] 497: AddWorkRecordGroupColumnToTaskTemplate migrated
09:39:09.078 -------------------------------------------------------------------------------
09:39:09.078 498: MigrateWorkRecordTypeToWorkRecordGroupToTaskTemplate migrating
09:39:09.078 -------------------------------------------------------------------------------
09:39:09.078 [+] Beginning Transaction
09:39:09.079 [+] ExecuteSqlStatement update task_templates set work_record_type = 0 where practice_type = 0 and work_record_group = 0
09:39:09.086 [+] ExecuteSqlStatement update task_templates set work_record_type = 2 where practice_type = 1 and work_record_group = 0
09:39:09.087 [+] ExecuteSqlStatement update task_templates set work_record_type = 3 where practice_type = 2 and work_record_group = 0
09:39:09.088 [+] ExecuteSqlStatement update task_templates set work_record_type = 0 where practice_type = 0 and work_record_group = 1
09:39:09.091 [+] Committing Transaction
09:39:09.093 [+] 498: MigrateWorkRecordTypeToWorkRecordGroupToTaskTemplate migrated
09:39:09.094 -------------------------------------------------------------------------------
09:39:09.094 499: AddDefaultBriefingWorkRecordTaskTemplates migrating
09:39:09.095 -------------------------------------------------------------------------------
09:39:09.095 [+] Beginning Transaction
09:39:09.097 [+] ExecuteSqlStatement declare @id int;
09:39:09.097   insert into [task_templates] (name, owned_by, engagement_id, is_default, practice_type, is_mandatory, work_record_type, work_record_group) 
09:39:09.097   values('DEFAULT_BRIEFING_TASK_TEMPLATE', 0, Null, 1, 0, 0, 4, 0);
09:39:09.098   set @id = SCOPE_IDENTITY();
09:39:09.098   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Notify',0,@id,10,1,0);
09:39:09.098   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Schedule',0,@id,20,1,0);
09:39:09.098   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Complete',0,@id,30,1,0);
09:39:09.099   insert into task_definitions (name,task_index,task_template_id,milestone,is_default,is_retired) values('Post Work',0,@id,40,1,0);
09:39:09.099         
09:39:09.111 [+] Committing Transaction
09:39:09.112 [+] 499: AddDefaultBriefingWorkRecordTaskTemplates migrated
09:39:09.112 -------------------------------------------------------------------------------
09:39:09.112 500: AddSenderNameColumnOnMissingItemsMailsTable migrating
09:39:09.112 -------------------------------------------------------------------------------
09:39:09.112 [+] Beginning Transaction
09:39:09.113 [+] AlterTable missing_items_mails
09:39:09.113 [+] CreateColumn missing_items_mails sender_name String
09:39:09.116 [+] Committing Transaction
09:39:09.118 [+] 500: AddSenderNameColumnOnMissingItemsMailsTable migrated
09:39:09.119 -------------------------------------------------------------------------------
09:39:09.119 501: RemoveFeatureToggleTeams migrating
09:39:09.119 -------------------------------------------------------------------------------
09:39:09.119 [+] Beginning Transaction
09:39:09.120 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.123 [+] Committing Transaction
09:39:09.124 [+] 501: RemoveFeatureToggleTeams migrated
09:39:09.126 -------------------------------------------------------------------------------
09:39:09.126 502: AddFeatureToggleForBriefingWorkRecord migrating
09:39:09.126 -------------------------------------------------------------------------------
09:39:09.127 [+] Beginning Transaction
09:39:09.129 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:09.130 [+] Committing Transaction
09:39:09.132 [+] 502: AddFeatureToggleForBriefingWorkRecord migrated
09:39:09.133 -------------------------------------------------------------------------------
09:39:09.134 503: RemoveFeatureToggleTeq migrating
09:39:09.134 -------------------------------------------------------------------------------
09:39:09.134 [+] Beginning Transaction
09:39:09.136 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.138 [+] Committing Transaction
09:39:09.140 [+] 503: RemoveFeatureToggleTeq migrated
09:39:09.142 -------------------------------------------------------------------------------
09:39:09.142 504: RemoveFeatureToggleEventStoreStaff migrating
09:39:09.142 -------------------------------------------------------------------------------
09:39:09.142 [+] Beginning Transaction
09:39:09.144 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.146 [+] Committing Transaction
09:39:09.149 [+] 504: RemoveFeatureToggleEventStoreStaff migrated
09:39:09.150 -------------------------------------------------------------------------------
09:39:09.150 505: AddColumnScheduledDateTimeAndContactNumberToAssigneeWorkRecordTable migrating
09:39:09.150 -------------------------------------------------------------------------------
09:39:09.151 [+] Beginning Transaction
09:39:09.153 [+] AlterTable assignee_work_records
09:39:09.154 [+] CreateColumn assignee_work_records scheduled_date_time DateTime
09:39:09.157 [+] AlterTable assignee_work_records
09:39:09.158 [+] CreateColumn assignee_work_records contact_number String
09:39:09.161 [+] Committing Transaction
09:39:09.163 [+] 505: AddColumnScheduledDateTimeAndContactNumberToAssigneeWorkRecordTable migrated
09:39:09.164 -------------------------------------------------------------------------------
09:39:09.165 506: AddFeatureToggleForEventStoreClient migrating
09:39:09.165 -------------------------------------------------------------------------------
09:39:09.165 [+] Beginning Transaction
09:39:09.168 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:09.169 [+] Committing Transaction
09:39:09.172 [+] 506: AddFeatureToggleForEventStoreClient migrated
09:39:09.173 -------------------------------------------------------------------------------
09:39:09.173 507: AddColumnsForOnLineBriefingToAssigneeWorkRecordTable migrating
09:39:09.173 -------------------------------------------------------------------------------
09:39:09.174 [+] Beginning Transaction
09:39:09.176 [+] AlterTable assignee_work_records
09:39:09.177 [+] CreateColumn assignee_work_records scheduling_method Int32
09:39:09.187 [+] AlterTable assignee_work_records
09:39:09.189 [+] CreateColumn assignee_work_records briefing_staff_id Int64
09:39:09.192 [+] ExecuteSqlStatement update assignee_work_records set scheduling_method = 1 where [type] = 4
09:39:09.197 [+] Committing Transaction
09:39:09.199 [+] 507: AddColumnsForOnLineBriefingToAssigneeWorkRecordTable migrated
09:39:09.200 -------------------------------------------------------------------------------
09:39:09.201 508: AddIsAutoCompletedToTaskAssignments migrating
09:39:09.201 -------------------------------------------------------------------------------
09:39:09.201 [+] Beginning Transaction
09:39:09.202 [+] AlterTable work_record_task_assignments
09:39:09.203 [+] CreateColumn work_record_task_assignments is_auto_completed Boolean
09:39:09.208 [+] Committing Transaction
09:39:09.210 [+] 508: AddIsAutoCompletedToTaskAssignments migrated
09:39:09.211 -------------------------------------------------------------------------------
09:39:09.211 509: AddOnlineSchedulerEnabledToOfficesTable migrating
09:39:09.211 -------------------------------------------------------------------------------
09:39:09.212 [+] Beginning Transaction
09:39:09.214 [+] AlterTable offices
09:39:09.215 [+] CreateColumn offices online_scheduler_enabled Boolean
09:39:09.219 [+] Committing Transaction
09:39:09.221 [+] 509: AddOnlineSchedulerEnabledToOfficesTable migrated
09:39:09.223 -------------------------------------------------------------------------------
09:39:09.223 510: AddSchedulesTable migrating
09:39:09.223 -------------------------------------------------------------------------------
09:39:09.224 [+] Beginning Transaction
09:39:09.226 [+] CreateTable schedulers
09:39:09.230 [+] Committing Transaction
09:39:09.233 [+] 510: AddSchedulesTable migrated
09:39:09.234 -------------------------------------------------------------------------------
09:39:09.235 511: AddFeatureToggleForOnlineScheduler migrating
09:39:09.235 -------------------------------------------------------------------------------
09:39:09.235 [+] Beginning Transaction
09:39:09.237 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.240 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:09.242 [+] Committing Transaction
09:39:09.244 [+] 511: AddFeatureToggleForOnlineScheduler migrated
09:39:09.248 -------------------------------------------------------------------------------
09:39:09.249 512: AddSchedulerIdColumnToOfficeTable migrating
09:39:09.249 -------------------------------------------------------------------------------
09:39:09.252 [+] Beginning Transaction
09:39:09.254 [+] AlterTable offices
09:39:09.256 [+] CreateColumn offices scheduler_id Int64
09:39:09.260 [+] Committing Transaction
09:39:09.262 [+] 512: AddSchedulerIdColumnToOfficeTable migrated
09:39:09.264 -------------------------------------------------------------------------------
09:39:09.264 513: AddWorkDaysColumnToSchedulerTable migrating
09:39:09.264 -------------------------------------------------------------------------------
09:39:09.265 [+] Beginning Transaction
09:39:09.267 [+] AlterTable schedulers
09:39:09.268 [+] CreateColumn schedulers work_days Int16
09:39:09.273 [+] Committing Transaction
09:39:09.275 [+] 513: AddWorkDaysColumnToSchedulerTable migrated
09:39:09.277 -------------------------------------------------------------------------------
09:39:09.277 514: AddWorkHoursColumnToSchedulerTable migrating
09:39:09.277 -------------------------------------------------------------------------------
09:39:09.278 [+] Beginning Transaction
09:39:09.280 [+] AlterTable schedulers
09:39:09.281 [+] CreateColumn schedulers work_hours String
09:39:09.285 [+] Committing Transaction
09:39:09.286 [+] 514: AddWorkHoursColumnToSchedulerTable migrated
09:39:09.288 -------------------------------------------------------------------------------
09:39:09.288 515: AddTimeZoneColumnToSchedulerTable migrating
09:39:09.288 -------------------------------------------------------------------------------
09:39:09.289 [+] Beginning Transaction
09:39:09.291 [+] AlterTable schedulers
09:39:09.292 [+] CreateColumn schedulers time_zone String
09:39:09.297 [+] Committing Transaction
09:39:09.299 [+] 515: AddTimeZoneColumnToSchedulerTable migrated
09:39:09.301 -------------------------------------------------------------------------------
09:39:09.301 516: AddSchedulerEventsTable migrating
09:39:09.301 -------------------------------------------------------------------------------
09:39:09.302 [+] Beginning Transaction
09:39:09.304 [+] CreateTable scheduler_events
09:39:09.309 [+] Committing Transaction
09:39:09.318 [+] 516: AddSchedulerEventsTable migrated
09:39:09.321 -------------------------------------------------------------------------------
09:39:09.321 517: AddSchedulerResourceNumbersTable migrating
09:39:09.321 -------------------------------------------------------------------------------
09:39:09.322 [+] Beginning Transaction
09:39:09.324 [+] CreateTable scheduler_resource_numbers
09:39:09.328 [+] CreateIndex scheduler_resource_numbers (scheduler_id)
09:39:09.331 [+] Committing Transaction
09:39:09.334 [+] 517: AddSchedulerResourceNumbersTable migrated
09:39:09.335 -------------------------------------------------------------------------------
09:39:09.335 518: AddTypeToSchedulersTable migrating
09:39:09.335 -------------------------------------------------------------------------------
09:39:09.336 [+] Beginning Transaction
09:39:09.338 [+] AlterTable schedulers
09:39:09.339 [+] CreateColumn schedulers type Int16
09:39:09.343 [+] Committing Transaction
09:39:09.345 [+] 518: AddTypeToSchedulersTable migrated
09:39:09.346 -------------------------------------------------------------------------------
09:39:09.346 519: RemoveTypeFromSchedulersTable migrating
09:39:09.347 -------------------------------------------------------------------------------
09:39:09.347 [+] Beginning Transaction
09:39:09.349 [+] DeleteColumn schedulers type
09:39:09.363 [+] Committing Transaction
09:39:09.364 [+] 519: RemoveTypeFromSchedulersTable migrated
09:39:09.365 -------------------------------------------------------------------------------
09:39:09.365 520: AddHasPromptForLinkedInToStaffTable migrating
09:39:09.365 -------------------------------------------------------------------------------
09:39:09.365 [+] Beginning Transaction
09:39:09.366 [+] AlterTable staff
09:39:09.366 [+] CreateColumn staff need_prompt_for_linkedin Boolean
09:39:09.368 [+] Committing Transaction
09:39:09.369 [+] 520: AddHasPromptForLinkedInToStaffTable migrated
09:39:09.369 -------------------------------------------------------------------------------
09:39:09.369 521: AddFeatureToggleForConnectLinkedIn migrating
09:39:09.369 -------------------------------------------------------------------------------
09:39:09.369 [+] Beginning Transaction
09:39:09.369 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.370 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:09.370 [+] Committing Transaction
09:39:09.371 [+] 521: AddFeatureToggleForConnectLinkedIn migrated
09:39:09.372 -------------------------------------------------------------------------------
09:39:09.372 522: AddStaffLinkedinProfilesTable migrating
09:39:09.372 -------------------------------------------------------------------------------
09:39:09.372 [+] Beginning Transaction
09:39:09.373 [+] ExecuteSqlStatement CREATE TABLE staff_linkedin_profiles (
09:39:09.373                           [id] bigint IDENTITY(1,1) primary key,
09:39:09.373                           [staff_id] bigint NOT NULL,
09:39:09.373 	                      [photo_content] image,
09:39:09.373 	                      [profile_url] varchar(255) NOT NULL)
09:39:09.374 [+] Committing Transaction
09:39:09.375 [+] 522: AddStaffLinkedinProfilesTable migrated
09:39:09.376 -------------------------------------------------------------------------------
09:39:09.376 523: ChangeColumnBodyTypeOnSchedulersTable migrating
09:39:09.376 -------------------------------------------------------------------------------
09:39:09.376 [+] Beginning Transaction
09:39:09.377 [+] AlterColumn scheduler_events body String
09:39:09.378 [+] Committing Transaction
09:39:09.379 [+] 523: ChangeColumnBodyTypeOnSchedulersTable migrated
09:39:09.379 -------------------------------------------------------------------------------
09:39:09.379 524: AddColumnAssigneeTimeZoneOnAssigneeWorkRecordsTable migrating
09:39:09.380 -------------------------------------------------------------------------------
09:39:09.380 [+] Beginning Transaction
09:39:09.383 [+] AlterTable assignee_work_records
09:39:09.385 [+] CreateColumn assignee_work_records assignee_time_zone String
09:39:09.388 [+] Committing Transaction
09:39:09.389 [+] 524: AddColumnAssigneeTimeZoneOnAssigneeWorkRecordsTable migrated
09:39:09.390 -------------------------------------------------------------------------------
09:39:09.390 525: AddUniqueKeyOnEvaluationReminderTable migrating
09:39:09.390 -------------------------------------------------------------------------------
09:39:09.391 [+] Beginning Transaction
09:39:09.393 [+] ExecuteSqlStatement 
09:39:09.393                 ALTER TABLE evaluation_reminder
09:39:09.394                 ADD CONSTRAINT evaluation_reminder_unique UNIQUE NONCLUSTERED (evaluation_id, times)
09:39:09.394             
09:39:09.397 [+] Committing Transaction
09:39:09.399 [+] 525: AddUniqueKeyOnEvaluationReminderTable migrated
09:39:09.401 -------------------------------------------------------------------------------
09:39:09.401 526: AddSchedulingMethodColumnToEngagementsTable migrating
09:39:09.401 -------------------------------------------------------------------------------
09:39:09.402 [+] Beginning Transaction
09:39:09.404 [+] AlterTable engagements
09:39:09.405 [+] CreateColumn engagements scheduling_method Int16
09:39:09.410 [+] Committing Transaction
09:39:09.411 [+] 526: AddSchedulingMethodColumnToEngagementsTable migrated
09:39:09.412 -------------------------------------------------------------------------------
09:39:09.413 527: RemoveFeatureToggleServiceEvaluation migrating
09:39:09.413 -------------------------------------------------------------------------------
09:39:09.413 [+] Beginning Transaction
09:39:09.415 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.418 [+] Committing Transaction
09:39:09.420 [+] 527: RemoveFeatureToggleServiceEvaluation migrated
09:39:09.421 -------------------------------------------------------------------------------
09:39:09.422 528: AddColumnSecondaryStaffIdOnEngagementsTable migrating
09:39:09.422 -------------------------------------------------------------------------------
09:39:09.423 [+] Beginning Transaction
09:39:09.425 [+] AlterTable engagements
09:39:09.426 [+] CreateColumn engagements secondary_staff_id Int64
09:39:09.429 [+] Committing Transaction
09:39:09.431 [+] 528: AddColumnSecondaryStaffIdOnEngagementsTable migrated
09:39:09.432 -------------------------------------------------------------------------------
09:39:09.432 529: AddColumnSecondaryStaffIdOnEngagedOfficeStaffTable migrating
09:39:09.433 -------------------------------------------------------------------------------
09:39:09.433 [+] Beginning Transaction
09:39:09.435 [+] AlterTable engaged_office_staff
09:39:09.436 [+] CreateColumn engaged_office_staff secondary_staff_id Int64
09:39:09.440 [+] Committing Transaction
09:39:09.442 [+] 529: AddColumnSecondaryStaffIdOnEngagedOfficeStaffTable migrated
09:39:09.443 -------------------------------------------------------------------------------
09:39:09.443 530: AddEngagementSecondaryContactFeatureToggle migrating
09:39:09.443 -------------------------------------------------------------------------------
09:39:09.444 [+] Beginning Transaction
09:39:09.451 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:09.454 [+] Committing Transaction
09:39:09.456 [+] 530: AddEngagementSecondaryContactFeatureToggle migrated
09:39:09.457 -------------------------------------------------------------------------------
09:39:09.457 531: RemoveFeatureToggleEventStoreAssignee migrating
09:39:09.457 -------------------------------------------------------------------------------
09:39:09.458 [+] Beginning Transaction
09:39:09.460 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.462 [+] Committing Transaction
09:39:09.464 [+] 531: RemoveFeatureToggleEventStoreAssignee migrated
09:39:09.465 -------------------------------------------------------------------------------
09:39:09.465 532: AddSchedulersEngagementsTable migrating
09:39:09.465 -------------------------------------------------------------------------------
09:39:09.466 [+] Beginning Transaction
09:39:09.468 [+] CreateTable schedulers_engagements
09:39:09.471 [+] ExecuteSqlStatement ALTER TABLE schedulers_engagements ADD CONSTRAINT PK_schedulers_engagements PRIMARY KEY CLUSTERED (scheduler_id,engagement_id) WITH( STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
09:39:09.477 [+] Committing Transaction
09:39:09.479 [+] 532: AddSchedulersEngagementsTable migrated
09:39:09.480 -------------------------------------------------------------------------------
09:39:09.480 533: AddCommentsColumnToWorkRecordTeqTable migrating
09:39:09.480 -------------------------------------------------------------------------------
09:39:09.481 [+] Beginning Transaction
09:39:09.483 [+] AlterTable work_record_teq
09:39:09.484 [+] CreateColumn work_record_teq comments String
09:39:09.488 [+] Committing Transaction
09:39:09.490 [+] 533: AddCommentsColumnToWorkRecordTeqTable migrated
09:39:09.491 -------------------------------------------------------------------------------
09:39:09.492 534: AddSchedulerIdAndStartFromIndexToSchedulerEventsTable migrating
09:39:09.492 -------------------------------------------------------------------------------
09:39:09.492 [+] Beginning Transaction
09:39:09.493 [+] CreateIndex scheduler_events (scheduler_id)
09:39:09.496 [+] CreateIndex scheduler_events (start_from)
09:39:09.499 [+] Committing Transaction
09:39:09.501 [+] 534: AddSchedulerIdAndStartFromIndexToSchedulerEventsTable migrated
09:39:09.502 -------------------------------------------------------------------------------
09:39:09.502 535: AddOfficeIdAndTypeToSchedulerTable migrating
09:39:09.502 -------------------------------------------------------------------------------
09:39:09.503 [+] Beginning Transaction
09:39:09.505 [+] AlterTable schedulers
09:39:09.506 [+] CreateColumn schedulers office_id Int64
09:39:09.509 [+] AlterTable schedulers
09:39:09.515 [+] CreateColumn schedulers type Int32
09:39:09.521 [+] Committing Transaction
09:39:09.523 [+] 535: AddOfficeIdAndTypeToSchedulerTable migrated
09:39:09.525 -------------------------------------------------------------------------------
09:39:09.525 536: StoreSchedulerOfficeRelationInSchedulerTable migrating
09:39:09.525 -------------------------------------------------------------------------------
09:39:09.525 [+] Beginning Transaction
09:39:09.527 [+] ExecuteSqlStatement update schedulers set schedulers.office_id = offices.id,
09:39:09.527                           schedulers.type = 0
09:39:09.527                           from schedulers join offices on offices.scheduler_id = schedulers.id
09:39:09.537 [+] AlterColumn schedulers office_id Int64
09:39:09.542 [+] DeleteColumn offices scheduler_id
09:39:09.562 [+] Committing Transaction
09:39:09.564 [+] 536: StoreSchedulerOfficeRelationInSchedulerTable migrated
09:39:09.566 -------------------------------------------------------------------------------
09:39:09.566 537: AddColumnsShowInMyTeamEngagementsTable migrating
09:39:09.566 -------------------------------------------------------------------------------
09:39:09.566 [+] Beginning Transaction
09:39:09.568 [+] AlterTable engagements
09:39:09.569 [+] CreateColumn engagements primary_contact_in_my_team_enabled Boolean
09:39:09.589 [+] AlterTable engagements
09:39:09.589 [+] CreateColumn engagements secondary_contact_in_my_team_enabled Boolean
09:39:09.589 [+] Committing Transaction
09:39:09.589 [+] 537: AddColumnsShowInMyTeamEngagementsTable migrated
09:39:09.590 -------------------------------------------------------------------------------
09:39:09.590 538: AddColumnsShowInMyTeamOnEngagedOfficeStaffTable migrating
09:39:09.590 -------------------------------------------------------------------------------
09:39:09.590 [+] Beginning Transaction
09:39:09.591 [+] AlterTable engaged_office_staff
09:39:09.591 [+] CreateColumn engaged_office_staff primary_contact_in_my_team_enabled Boolean
09:39:09.593 [+] AlterTable engaged_office_staff
09:39:09.593 [+] CreateColumn engaged_office_staff secondary_contact_in_my_team_enabled Boolean
09:39:09.595 [+] Committing Transaction
09:39:09.596 [+] 538: AddColumnsShowInMyTeamOnEngagedOfficeStaffTable migrated
09:39:09.596 -------------------------------------------------------------------------------
09:39:09.596 539: UpdatePrimaryContactShowInMyTeamInEngagedOfficeStaffTable migrating
09:39:09.596 -------------------------------------------------------------------------------
09:39:09.597 [+] Beginning Transaction
09:39:09.597 [+] ExecuteSqlStatement update engaged_office_staff
09:39:09.597  set engaged_office_staff.primary_contact_in_my_team_enabled = 0
09:39:09.597  where engaged_office_id in (select id from engaged_offices where role = 'DelegatedCoordinatingOffice')
09:39:09.601 [+] Committing Transaction
09:39:09.602 [+] 539: UpdatePrimaryContactShowInMyTeamInEngagedOfficeStaffTable migrated
09:39:09.603 -------------------------------------------------------------------------------
09:39:09.603 540: SchedulerAppointmentTable migrating
09:39:09.603 -------------------------------------------------------------------------------
09:39:09.603 [+] Beginning Transaction
09:39:09.604 [+] CreateTable scheduler_appointment
09:39:09.606 [+] Committing Transaction
09:39:09.607 [+] 540: SchedulerAppointmentTable migrated
09:39:09.607 -------------------------------------------------------------------------------
09:39:09.607 541: MigrateWorkRecordFromStoreEventToSchedulerAppointmentTable migrating
09:39:09.607 -------------------------------------------------------------------------------
09:39:09.607 [+] Beginning Transaction
09:39:09.608 [+] ExecuteSqlStatement declare @count int
09:39:09.608                 SELECT @count = count(*) 
09:39:09.608                                 FROM scheduler_events
09:39:09.608                 if (@count>0)
09:39:09.608                 begin
09:39:09.608 	                INSERT INTO scheduler_appointment (
09:39:09.608 		                scheduler_id
09:39:09.608 		                ,work_record_id
09:39:09.608 		                ,scheduled_date_time_utc
09:39:09.609 		                ,assignee_timezone
09:39:09.609 		                ,contact_number)
09:39:09.609 		                SELECT scheduler_id
09:39:09.609 		                ,distinct_workrecord_events.work_record_id
09:39:09.609 		                ,scheduled_date_time
09:39:09.609 		                ,assignee_time_zone
09:39:09.609 		                ,contact_number FROM (
09:39:09.609 		                SELECT *
09:39:09.609 		                FROM (
09:39:09.609 			                SELECT scheduler_events_work_record.scheduler_id
09:39:09.609 				                ,scheduler_events_work_record.work_record_id
09:39:09.609 				                ,scheduler_events_work_record.occured_at
09:39:09.609 				                ,ROW_NUMBER() OVER (
09:39:09.609 					                PARTITION BY scheduler_events_work_record.work_record_id ORDER BY scheduler_events_work_record.occured_at DESC
09:39:09.609 					                ) AS work_record_row
09:39:09.609 			                FROM (
09:39:09.609 				                SELECT occured_at,
09:39:09.609 				                       scheduler_id,
09:39:09.610 				                       CAST(SUBSTRING(body, PATINDEX('%WorkRecordId%', body) + len('WorkRecordId') + 2, PATINDEX('%SchedulerId%', body) - PATINDEX('%WorkRecordId%', body) - len('WorkRecordId') - 4) AS INT) AS work_record_id
09:39:09.610 				                FROM scheduler_events
09:39:09.610 				                ) scheduler_events_work_record
09:39:09.610 			                ) grouped_events
09:39:09.610 		                WHERE grouped_events.work_record_row = 1
09:39:09.610 		                ) distinct_workrecord_events INNER JOIN assignee_work_records work_record ON distinct_workrecord_events.work_record_id = work_record.work_record_id
09:39:09.610                 end 
09:39:09.610          
09:39:09.614 [+] Committing Transaction
09:39:09.615 [+] 541: MigrateWorkRecordFromStoreEventToSchedulerAppointmentTable migrated
09:39:09.615 -------------------------------------------------------------------------------
09:39:09.615 542: AddFeatureToggleForEngagementAcrossClients migrating
09:39:09.615 -------------------------------------------------------------------------------
09:39:09.615 [+] Beginning Transaction
09:39:09.616 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.617 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:09.618 [+] Committing Transaction
09:39:09.618 [+] 542: AddFeatureToggleForEngagementAcrossClients migrated
09:39:09.618 -------------------------------------------------------------------------------
09:39:09.618 543: AddAssigneeEmployeeIdTable migrating
09:39:09.618 -------------------------------------------------------------------------------
09:39:09.618 [+] Beginning Transaction
09:39:09.619 [+] CreateTable assignee_employee_id
09:39:09.621 [+] CreateForeignKey fk_assignee_employee_id_ref_assignees assignee_employee_id(assignee_id) assignees(id)
09:39:09.622 [+] CreateForeignKey fk_assignee_employee_id_ref_clients assignee_employee_id(client_id) clients(id)
09:39:09.624 [+] Committing Transaction
09:39:09.624 [+] 543: AddAssigneeEmployeeIdTable migrated
09:39:09.625 -------------------------------------------------------------------------------
09:39:09.625 544: CreateIdsToTableVariableUserDefinedFunction migrating
09:39:09.625 -------------------------------------------------------------------------------
09:39:09.625 [+] Beginning Transaction
09:39:09.626 [+] ExecuteSqlStatement create function [dbo].[idsToTableVariable](@xml xml)
09:39:09.626                     returns @result table(Id bigint primary key)
09:39:09.626                     as
09:39:09.626                     begin
09:39:09.626 	                    insert into @result(Id)
09:39:09.626 	                    select list.Id.value('(text())[1]', 'bigint')
09:39:09.626 	                    from @xml.nodes('//long') as list(Id)
09:39:09.626 	                    option (optimize for (@xml = NULL))
09:39:09.627 	                    return 
09:39:09.627                     end
09:39:09.627          
09:39:09.631 [+] Committing Transaction
09:39:09.632 [+] 544: CreateIdsToTableVariableUserDefinedFunction migrated
09:39:09.633 -------------------------------------------------------------------------------
09:39:09.633 545: AddFeatureToggleEventStoreTigerSearchIIEvent migrating
09:39:09.633 -------------------------------------------------------------------------------
09:39:09.633 [+] Beginning Transaction
09:39:09.634 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:09.635 [+] Committing Transaction
09:39:09.636 [+] 545: AddFeatureToggleEventStoreTigerSearchIIEvent migrated
09:39:09.636 -------------------------------------------------------------------------------
09:39:09.636 546: RemoveFeatureToggleEventStoreTigerSearchIIEvent migrating
09:39:09.636 -------------------------------------------------------------------------------
09:39:09.636 [+] Beginning Transaction
09:39:09.637 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.638 [+] Committing Transaction
09:39:09.639 [+] 546: RemoveFeatureToggleEventStoreTigerSearchIIEvent migrated
09:39:09.639 -------------------------------------------------------------------------------
09:39:09.639 547: AlterAssigneeEmployeeIdTableNameToClientAssociation migrating
09:39:09.640 -------------------------------------------------------------------------------
09:39:09.640 [+] Beginning Transaction
09:39:09.643 [+] DeleteTable assignee_employee_id
09:39:09.645 [+] CreateTable assignee_client_association
09:39:09.647 [+] CreateIndex assignee_client_association (assignee_id)
09:39:09.648 [+] Committing Transaction
09:39:09.649 [+] 547: AlterAssigneeEmployeeIdTableNameToClientAssociation migrated
09:39:09.649 -------------------------------------------------------------------------------
09:39:09.649 548: MigrateAssigneeClientToClientAssociationTable migrating
09:39:09.650 -------------------------------------------------------------------------------
09:39:09.650 [+] Beginning Transaction
09:39:09.650 [+] ExecuteSqlStatement INSERT INTO assignee_client_association (
09:39:09.650 		                assignee_id
09:39:09.650 		                ,employee_id
09:39:09.650 		                ,client_id)
09:39:09.651 		                SELECT id,'',client_id FROM assignees
09:39:09.652 [+] Committing Transaction
09:39:09.653 [+] 548: MigrateAssigneeClientToClientAssociationTable migrated
09:39:09.654 -------------------------------------------------------------------------------
09:39:09.654 549: AddMasterChartOfServiceTable migrating
09:39:09.654 -------------------------------------------------------------------------------
09:39:09.655 [+] Beginning Transaction
09:39:09.656 [+] CreateTable master_chart_of_service
09:39:09.658 [+] Committing Transaction
09:39:09.659 [+] 549: AddMasterChartOfServiceTable migrated
09:39:09.660 -------------------------------------------------------------------------------
09:39:09.660 550: InsertValueForMasterChartOfServiceTable migrating
09:39:09.660 -------------------------------------------------------------------------------
09:39:09.660 [+] Beginning Transaction
09:39:09.662 [+] -> 3 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0003255
09:39:09.663 [+] Committing Transaction
09:39:09.664 [+] 550: InsertValueForMasterChartOfServiceTable migrated
09:39:09.664 -------------------------------------------------------------------------------
09:39:09.664 551: AddMasterChartOfServiceColumnToTypesOfServiceTable migrating
09:39:09.664 -------------------------------------------------------------------------------
09:39:09.664 [+] Beginning Transaction
09:39:09.665 [+] AlterTable types_of_service
09:39:09.666 [+] CreateColumn types_of_service master_chart_of_service_id Int16
09:39:09.667 [+] Committing Transaction
09:39:09.668 [+] 551: AddMasterChartOfServiceColumnToTypesOfServiceTable migrated
09:39:09.668 -------------------------------------------------------------------------------
09:39:09.668 552: MigrateMasterChartOfServiceForTypesOfServiceTable migrating
09:39:09.668 -------------------------------------------------------------------------------
09:39:09.669 [+] Beginning Transaction
09:39:09.669 [+] ExecuteSqlStatement update types_of_service set master_chart_of_service_id = 1 where practice_type = 0
09:39:09.673 [+] ExecuteSqlStatement update types_of_service set master_chart_of_service_id = 2 where practice_type = 1
09:39:09.674 [+] ExecuteSqlStatement update types_of_service set master_chart_of_service_id = 3 where practice_type = 2
09:39:09.675 [+] Committing Transaction
09:39:09.677 [+] 552: MigrateMasterChartOfServiceForTypesOfServiceTable migrated
09:39:09.677 -------------------------------------------------------------------------------
09:39:09.678 553: AddColumnEffectiveDateOnAssigneeClientAssociationTable migrating
09:39:09.678 -------------------------------------------------------------------------------
09:39:09.678 [+] Beginning Transaction
09:39:09.679 [+] AlterTable assignee_client_association
09:39:09.680 [+] CreateColumn assignee_client_association effective_date DateTime
09:39:09.682 [+] Committing Transaction
09:39:09.684 [+] 553: AddColumnEffectiveDateOnAssigneeClientAssociationTable migrated
09:39:09.685 -------------------------------------------------------------------------------
09:39:09.686 554: AddColumnsFirstReminderAndFinalReminderOnAssigneeWorkRecordsTable migrating
09:39:09.686 -------------------------------------------------------------------------------
09:39:09.686 [+] Beginning Transaction
09:39:09.688 [+] AlterTable assignee_work_records
09:39:09.689 [+] CreateColumn assignee_work_records first_reminder DateTime
09:39:09.691 [+] AlterTable assignee_work_records
09:39:09.693 [+] CreateColumn assignee_work_records final_reminder DateTime
09:39:09.695 [+] Committing Transaction
09:39:09.697 [+] 554: AddColumnsFirstReminderAndFinalReminderOnAssigneeWorkRecordsTable migrated
09:39:09.699 -------------------------------------------------------------------------------
09:39:09.699 555: AddUpcomingNotifyStatusInAssigneeWorkRecordTable migrating
09:39:09.699 -------------------------------------------------------------------------------
09:39:09.700 [+] Beginning Transaction
09:39:09.701 [+] AlterTable assignee_work_records
09:39:09.702 [+] CreateColumn assignee_work_records upcoming_notify_status Boolean
09:39:09.714 [+] Committing Transaction
09:39:09.715 [+] 555: AddUpcomingNotifyStatusInAssigneeWorkRecordTable migrated
09:39:09.717 -------------------------------------------------------------------------------
09:39:09.717 556: AllowClientIdNullableOnAssigneeClientAssociationTable migrating
09:39:09.717 -------------------------------------------------------------------------------
09:39:09.718 [+] Beginning Transaction
09:39:09.719 [+] AlterColumn assignee_client_association client_id Int64
09:39:09.723 [+] Committing Transaction
09:39:09.725 [+] 556: AllowClientIdNullableOnAssigneeClientAssociationTable migrated
09:39:09.727 -------------------------------------------------------------------------------
09:39:09.727 557: AddFeatureToggleEventStoreBriefingWorkRecord migrating
09:39:09.727 -------------------------------------------------------------------------------
09:39:09.727 [+] Beginning Transaction
09:39:09.730 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:09.732 [+] Committing Transaction
09:39:09.734 [+] 557: AddFeatureToggleEventStoreBriefingWorkRecord migrated
09:39:09.735 -------------------------------------------------------------------------------
09:39:09.735 558: RemoveIdsToTableVariableUserDefinedFunction migrating
09:39:09.735 -------------------------------------------------------------------------------
09:39:09.736 [+] Beginning Transaction
09:39:09.738 [+] ExecuteSqlStatement drop function [dbo].[idsToTableVariable]
09:39:09.742 [+] Committing Transaction
09:39:09.743 [+] 558: RemoveIdsToTableVariableUserDefinedFunction migrated
09:39:09.744 -------------------------------------------------------------------------------
09:39:09.744 559: RemoveFeatureToggleEmailHistory migrating
09:39:09.744 -------------------------------------------------------------------------------
09:39:09.745 [+] Beginning Transaction
09:39:09.747 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.749 [+] Committing Transaction
09:39:09.751 [+] 559: RemoveFeatureToggleEmailHistory migrated
09:39:09.753 -------------------------------------------------------------------------------
09:39:09.753 560: AddAssigneeAssignmentCustomFieldsValueTable migrating
09:39:09.753 -------------------------------------------------------------------------------
09:39:09.754 [+] Beginning Transaction
09:39:09.756 [+] CreateTable assignee_assignment_custom_fields_value
09:39:09.760 [+] CreateForeignKey fk_assignee_assignment_custom_fields_value_ref_assignments assignee_assignment_custom_fields_value(assignment_id) assignments(id)
09:39:09.763 [+] CreateForeignKey fk_assignee_assignment_custom_fields_value_ref_custom_fields assignee_assignment_custom_fields_value(custom_field_id) custom_fields(id)
09:39:09.767 [+] Committing Transaction
09:39:09.769 [+] 560: AddAssigneeAssignmentCustomFieldsValueTable migrated
09:39:09.771 -------------------------------------------------------------------------------
09:39:09.771 561: RenameAssigneeCustomFieldsValueTable migrating
09:39:09.771 -------------------------------------------------------------------------------
09:39:09.778 [+] Beginning Transaction
09:39:09.781 [+] Committing Transaction
09:39:09.783 [+] 561: RenameAssigneeCustomFieldsValueTable migrated
09:39:09.784 -------------------------------------------------------------------------------
09:39:09.784 562: RemoveFeatureToggleToDoListPhaseII migrating
09:39:09.784 -------------------------------------------------------------------------------
09:39:09.785 [+] Beginning Transaction
09:39:09.787 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.789 [+] Committing Transaction
09:39:09.792 [+] 562: RemoveFeatureToggleToDoListPhaseII migrated
09:39:09.793 -------------------------------------------------------------------------------
09:39:09.793 563: AddIsCreatedByEngagementInEngagementCustomFieldsTable migrating
09:39:09.793 -------------------------------------------------------------------------------
09:39:09.794 [+] Beginning Transaction
09:39:09.796 [+] AlterTable engagement_custom_fields
09:39:09.797 [+] CreateColumn engagement_custom_fields is_created_by_engagement Boolean
09:39:09.802 [+] Committing Transaction
09:39:09.804 [+] 563: AddIsCreatedByEngagementInEngagementCustomFieldsTable migrated
09:39:09.806 -------------------------------------------------------------------------------
09:39:09.806 564: RemoveFeatureToggleFrontDoor migrating
09:39:09.806 -------------------------------------------------------------------------------
09:39:09.807 [+] Beginning Transaction
09:39:09.809 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.811 [+] Committing Transaction
09:39:09.813 [+] 564: RemoveFeatureToggleFrontDoor migrated
09:39:09.815 -------------------------------------------------------------------------------
09:39:09.815 565: RemoveFeatureToggleMissingItem migrating
09:39:09.815 -------------------------------------------------------------------------------
09:39:09.815 [+] Beginning Transaction
09:39:09.817 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.820 [+] Committing Transaction
09:39:09.822 [+] 565: RemoveFeatureToggleMissingItem migrated
09:39:09.824 -------------------------------------------------------------------------------
09:39:09.824 566: AddStartDateColumnToWorkRecordTable migrating
09:39:09.824 -------------------------------------------------------------------------------
09:39:09.825 [+] Beginning Transaction
09:39:09.826 [+] CreateColumn assignee_work_records start_date 
09:39:09.830 [+] Committing Transaction
09:39:09.832 [+] 566: AddStartDateColumnToWorkRecordTable migrated
09:39:09.834 -------------------------------------------------------------------------------
09:39:09.834 567: RenameLongCountryNames migrating
09:39:09.834 -------------------------------------------------------------------------------
09:39:09.835 [+] Beginning Transaction
09:39:09.843 [+] ExecuteSqlStatement update countries set name ='Bolivia' where abbreviation='BO'
09:39:09.843 update countries set name ='Brunei' where abbreviation='BN'
09:39:09.843 update countries set name ='DR Congo' where abbreviation='CD'
09:39:09.844 update countries set name ='Iran' where abbreviation='IR'
09:39:09.844 update countries set name ='South Korea' where abbreviation='KR'
09:39:09.844 update countries set name ='Laos' where abbreviation='LA'
09:39:09.844 update countries set name ='Libya' where abbreviation='LY'
09:39:09.844 update countries set name ='Macedonia' where abbreviation='MK'
09:39:09.844 update countries set name ='Moldova' where abbreviation='MD'
09:39:09.844 update countries set name ='Russia' where abbreviation='RU'
09:39:09.845 update countries set name ='Syria' where abbreviation='SY'
09:39:09.845 update countries set name ='Tanzania' where abbreviation='TZ'
09:39:09.845 update countries set name ='Venezuela' where abbreviation='VE'
09:39:09.850 [+] Committing Transaction
09:39:09.852 [+] 567: RenameLongCountryNames migrated
09:39:09.854 -------------------------------------------------------------------------------
09:39:09.854 568: AddChecklistResponsibilityTable migrating
09:39:09.854 -------------------------------------------------------------------------------
09:39:09.855 [+] Beginning Transaction
09:39:09.857 [+] CreateTable checklist_responsibilities
09:39:09.862 [+] Committing Transaction
09:39:09.864 [+] 568: AddChecklistResponsibilityTable migrated
09:39:09.865 -------------------------------------------------------------------------------
09:39:09.866 569: AddChecklistItemDefinitionIdToWorkRecordChecklistItemTable migrating
09:39:09.866 -------------------------------------------------------------------------------
09:39:09.866 [+] Beginning Transaction
09:39:09.867 [+] AlterTable work_record_checklist_items
09:39:09.869 [+] CreateColumn work_record_checklist_items checklist_item_definition_id Int64
09:39:09.873 [+] Committing Transaction
09:39:09.875 [+] 569: AddChecklistItemDefinitionIdToWorkRecordChecklistItemTable migrated
09:39:09.877 -------------------------------------------------------------------------------
09:39:09.877 570: MigrateDataFromWorkRecordChecklistItemsTableToChecklistResponsibilityTable migrating
09:39:09.877 -------------------------------------------------------------------------------
09:39:09.878 [+] Beginning Transaction
09:39:09.880 [+] ExecuteSqlStatement insert into checklist_responsibilities (checklist_item_id
09:39:09.880                         ,work_record_id
09:39:09.880                         ,responsible_office_id
09:39:09.880                         ,staff_id          
09:39:09.880                         ,tag_id) select 
09:39:09.880                         id                
09:39:09.880                         ,work_record_id 
09:39:09.881                         ,responsible_office_id
09:39:09.881                         ,responsibility_id
09:39:09.881                         ,team_id 
09:39:09.881                         from work_record_checklist_items
09:39:09.885 [+] Committing Transaction
09:39:09.887 [+] 570: MigrateDataFromWorkRecordChecklistItemsTableToChecklistResponsibilityTable migrated
09:39:09.888 -------------------------------------------------------------------------------
09:39:09.888 571: AddModifiedByInAssignmentsTable migrating
09:39:09.888 -------------------------------------------------------------------------------
09:39:09.889 [+] Beginning Transaction
09:39:09.891 [+] CreateColumn assignments start_date_modified_by String
09:39:09.894 [+] CreateColumn assignments expected_end_date_modified_by String
09:39:09.898 [+] CreateColumn assignments actual_end_date_modified_by String
09:39:09.905 [+] Committing Transaction
09:39:09.909 [+] 571: AddModifiedByInAssignmentsTable migrated
09:39:09.910 -------------------------------------------------------------------------------
09:39:09.910 572: RemoveTeamAcrossOfficeFeatureToggle migrating
09:39:09.911 -------------------------------------------------------------------------------
09:39:09.911 [+] Beginning Transaction
09:39:09.913 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.915 [+] Committing Transaction
09:39:09.917 [+] 572: RemoveTeamAcrossOfficeFeatureToggle migrated
09:39:09.918 -------------------------------------------------------------------------------
09:39:09.919 573: AddEngagementAssignmentTypesTable migrating
09:39:09.919 -------------------------------------------------------------------------------
09:39:09.919 [+] Beginning Transaction
09:39:09.921 [+] CreateTable engagement_assignment_types
09:39:09.924 [+] CreateForeignKey fk_engagement_assignment_types_ref_engagements engagement_assignment_types(engagement_id) engagements(id)
09:39:09.928 [+] Committing Transaction
09:39:09.930 [+] 573: AddEngagementAssignmentTypesTable migrated
09:39:09.931 -------------------------------------------------------------------------------
09:39:09.932 574: AddColumnEngagementAssignmentTypeIdOnAssignmentTable migrating
09:39:09.932 -------------------------------------------------------------------------------
09:39:09.932 [+] Beginning Transaction
09:39:09.934 [+] AlterTable assignments
09:39:09.935 [+] CreateColumn assignments engagement_assignment_type_id Int64
09:39:09.939 [+] Committing Transaction
09:39:09.941 [+] 574: AddColumnEngagementAssignmentTypeIdOnAssignmentTable migrated
09:39:09.943 -------------------------------------------------------------------------------
09:39:09.943 575: RemoveFeatureToggleFourEyesReview migrating
09:39:09.943 -------------------------------------------------------------------------------
09:39:09.943 [+] Beginning Transaction
09:39:09.945 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.948 [+] Committing Transaction
09:39:09.950 [+] 575: RemoveFeatureToggleFourEyesReview migrated
09:39:09.950 -------------------------------------------------------------------------------
09:39:09.951 576: RemoveFeatureToggleRestrictedAssignee migrating
09:39:09.951 -------------------------------------------------------------------------------
09:39:09.951 [+] Beginning Transaction
09:39:09.953 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:09.956 [+] Committing Transaction
09:39:09.958 [+] 576: RemoveFeatureToggleRestrictedAssignee migrated
09:39:09.959 -------------------------------------------------------------------------------
09:39:09.959 577: AddTableWorkRecordExternalLinks migrating
09:39:09.960 -------------------------------------------------------------------------------
09:39:09.960 [+] Beginning Transaction
09:39:09.963 [+] CreateTable work_record_external_links
09:39:09.971 [+] CreateForeignKey fk_work_record_external_links_ref_work_records work_record_external_links(work_record_id) work_records(id)
09:39:09.976 [+] CreateIndex work_record_external_links (work_record_id)
09:39:09.978 [+] CreateIndex work_record_external_links (work_record_id, system_name)
09:39:09.982 [+] Committing Transaction
09:39:09.984 [+] 577: AddTableWorkRecordExternalLinks migrated
09:39:09.985 -------------------------------------------------------------------------------
09:39:09.985 578: RemoveCountryDMSTableAndRelatedFeatureToggle migrating
09:39:09.986 -------------------------------------------------------------------------------
09:39:09.986 [+] Beginning Transaction
09:39:09.988 [+] DeleteTable work_record_country_dms_links
09:39:09.992 [+] DeleteTable country_dms_link_list_fields
09:39:09.997 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.001 [+] Committing Transaction
09:39:10.003 [+] 578: RemoveCountryDMSTableAndRelatedFeatureToggle migrated
09:39:10.004 -------------------------------------------------------------------------------
09:39:10.004 579: RemoveTagIdFromChecklistResponsibilityTable migrating
09:39:10.004 -------------------------------------------------------------------------------
09:39:10.005 [+] Beginning Transaction
09:39:10.006 [+] DeleteColumn checklist_responsibilities tag_id
09:39:10.018 [+] Committing Transaction
09:39:10.020 [+] 579: RemoveTagIdFromChecklistResponsibilityTable migrated
09:39:10.021 -------------------------------------------------------------------------------
09:39:10.022 580: AddAssignmentTypeCategoriesTable migrating
09:39:10.022 -------------------------------------------------------------------------------
09:39:10.023 [+] Beginning Transaction
09:39:10.025 [+] CreateTable assignment_type_categories
09:39:10.028 [+] Committing Transaction
09:39:10.030 [+] 580: AddAssignmentTypeCategoriesTable migrated
09:39:10.034 -------------------------------------------------------------------------------
09:39:10.034 581: InsertValuesIntoAssignmentTypeCategoriesTable migrating
09:39:10.034 -------------------------------------------------------------------------------
09:39:10.036 [+] Beginning Transaction
09:39:10.049 [+] -> 7 Insert operations completed in 00:00:00.0058590 taking an average of 00:00:00.0008370
09:39:10.051 [+] Committing Transaction
09:39:10.053 [+] 581: InsertValuesIntoAssignmentTypeCategoriesTable migrated
09:39:10.054 -------------------------------------------------------------------------------
09:39:10.054 582: AddCategoryIdInAssignmentTypeTable migrating
09:39:10.055 -------------------------------------------------------------------------------
09:39:10.055 [+] Beginning Transaction
09:39:10.057 [+] AlterTable engagement_assignment_types
09:39:10.059 [+] CreateColumn engagement_assignment_types category_id Int64
09:39:10.064 [+] Committing Transaction
09:39:10.067 [+] 582: AddCategoryIdInAssignmentTypeTable migrated
09:39:10.068 -------------------------------------------------------------------------------
09:39:10.068 583: AddAssignmentTypeYearsAuthorizedTable migrating
09:39:10.069 -------------------------------------------------------------------------------
09:39:10.069 [+] Beginning Transaction
09:39:10.071 [+] CreateTable assignment_type_years_authorized
09:39:10.075 [+] Committing Transaction
09:39:10.078 [+] 583: AddAssignmentTypeYearsAuthorizedTable migrated
09:39:10.080 -------------------------------------------------------------------------------
09:39:10.080 584: InsertValuesIntoAssignmentTypeYearsAuthorizedTable migrating
09:39:10.080 -------------------------------------------------------------------------------
09:39:10.081 [+] Beginning Transaction
09:39:10.087 [+] -> 4 Insert operations completed in 00:00:00.0039060 taking an average of 00:00:00.0009765
09:39:10.089 [+] Committing Transaction
09:39:10.091 [+] 584: InsertValuesIntoAssignmentTypeYearsAuthorizedTable migrated
09:39:10.093 -------------------------------------------------------------------------------
09:39:10.093 585: AddYearAuthorizedIdInAssignmentTypeTable migrating
09:39:10.093 -------------------------------------------------------------------------------
09:39:10.094 [+] Beginning Transaction
09:39:10.096 [+] AlterTable engagement_assignment_types
09:39:10.102 [+] CreateColumn engagement_assignment_types year_authorized_for_home_country_id Int64
09:39:10.106 [+] AlterTable engagement_assignment_types
09:39:10.108 [+] CreateColumn engagement_assignment_types year_authorized_for_host_country_id Int64
09:39:10.113 [+] Committing Transaction
09:39:10.115 [+] 585: AddYearAuthorizedIdInAssignmentTypeTable migrated
09:39:10.117 -------------------------------------------------------------------------------
09:39:10.117 586: AddNewOfficeFileSharingToggle migrating
09:39:10.117 -------------------------------------------------------------------------------
09:39:10.117 [+] Beginning Transaction
09:39:10.119 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:10.121 [+] Committing Transaction
09:39:10.124 [+] 586: AddNewOfficeFileSharingToggle migrated
09:39:10.125 -------------------------------------------------------------------------------
09:39:10.125 587: RemoveFeatureToggleForTeamWorkSpaceLink migrating
09:39:10.125 -------------------------------------------------------------------------------
09:39:10.126 [+] Beginning Transaction
09:39:10.127 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.130 [+] Committing Transaction
09:39:10.132 [+] 587: RemoveFeatureToggleForTeamWorkSpaceLink migrated
09:39:10.133 -------------------------------------------------------------------------------
09:39:10.134 588: RemoveFeatureToggleForMyFilesEntry migrating
09:39:10.134 -------------------------------------------------------------------------------
09:39:10.134 [+] Beginning Transaction
09:39:10.136 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.139 [+] Committing Transaction
09:39:10.140 [+] 588: RemoveFeatureToggleForMyFilesEntry migrated
09:39:10.141 -------------------------------------------------------------------------------
09:39:10.142 589: AddDateMandatoryInAssignmentTypeCategoriesTable migrating
09:39:10.142 -------------------------------------------------------------------------------
09:39:10.142 [+] Beginning Transaction
09:39:10.144 [+] AlterTable assignment_type_categories
09:39:10.145 [+] CreateColumn assignment_type_categories is_start_date_mandatory Boolean
09:39:10.152 [+] AlterTable assignment_type_categories
09:39:10.153 [+] CreateColumn assignment_type_categories is_estimated_end_date_mandatory Boolean
09:39:10.159 [+] Committing Transaction
09:39:10.165 [+] 589: AddDateMandatoryInAssignmentTypeCategoriesTable migrated
09:39:10.169 -------------------------------------------------------------------------------
09:39:10.169 590: UpdateDateMandatoryInAssignmentTypeCategoriesTable migrating
09:39:10.170 -------------------------------------------------------------------------------
09:39:10.170 [+] Beginning Transaction
09:39:10.176 [+] UpdateData 
09:39:10.185 [+] UpdateData 
09:39:10.187 [+] UpdateData 
09:39:10.189 [+] UpdateData 
09:39:10.191 [+] UpdateData 
09:39:10.193 [+] UpdateData 
09:39:10.195 [+] UpdateData 
09:39:10.197 [+] Committing Transaction
09:39:10.200 [+] 590: UpdateDateMandatoryInAssignmentTypeCategoriesTable migrated
09:39:10.200 -------------------------------------------------------------------------------
09:39:10.200 591: RemoveSequenceColumnFromAssignmentTypeCategoriesTable migrating
09:39:10.200 -------------------------------------------------------------------------------
09:39:10.201 [+] Beginning Transaction
09:39:10.203 [+] DeleteColumn assignment_type_categories sequence
09:39:10.238 [+] Committing Transaction
09:39:10.239 [+] 591: RemoveSequenceColumnFromAssignmentTypeCategoriesTable migrated
09:39:10.240 -------------------------------------------------------------------------------
09:39:10.240 592: RemoveFeatureTogglesForEventStore migrating
09:39:10.240 -------------------------------------------------------------------------------
09:39:10.240 [+] Beginning Transaction
09:39:10.241 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.241 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.241 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.242 [+] Committing Transaction
09:39:10.243 [+] 592: RemoveFeatureTogglesForEventStore migrated
09:39:10.243 -------------------------------------------------------------------------------
09:39:10.243 593: AddModifiedByColumnInAssigneeCustomFieldsValue migrating
09:39:10.243 -------------------------------------------------------------------------------
09:39:10.243 [+] Beginning Transaction
09:39:10.244 [+] AlterTable assignee_custom_fields_value
09:39:10.244 [+] CreateColumn assignee_custom_fields_value modified_by String
09:39:10.246 [+] Committing Transaction
09:39:10.247 [+] 593: AddModifiedByColumnInAssigneeCustomFieldsValue migrated
09:39:10.247 -------------------------------------------------------------------------------
09:39:10.247 594: AddModifiedByColumnInAssigneeAssignmentCustomFieldsValue migrating
09:39:10.248 -------------------------------------------------------------------------------
09:39:10.248 [+] Beginning Transaction
09:39:10.248 [+] AlterTable assignee_assignment_custom_fields_value
09:39:10.249 [+] CreateColumn assignee_assignment_custom_fields_value modified_by String
09:39:10.250 [+] Committing Transaction
09:39:10.251 [+] 594: AddModifiedByColumnInAssigneeAssignmentCustomFieldsValue migrated
09:39:10.252 -------------------------------------------------------------------------------
09:39:10.252 595: AddBriefingMethodToAssigneeWorkRecordTable migrating
09:39:10.252 -------------------------------------------------------------------------------
09:39:10.252 [+] Beginning Transaction
09:39:10.254 [+] AlterTable assignee_work_records
09:39:10.255 [+] CreateColumn assignee_work_records briefing_method Int32
09:39:10.257 [+] UpdateData 
09:39:10.260 [+] Committing Transaction
09:39:10.262 [+] 595: AddBriefingMethodToAssigneeWorkRecordTable migrated
09:39:10.263 -------------------------------------------------------------------------------
09:39:10.263 596: AddBriefingAddressToAssigneeWorkRecordTable migrating
09:39:10.263 -------------------------------------------------------------------------------
09:39:10.264 [+] Beginning Transaction
09:39:10.265 [+] AlterTable assignee_work_records
09:39:10.267 [+] CreateColumn assignee_work_records briefing_address String
09:39:10.271 [+] Committing Transaction
09:39:10.273 [+] 596: AddBriefingAddressToAssigneeWorkRecordTable migrated
09:39:10.274 -------------------------------------------------------------------------------
09:39:10.274 597: RenameAssignmentTypeTableName migrating
09:39:10.274 -------------------------------------------------------------------------------
09:39:10.275 [+] Beginning Transaction
09:39:10.276 [+] RenameTable engagement_assignment_types assignment_types
09:39:10.280 [+] Committing Transaction
09:39:10.282 [+] 597: RenameAssignmentTypeTableName migrated
09:39:10.283 -------------------------------------------------------------------------------
09:39:10.283 598: AddAuthorizationListsTable migrating
09:39:10.283 -------------------------------------------------------------------------------
09:39:10.283 [+] Beginning Transaction
09:39:10.286 [+] CreateTable authorization_lists
09:39:10.289 [+] CreateIndex authorization_lists (engagement_id)
09:39:10.295 [+] CreateIndex authorization_lists (year)
09:39:10.302 [+] Committing Transaction
09:39:10.304 [+] 598: AddAuthorizationListsTable migrated
09:39:10.306 -------------------------------------------------------------------------------
09:39:10.306 599: AddAuthorizationItemsTable migrating
09:39:10.306 -------------------------------------------------------------------------------
09:39:10.306 [+] Beginning Transaction
09:39:10.309 [+] CreateTable authorization_items
09:39:10.314 [+] Committing Transaction
09:39:10.316 [+] 599: AddAuthorizationItemsTable migrated
09:39:10.318 -------------------------------------------------------------------------------
09:39:10.318 600: AddVipModiferAndDateInAssigneeTable migrating
09:39:10.318 -------------------------------------------------------------------------------
09:39:10.318 [+] Beginning Transaction
09:39:10.320 [+] AlterTable assignees
09:39:10.321 [+] CreateColumn assignees vip_modifier Int64
09:39:10.324 [+] AlterTable assignees
09:39:10.326 [+] CreateColumn assignees vip_set_date DateTime
09:39:10.329 [+] Committing Transaction
09:39:10.331 [+] 600: AddVipModiferAndDateInAssigneeTable migrated
09:39:10.332 -------------------------------------------------------------------------------
09:39:10.333 601: InsertNewAuthRuleIntoAssignmentTypeYearsAuthorizedTable migrating
09:39:10.333 -------------------------------------------------------------------------------
09:39:10.333 [+] Beginning Transaction
09:39:10.336 [+] UpdateData 
09:39:10.345 [+] UpdateData 
09:39:10.347 [+] UpdateData 
09:39:10.349 [+] UpdateData 
09:39:10.351 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:10.353 [+] Committing Transaction
09:39:10.355 [+] 601: InsertNewAuthRuleIntoAssignmentTypeYearsAuthorizedTable migrated
09:39:10.356 -------------------------------------------------------------------------------
09:39:10.356 602: RemoveFeatureTogglesForHiddenAssignee migrating
09:39:10.356 -------------------------------------------------------------------------------
09:39:10.359 [+] Beginning Transaction
09:39:10.364 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.366 [+] Committing Transaction
09:39:10.368 [+] 602: RemoveFeatureTogglesForHiddenAssignee migrated
09:39:10.369 -------------------------------------------------------------------------------
09:39:10.369 603: RemoveFeatureTogglesForMyMobilityInviteRebecca migrating
09:39:10.369 -------------------------------------------------------------------------------
09:39:10.370 [+] Beginning Transaction
09:39:10.372 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.375 [+] Committing Transaction
09:39:10.377 [+] 603: RemoveFeatureTogglesForMyMobilityInviteRebecca migrated
09:39:10.379 -------------------------------------------------------------------------------
09:39:10.379 604: RemoveFeatureTogglesForEmployerReturnWorkRecord migrating
09:39:10.379 -------------------------------------------------------------------------------
09:39:10.380 [+] Beginning Transaction
09:39:10.382 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.384 [+] Committing Transaction
09:39:10.386 [+] 604: RemoveFeatureTogglesForEmployerReturnWorkRecord migrated
09:39:10.388 -------------------------------------------------------------------------------
09:39:10.388 605: RemoveFeatureTogglesForBatchUpdateChecklistItems migrating
09:39:10.388 -------------------------------------------------------------------------------
09:39:10.389 [+] Beginning Transaction
09:39:10.391 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.394 [+] Committing Transaction
09:39:10.396 [+] 605: RemoveFeatureTogglesForBatchUpdateChecklistItems migrated
09:39:10.398 -------------------------------------------------------------------------------
09:39:10.398 606: RemoveFeatureTogglesForConnectLinkedin migrating
09:39:10.398 -------------------------------------------------------------------------------
09:39:10.399 [+] Beginning Transaction
09:39:10.401 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.403 [+] Committing Transaction
09:39:10.406 [+] 606: RemoveFeatureTogglesForConnectLinkedin migrated
09:39:10.407 -------------------------------------------------------------------------------
09:39:10.407 607: RemoveFeatureTogglesForDeleteAssignee migrating
09:39:10.407 -------------------------------------------------------------------------------
09:39:10.407 [+] Beginning Transaction
09:39:10.409 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.411 [+] Committing Transaction
09:39:10.414 [+] 607: RemoveFeatureTogglesForDeleteAssignee migrated
09:39:10.416 -------------------------------------------------------------------------------
09:39:10.416 608: RemoveFeatureTogglesForEngagementSecondaryContact migrating
09:39:10.416 -------------------------------------------------------------------------------
09:39:10.417 [+] Beginning Transaction
09:39:10.418 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.421 [+] Committing Transaction
09:39:10.663 [+] 608: RemoveFeatureTogglesForEngagementSecondaryContact migrated
09:39:10.728 -------------------------------------------------------------------------------
09:39:10.728 609: RemoveFeatureTogglesForMyMobility migrating
09:39:10.728 -------------------------------------------------------------------------------
09:39:10.729 [+] Beginning Transaction
09:39:10.729 [+] FluentMigrator.Expressions.DeleteDataExpression
09:39:10.729 [+] Committing Transaction
09:39:10.729 [+] 609: RemoveFeatureTogglesForMyMobility migrated
09:39:10.729 -------------------------------------------------------------------------------
09:39:10.730 610: AddFeatureToggleForAuthorizationList migrating
09:39:10.730 -------------------------------------------------------------------------------
09:39:10.730 [+] Beginning Transaction
09:39:10.734 [+] -> 1 Insert operations completed in 00:00:00.0019530 taking an average of 00:00:00.0019530
09:39:10.736 [+] Committing Transaction
09:39:11.004 [+] 610: AddFeatureToggleForAuthorizationList migrated
09:39:11.004 -------------------------------------------------------------------------------
09:39:11.004 611: AddTaxYearStartDateToCountryTable migrating
09:39:11.004 -------------------------------------------------------------------------------
09:39:11.005 [+] Beginning Transaction
09:39:11.006 [+] AlterTable countries
09:39:11.006 [+] CreateColumn countries tax_year_start_date Date
09:39:11.037 [+] Committing Transaction
09:39:11.088 [+] 611: AddTaxYearStartDateToCountryTable migrated
09:39:11.089 -------------------------------------------------------------------------------
09:39:11.089 612: AddIsManualColumnToAuthorizationItem migrating
09:39:11.089 -------------------------------------------------------------------------------
09:39:11.090 [+] Beginning Transaction
09:39:11.091 [+] AlterTable authorization_items
09:39:11.091 [+] CreateColumn authorization_items is_manual Boolean
09:39:11.095 [+] Committing Transaction
09:39:11.126 [+] 612: AddIsManualColumnToAuthorizationItem migrated
09:39:11.127 -------------------------------------------------------------------------------
09:39:11.128 613: AddAuthorizationListAdministratorTable migrating
09:39:11.128 -------------------------------------------------------------------------------
09:39:11.128 [+] Beginning Transaction
09:39:11.130 [+] CreateTable engagement_authorization_administrator
09:39:11.134 [+] Committing Transaction
09:39:11.138 [+] 613: AddAuthorizationListAdministratorTable migrated
09:39:11.140 -------------------------------------------------------------------------------
09:39:11.140 614: AddFeatureToggleForServiceInitiationSettings migrating
09:39:11.140 -------------------------------------------------------------------------------
09:39:11.140 [+] Beginning Transaction
09:39:11.146 [+] -> 1 Insert operations completed in 00:00:00.0029295 taking an average of 00:00:00.0029295
09:39:11.150 [+] Committing Transaction
09:39:11.167 [+] 614: AddFeatureToggleForServiceInitiationSettings migrated
09:39:11.169 -------------------------------------------------------------------------------
09:39:11.169 615: AddLastUpdateColumnToAuthorizationItem migrating
09:39:11.169 -------------------------------------------------------------------------------
09:39:11.169 [+] Beginning Transaction
09:39:11.170 [+] AlterTable authorization_items
09:39:11.170 [+] CreateColumn authorization_items last_updated_by String
09:39:11.173 [+] AlterTable authorization_items
09:39:11.175 [+] CreateColumn authorization_items last_updated_on Date
09:39:11.178 [+] Committing Transaction
09:39:11.196 [+] 615: AddLastUpdateColumnToAuthorizationItem migrated
09:39:11.196 -------------------------------------------------------------------------------
09:39:11.196 616: AddAuthorizedYearsToAssignmentType migrating
09:39:11.196 -------------------------------------------------------------------------------
09:39:11.197 [+] Beginning Transaction
09:39:11.197 [+] AlterTable assignment_types
09:39:11.197 [+] CreateColumn assignment_types home_country_authorized_years Int32
09:39:11.198 [+] AlterTable assignment_types
09:39:11.199 [+] CreateColumn assignment_types host_country_authorized_years Int32
09:39:11.200 [+] DeleteForeignKey DF_engagement_assignment_types_year_authorized_for_home_country_id assignment_types ()  ()
09:39:11.202 [+] DeleteForeignKey DF_engagement_assignment_types_year_authorized_for_host_country_id assignment_types ()  ()
09:39:11.203 [+] DeleteColumn assignment_types year_authorized_for_home_country_id
09:39:11.212 [+] DeleteColumn assignment_types year_authorized_for_host_country_id
09:39:11.219 [+] DeleteTable assignment_type_years_authorized
09:39:11.222 [+] Committing Transaction
09:39:11.246 [+] 616: AddAuthorizedYearsToAssignmentType migrated
09:39:11.247 -------------------------------------------------------------------------------
09:39:11.247 617: ChangeAuthorizationItemLastUpdatedOn migrating
09:39:11.247 -------------------------------------------------------------------------------
09:39:11.247 [+] Beginning Transaction
09:39:11.249 [+] AlterTable authorization_items
09:39:11.250 [+] AlterColumn authorization_items last_updated_on DateTime
09:39:11.256 [+] Committing Transaction
09:39:11.297 [+] 617: ChangeAuthorizationItemLastUpdatedOn migrated
09:39:11.297 -------------------------------------------------------------------------------
09:39:11.298 618: AddAvailableBriefingMethodsToAssigneeWorkRecordTable migrating
09:39:11.298 -------------------------------------------------------------------------------
09:39:11.298 [+] Beginning Transaction
09:39:11.306 [+] AlterTable assignee_work_records
09:39:11.307 [+] CreateColumn assignee_work_records available_briefing_methods Int32
09:39:11.310 [+] AlterTable assignee_work_records
09:39:11.312 [+] CreateColumn assignee_work_records briefing_address_assignee_office String
09:39:11.315 [+] AlterTable assignee_work_records
09:39:11.316 [+] CreateColumn assignee_work_records briefing_address_pwc_office String
09:39:11.319 [+] UpdateData 
09:39:11.325 [+] ExecuteSqlStatement update assignee_work_records 
09:39:11.325                         set available_briefing_methods = briefing_method 
09:39:11.325                         where scheduling_method = 0 and type = 4
09:39:11.330 [+] ExecuteSqlStatement update assignee_work_records 
09:39:11.330                         set briefing_address_assignee_office = briefing_address 
09:39:11.330                         where briefing_method = 1 and scheduling_method = 0 and type = 4
09:39:11.339 [+] ExecuteSqlStatement update assignee_work_records 
09:39:11.339                         set briefing_address_pwc_office = briefing_address 
09:39:11.340                         where briefing_method = 2 and scheduling_method = 0 and type = 4
09:39:11.349 [+] ExecuteSqlStatement update awr
09:39:11.349                         set awr.briefing_method = NULL
09:39:11.349                         from assignee_work_records awr
09:39:11.350                         inner join work_records as wr on wr.id = awr.work_record_id
09:39:11.350                         where wr.current_milestone_name < 30 and awr.scheduling_method = 0 and awr.type = 4
09:39:11.359 [+] UpdateData 
09:39:11.362 [+] DeleteColumn assignee_work_records briefing_address
09:39:11.377 [+] Committing Transaction
09:39:11.378 [+] 618: AddAvailableBriefingMethodsToAssigneeWorkRecordTable migrated
09:39:11.379 -------------------------------------------------------------------------------
09:39:11.379 619: AddBriefingMethodsToOfficeTable migrating
09:39:11.379 -------------------------------------------------------------------------------
09:39:11.379 [+] Beginning Transaction
09:39:11.381 [+] AlterTable offices
09:39:11.382 [+] CreateColumn offices briefing_methods Int32
09:39:11.383 [+] UpdateData 
09:39:11.385 [+] Committing Transaction
09:39:11.397 [+] 619: AddBriefingMethodsToOfficeTable migrated
09:39:11.398 -------------------------------------------------------------------------------
09:39:11.401 620: AddCommentsColumnToAuthorizationItem migrating
09:39:11.401 -------------------------------------------------------------------------------
09:39:11.401 [+] Beginning Transaction
09:39:11.401 [+] AlterTable authorization_items
09:39:11.401 [+] CreateColumn authorization_items comments String
09:39:11.404 [+] Committing Transaction
09:39:11.416 [+] 620: AddCommentsColumnToAuthorizationItem migrated
09:39:11.416 -------------------------------------------------------------------------------
09:39:11.416 621: ChangeAuthorizationItemLastUpdateByToId migrating
09:39:11.416 -------------------------------------------------------------------------------
09:39:11.416 [+] Beginning Transaction
09:39:11.417 [+] AlterTable authorization_items
09:39:11.417 [+] AlterColumn authorization_items last_updated_by Int64
09:39:11.420 [+] Committing Transaction
09:39:11.432 [+] 621: ChangeAuthorizationItemLastUpdateByToId migrated
09:39:11.432 -------------------------------------------------------------------------------
09:39:11.432 622: ChangeAuthorizationItemPKGenerator migrating
09:39:11.432 -------------------------------------------------------------------------------
09:39:11.432 [+] Beginning Transaction
09:39:11.435 [+] CreateTable hibernate_unique_key
09:39:11.437 [+] DeleteConstraint PK_authorization_items
09:39:11.441 [+] RenameColumn authorization_items id to old_id
09:39:11.445 [+] AlterTable authorization_items
09:39:11.446 [+] CreateColumn authorization_items id Int64
09:39:11.448 [+] ExecuteSqlStatement update authorization_items set id = old_id
09:39:11.452 [+] AlterTable authorization_items
09:39:11.454 [+] AlterColumn authorization_items id Int64
09:39:11.459 [+] CreateConstraint PK_authorization_items
09:39:11.465 [+] DeleteColumn authorization_items old_id
09:39:11.483 [+] ExecuteSqlStatement update hibernate_unique_key
09:39:11.483                         set next_hi = ceiling((isnull(maxId, -1) + 1) / 32768.0)
09:39:11.483                         from (select MAX(id) as maxId from authorization_items) t where table_name = 'authorization_items'
09:39:11.488 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:11.488 [+] Committing Transaction
09:39:11.490 [+] 622: ChangeAuthorizationItemPKGenerator migrated
09:39:11.491 -------------------------------------------------------------------------------
09:39:11.492 623: AddCreatorIdColumnInAssigneeTable migrating
09:39:11.492 -------------------------------------------------------------------------------
09:39:11.492 [+] Beginning Transaction
09:39:11.494 [+] AlterTable assignees
09:39:11.495 [+] CreateColumn assignees creator_id Int64
09:39:11.499 [+] Committing Transaction
09:39:11.501 [+] 623: AddCreatorIdColumnInAssigneeTable migrated
09:39:11.502 -------------------------------------------------------------------------------
09:39:11.502 624: InsertValueIndefiniteIntoAssignmentTypeCategoriesTable migrating
09:39:11.503 -------------------------------------------------------------------------------
09:39:11.503 [+] Beginning Transaction
09:39:11.510 [+] -> 1 Insert operations completed in 00:00:00.0019530 taking an average of 00:00:00.0019530
09:39:11.512 [+] Committing Transaction
09:39:11.526 [+] 624: InsertValueIndefiniteIntoAssignmentTypeCategoriesTable migrated
09:39:11.527 -------------------------------------------------------------------------------
09:39:11.527 625: AddAuthorizationListHistoryItemTable migrating
09:39:11.527 -------------------------------------------------------------------------------
09:39:11.528 [+] Beginning Transaction
09:39:11.529 [+] CreateTable authorization_list_history_item
09:39:11.540 [+] Committing Transaction
09:39:11.542 [+] 625: AddAuthorizationListHistoryItemTable migrated
09:39:11.543 -------------------------------------------------------------------------------
09:39:11.543 626: ChangeAuthorizationHistoryItemPKGenerator migrating
09:39:11.543 -------------------------------------------------------------------------------
09:39:11.544 [+] Beginning Transaction
09:39:11.546 [+] DeleteConstraint PK_authorization_list_history_item
09:39:11.550 [+] RenameColumn authorization_list_history_item id to old_id
09:39:11.554 [+] AlterTable authorization_list_history_item
09:39:11.555 [+] CreateColumn authorization_list_history_item id Int64
09:39:11.558 [+] ExecuteSqlStatement update authorization_list_history_item set id = old_id
09:39:11.562 [+] AlterTable authorization_list_history_item
09:39:11.563 [+] AlterColumn authorization_list_history_item id Int64
09:39:11.568 [+] CreateConstraint PK_authorization_list_history_item
09:39:11.586 [+] DeleteColumn authorization_list_history_item old_id
09:39:11.586 [+] ExecuteSqlStatement update hibernate_unique_key
09:39:11.587                         set next_hi = ceiling((isnull(maxId, -1) + 1) / 32768.0)
09:39:11.587                         from (select MAX(id) as maxId from authorization_list_history_item) t where table_name = 'authorization_list_history_item'
09:39:11.590 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:11.591 [+] Committing Transaction
09:39:11.597 [+] 626: ChangeAuthorizationHistoryItemPKGenerator migrated
09:39:11.600 -------------------------------------------------------------------------------
09:39:11.601 627: AddIsUrgentColumnInToDoItemsTable migrating
09:39:11.601 -------------------------------------------------------------------------------
09:39:11.602 [+] Beginning Transaction
09:39:11.603 [+] AlterTable todo_items
09:39:11.604 [+] CreateColumn todo_items is_urgent Boolean
09:39:11.608 [+] Committing Transaction
09:39:11.610 [+] 627: AddIsUrgentColumnInToDoItemsTable migrated
09:39:11.612 -------------------------------------------------------------------------------
09:39:11.612 628: AddFeatureToggleForAuthListFinalization migrating
09:39:11.612 -------------------------------------------------------------------------------
09:39:11.613 [+] Beginning Transaction
09:39:11.614 [+] -> 1 Insert operations completed in 00:00:00 taking an average of 00:00:00
09:39:11.616 [+] Committing Transaction
09:39:11.628 [+] 628: AddFeatureToggleForAuthListFinalization migrated
09:39:11.629 -------------------------------------------------------------------------------
09:39:11.630 629: AddTaxReturnDownloadReminderColumnOnEngagementsTable migrating
09:39:11.630 -------------------------------------------------------------------------------
09:39:11.631 [+] Beginning Transaction
09:39:11.632 [+] AlterTable engagements
09:39:11.634 [+] CreateColumn engagements tax_return_download_reminder Decimal
09:39:11.637 [+] Committing Transaction
09:39:11.639 [+] 629: AddTaxReturnDownloadReminderColumnOnEngagementsTable migrated
09:39:11.641 -------------------------------------------------------------------------------
09:39:11.641 630: AddAuthorizationListFinalizedCountryTable migrating
09:39:11.641 -------------------------------------------------------------------------------
09:39:11.642 [+] Beginning Transaction
09:39:11.644 [+] CreateTable authorization_list_finalized_country
09:39:11.649 [+] Committing Transaction
09:39:11.651 [+] 630: AddAuthorizationListFinalizedCountryTable migrated
09:39:11.652 -------------------------------------------------------------------------------
09:39:11.653 631: ChangeAuthorizationItemLastUpdatedBy migrating
09:39:11.653 -------------------------------------------------------------------------------
09:39:11.653 [+] Beginning Transaction
09:39:11.654 [+] AlterTable authorization_items
09:39:11.655 [+] AlterColumn authorization_items last_updated_by String
09:39:11.661 [+] Committing Transaction
09:39:11.666 [+] 631: ChangeAuthorizationItemLastUpdatedBy migrated
09:39:11.671 -------------------------------------------------------------------------------
09:39:11.671 632: AddUpdatedByClientColumnToAuthorizationHistoryItem migrating
09:39:11.671 -------------------------------------------------------------------------------
09:39:11.671 [+] Beginning Transaction
09:39:11.673 [+] AlterTable authorization_list_history_item
09:39:11.674 [+] CreateColumn authorization_list_history_item updated_by_client Boolean
09:39:11.679 [+] Committing Transaction
09:39:11.680 [+] 632: AddUpdatedByClientColumnToAuthorizationHistoryItem migrated
09:39:11.682 -------------------------------------------------------------------------------
09:39:11.682 633: AddLastUpdatedByClientColumnToAuthorizationItem migrating
09:39:11.682 -------------------------------------------------------------------------------
09:39:11.683 [+] Beginning Transaction
09:39:11.685 [+] AlterTable authorization_items
09:39:11.686 [+] CreateColumn authorization_items last_updated_by_client Boolean
09:39:11.691 [+] Committing Transaction
09:39:11.693 [+] 633: AddLastUpdatedByClientColumnToAuthorizationItem migrated
09:39:11.694 -------------------------------------------------------------------------------
09:39:11.695 634: ChangeAssignmentTypeIdColumnOnAuthorizationItemsTable migrating
09:39:11.695 -------------------------------------------------------------------------------
09:39:11.696 [+] Beginning Transaction
09:39:11.697 [+] AlterTable authorization_items
09:39:11.698 [+] CreateColumn authorization_items assignment_type_name String
09:39:11.702 [+] ExecuteSqlStatement update authorization_items
09:39:11.702             set assignment_type_name = at.name
09:39:11.703             from authorization_items i
09:39:11.703             inner join assignment_types at on i.assignment_type_id = at.id
09:39:11.709 [+] DeleteColumn authorization_items assignment_type_id
09:39:11.724 [+] Committing Transaction
09:39:11.725 [+] 634: ChangeAssignmentTypeIdColumnOnAuthorizationItemsTable migrated
09:39:11.727 -------------------------------------------------------------------------------
09:39:11.727 635: ChangeFinalizedInfoNotNullableOnAuthorizationFinalizationCountryTable migrating
09:39:11.727 -------------------------------------------------------------------------------
09:39:11.730 [+] Beginning Transaction
09:39:11.734 [+] AlterTable authorization_list_finalized_country
09:39:11.736 [+] AlterColumn authorization_list_finalized_country finalized_on DateTime
09:39:11.739 [+] AlterTable authorization_list_finalized_country
09:39:11.740 [+] AlterColumn authorization_list_finalized_country finalized_by Int32
09:39:11.743 [+] Committing Transaction
09:39:11.746 [+] 635: ChangeFinalizedInfoNotNullableOnAuthorizationFinalizationCountryTable migrated
09:39:11.748 -------------------------------------------------------------------------------
09:39:11.748 636: AddIsReminderNeededToEngagementsTable migrating
09:39:11.748 -------------------------------------------------------------------------------
09:39:11.749 [+] Beginning Transaction
09:39:11.751 [+] AlterTable engagements
09:39:11.752 [+] CreateColumn engagements is_reminder_needed Boolean
09:39:11.757 [+] Committing Transaction
09:39:11.759 [+] 636: AddIsReminderNeededToEngagementsTable migrated
09:39:11.760 -------------------------------------------------------------------------------
09:39:11.760 637: CreateBriefingInfoTable migrating
09:39:11.761 -------------------------------------------------------------------------------
09:39:11.761 [+] Beginning Transaction
09:39:11.763 [+] CreateTable briefing_info
09:39:11.768 [+] CreateConstraint PK_briefing_info
09:39:11.773 [+] ExecuteSqlStatement INSERT INTO briefing_info SELECT 
09:39:11.773                             work_record_id,
09:39:11.773                             scheduling_method,
09:39:11.773                             briefing_staff_id,
09:39:11.774                             date_requested,
09:39:11.774                             available_briefing_methods,
09:39:11.774                             briefing_method AS selected_briefing_method,
09:39:11.774                             briefing_address_assignee_office AS assignee_office_address,
09:39:11.774                             briefing_address_pwc_office AS pwc_office_address,
09:39:11.774                             first_reminder,
09:39:11.774                             final_reminder,
09:39:11.775                             upcoming_notify_status,
09:39:11.775                             scheduled_date_time,
09:39:11.775                             contact_number,
09:39:11.775                             assignee_time_zone
09:39:11.775                         FROM [assignee_work_records]
09:39:11.775                         WHERE type = 4
09:39:11.777 [+] ExecuteSqlStatement ALTER table assignee_work_records DROP CONSTRAINT DF_assignee_work_records_upcoming_notify_status
09:39:11.780 [+] ExecuteSqlStatement ALTER table assignee_work_records drop column 
09:39:11.780                            scheduling_method
09:39:11.780                           ,briefing_staff_id
09:39:11.780                           ,date_requested
09:39:11.780                           ,available_briefing_methods
09:39:11.781                           ,briefing_method
09:39:11.781                           ,briefing_address_assignee_office
09:39:11.781                           ,briefing_address_pwc_office
09:39:11.781                           ,first_reminder
09:39:11.781                           ,final_reminder
09:39:11.781                           ,upcoming_notify_status
09:39:11.781                           ,scheduled_date_time
09:39:11.782                           ,contact_number
09:39:11.782                           ,assignee_time_zone
09:39:11.790 [+] Committing Transaction
09:39:11.793 [+] 637: CreateBriefingInfoTable migrated
09:39:11.801 -------------------------------------------------------------------------------
09:39:11.801 638: AddOtherBriefingMethodNameColumnToBriefingInfoTable migrating
09:39:11.801 -------------------------------------------------------------------------------
09:39:11.802 [+] Beginning Transaction
09:39:11.804 [+] AlterTable briefing_info
09:39:11.806 [+] CreateColumn briefing_info other_briefing_method_name String
09:39:11.812 [+] Committing Transaction
09:39:11.816 [+] 638: AddOtherBriefingMethodNameColumnToBriefingInfoTable migrated
09:39:11.818 -------------------------------------------------------------------------------
09:39:11.818 639: AddFeatureToggleForAssigneeCalendarReport migrating
09:39:11.819 -------------------------------------------------------------------------------
09:39:11.820 [+] Beginning Transaction
09:39:11.822 [+] -> 1 Insert operations completed in 00:00:00.0009765 taking an average of 00:00:00.0009765
09:39:11.824 [+] Committing Transaction
09:39:11.826 [+] 639: AddFeatureToggleForAssigneeCalendarReport migrated
09:39:11.827 -------------------------------------------------------------------------------
09:39:11.827 640: AddDescriptionColumnOnHistoryItemTableAndMigrateExistingMissingItemDescriptions migrating
09:39:11.828 -------------------------------------------------------------------------------
09:39:11.828 [+] Beginning Transaction
09:39:11.830 [+] AlterTable history_item
09:39:11.831 [+] CreateColumn history_item description String
09:39:11.834 [+] ExecuteSqlStatement update history_item
09:39:11.835             set description = mi.description
09:39:11.835             from history_item hi
09:39:11.835             inner join missing_items mi on hi.entity_id = mi.id
09:39:11.842 [+] Committing Transaction
09:39:11.856 [+] 640: AddDescriptionColumnOnHistoryItemTableAndMigrateExistingMissingItemDescriptions migrated
09:39:11.857 -------------------------------------------------------------------------------
09:39:11.857 641: AddTaxReturnReportEmailReminderHistoryTable migrating
09:39:11.857 -------------------------------------------------------------------------------
09:39:11.858 [+] Beginning Transaction
09:39:11.863 [+] CreateTable tax_return_report_email_reminder_history
09:39:11.868 [+] Committing Transaction
09:39:11.870 [+] 641: AddTaxReturnReportEmailReminderHistoryTable migrated
09:39:11.871 -------------------------------------------------------------------------------
09:39:11.871 642: AddThreeFollowupReminderFieldsToEngagementTable migrating
09:39:11.871 -------------------------------------------------------------------------------
09:39:11.872 [+] Beginning Transaction
09:39:11.874 [+] AlterTable engagements
09:39:11.875 [+] CreateColumn engagements is_followup_needed Boolean
09:39:11.879 [+] AlterTable engagements
09:39:11.880 [+] CreateColumn engagements followup_times Double
09:39:11.883 [+] AlterTable engagements
09:39:11.885 [+] CreateColumn engagements followup_interval Double
09:39:11.889 [+] Committing Transaction
09:39:11.891 [+] 642: AddThreeFollowupReminderFieldsToEngagementTable migrated
09:39:11.963 [+] Task completed.
09:39:13.485 Processing DB user access
09:39:14.234 Changed database context to 'master'.
09:39:14.299 Changed database context to 'Tiger-local'.
09:39:14.368 Changed database context to 'Tiger-local'.
09:39:14.883 Changed database context to 'master'.
09:39:14.946 Changed database context to 'Tiger-local'.
09:39:15.020 Changed database context to 'Tiger-local'.
09:39:15.203 Changed database context to 'master'.
09:39:15.305 Changed database context to 'Tiger-local'.
09:39:15.378 Changed database context to 'Tiger-local'.
09:39:15.412 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerDB.1.3.6289\tools\deploy-mssql-database\database-options.ns.ps1] ends
09:39:15.416 Enable DB User Options: Transaction isolation level
09:39:15.952 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerDB.1.3.6289\tools\deploy-mssql-database\database-options.ns.ps1] ends
09:39:15.973 2015-11-25T09:39:15 End install.ps1 TigerDB
09:39:15.976 server                         localhost                                       
09:39:15.976 dbName                         Tiger-local                                     
09:39:16.138 2015-11-25T09:39:16 Start Install-NuPackage TigerDataPrepareCli
09:39:16.166 11/25/2015 09:39:16: Downloading package [TigerDataPrepareCli] from [http://10.18.7.148/nuget-server-tmp] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:39:16.640 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install TigerDataPrepareCli -version 1.3.6289 -source http://10.18.7.148/nuget-server-tmp -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:39:19.141 Package [TigerDataPrepareCli] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerDataPrepareCli.1.3.6289].
09:39:19.145 2015-11-25T09:39:19 Start install.ps1 TigerDataPrepareCli
09:39:19.562 Importing DB Data with Domain Entity ...
09:40:19.588 Init DB Data with Domain Entity completed.
09:40:21.849 WARNING: Waiting for service 'EventStore.Service (EventStore.Service)' to 
09:40:21.850 stop...
09:40:24.101 WARNING: Waiting for service 'EventStore.Service (EventStore.Service)' to 
09:40:24.101 stop...
09:40:26.102 clean db and logs for EventStore...
09:40:26.524 Wait for EventStoreService to start...
09:40:31.526 Migrating Fixture Data into EventStore ...
09:41:07.194 Migrate Fixture Data into EventStore completed.
09:41:07.315 2015-11-25T09:41:07 End install.ps1 TigerDataPrepareCli
09:41:07.335 Imported 001_Country.csv.
09:41:07.336 Imported 002_Office.csv.
09:41:07.336 Imported 003_Timezone.csv.
09:41:07.337 Imported 004_Staff.csv.
09:41:07.338 Imported 005_User.csv.
09:41:07.338 Imported 006_TypeOfService.csv.
09:41:07.339 Imported 007_Client.csv.
09:41:07.339 Imported 008_Engagement.csv.
09:41:07.340 Imported 009_EfileGroup.csv.
09:41:07.341 Imported 010_Currency.csv.
09:41:07.831 2015-11-25T09:41:07 Start Install-NuPackage Tiger.EventStore.Projections
09:41:07.862 11/25/2015 09:41:07: Downloading package [Tiger.EventStore.Projections] from [http://10.18.7.148/nuget-server-integration] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:41:08.336 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install Tiger.EventStore.Projections -version 1.0.0.7 -source http://10.18.7.148/nuget-server-integration -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:41:08.867 Package [Tiger.EventStore.Projections] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\Tiger.EventStore.Projections.1.0.0.7].
09:41:08.875 2015-11-25T09:41:08 Start install.ps1 Tiger.EventStore.Projections
09:41:13.252 2015-11-25T09:41:13 End install.ps1 Tiger.EventStore.Projections
09:41:13.256 --------------------------------------------------
09:41:13.256 1 CreateMyFilesProjectionMigration migrating
09:41:13.256 [+] To create projection $ce-myfiles
09:41:13.257 [+] Create projection $ce-myfiles with url http://localhost:2113/projections/continuous?name=$ce-myfiles&emit=yes&checkpoints=yes&enabled=yes
09:41:13.257 [+] 1 CreateMyFilesProjectionMigration migrated
09:41:13.257 --------------------------------------------------
09:41:13.257 --------------------------------------------------
09:41:13.258 2 EnableBuiltinProjectionByCategory migrating
09:41:13.258 [+] 2 EnableBuiltinProjectionByCategory migrated
09:41:13.258 --------------------------------------------------
09:41:13.258 --------------------------------------------------
09:41:13.259 3 CreateWorkRecordProjectionMigration migrating
09:41:13.259 [+] To create projection $ce-workrecord
09:41:13.259 [+] Create projection $ce-workrecord with url http://localhost:2113/projections/continuous?name=$ce-workrecord&emit=yes&checkpoints=yes&enabled=yes
09:41:13.259 [+] 3 CreateWorkRecordProjectionMigration migrated
09:41:13.260 --------------------------------------------------
09:41:14.118 2015-11-25T09:41:14 Start Install-NuPackage Tiger.Search.Indexer
09:41:14.152 11/25/2015 09:41:14: Downloading package [Tiger.Search.Indexer] from [http://10.18.7.148/nuget-server-integration] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:41:14.610 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install Tiger.Search.Indexer -version 1.0.0.206 -source http://10.18.7.148/nuget-server-integration -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:41:15.265 Package [Tiger.Search.Indexer] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\Tiger.Search.Indexer.1.0.0.206].
09:41:15.270 2015-11-25T09:41:15 Start install.ps1 Tiger.Search.Indexer
09:41:15.997 Start to copy C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\Tiger.Search.Indexer.1.0.0.206\target to C:\Services\TigerSearchIndexer-local
09:41:16.036 Service[TigerSearchIndexer-local] already exists,change BinaryPathName to C:\Services\TigerSearchIndexer-local\Tiger.Search.Indexer.exe
09:41:16.387 [SC] ChangeServiceConfig SUCCESS
09:41:17.114 Service started. 
09:41:17.120 2015-11-25T09:41:17 End install.ps1 Tiger.Search.Indexer
09:41:17.121 name                           TigerSearchIndexer-local                        
09:41:17.143 2015-11-25T09:41:17 Start Install-NuPackage TigerUIDB
09:41:17.166 11/25/2015 09:41:17: Downloading package [TigerUIDB] from [http://10.18.7.148/nuget-server-tmp] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:41:17.659 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install TigerUIDB -version 1.3.6289 -source http://10.18.7.148/nuget-server-tmp -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:41:18.274 Package [TigerUIDB] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUIDB.1.3.6289].
09:41:18.282 2015-11-25T09:41:18 Start install.ps1 TigerUIDB
09:41:18.405 2015-11-25T09:41:18 End install.ps1 TigerUIDB
09:41:18.453 2015-11-25T09:41:18 Start Install-NuPackage TigerAPI
09:41:18.476 11/25/2015 09:41:18: Downloading package [TigerAPI] from [http://10.18.7.148/nuget-server-tmp] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:41:18.972 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install TigerAPI -version 1.3.6289 -source http://10.18.7.148/nuget-server-tmp -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:41:22.340 Package [TigerAPI] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerAPI.1.3.6289].
09:41:22.350 2015-11-25T09:41:22 Start install.ps1 TigerAPI
09:41:22.938 features to be installed: [renew health-check]
09:41:22.943 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerAPI.1.3.6289\tools\deploy-website\health-check.ns.ps1] starts
09:41:22.957 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerAPI.1.3.6289\tools\deploy-website\health-check.ns.ps1] starts
09:41:22.968 
09:41:22.969 
09:41:22.969     Directory: C:\Users\ADMINI~1\AppData\Local\Temp\1
09:41:22.969 
09:41:22.969 
09:41:22.971 Mode                LastWriteTime     Length Name                              
09:41:22.972 ----                -------------     ------ ----                              
09:41:22.972 d----        11/25/2015   9:41 AM            635840412829620155                
09:41:22.973 
09:41:22.973 
09:41:23.879 Creatig new New-WebAppPool [TigerAPI-local]
09:41:23.967 User [TigerAPI-local] is ready.
09:41:28.246 Application pool [TigerAPI-local] is ready.
09:41:30.157 
09:41:30.163 Name             ID   State      Physical Path                  Bindings       
09:41:30.165 ----             --   -----      -------------                  --------       
09:41:30.180 TigerAPI-local   5    Started    C:\Users\ADMINI~1\AppData\Loca http *:10810:  
09:41:30.180                                  l\Temp\1\635840412829620155                   
09:41:30.181 
09:41:30.181 
09:41:34.597 WebAppPool[TigerAPI-local] stopped
09:41:38.470 WebAppPool[TigerAPI-local] started
09:41:38.630 Website [TigerAPI-local] is ready.
09:41:38.640 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerAPI.1.3.6289\tools\deploy-website\health-check.ns.ps1] ends
09:41:38.648 Source Package [ TigerAPI : 1.3.6289 ]
09:41:39.159 Target HealthCheckUrl: [http://localhost:10810/health?check=all]
09:41:39.277 >>>>>>>>>>>>> Step Get content from url[http://localhost:10810/health?check=all] started...
09:41:56.488 >>>>>>>>>>>>> Step Get content from url[http://localhost:10810/health?check=all] done. (17198.118 ms)
09:41:56.489 HealthCheckPage 
09:41:56.489 Name=TigerAPI
09:41:56.489 Version=1.3.6289
09:41:56.489 ServerName=RBK8N0M
09:41:56.489 Status=Success
09:41:56.489 
09:41:56.489 Dependencies:
09:41:56.489 EventStore=Success
09:41:56.490 ConsentService=Failure
09:41:56.490 TigerDB=Success
09:41:56.490 AccountService=Success
09:41:56.490 NotificationService=Failure
09:41:56.490 FileCabinetService=Failure
09:41:56.490 QuestionnaireService=Failure
09:41:56.500 WARNING: Health page reported there are some failures after the deployment!
09:41:56.501 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerAPI.1.3.6289\tools\deploy-website\health-check.ns.ps1] ends
09:42:00.365 2015-11-25T09:42:00 End install.ps1 TigerAPI
09:42:00.366 name                           TigerAPI-local                                  
09:42:00.366 bindings                       {protocol, bindingInformation}                  
09:42:00.722 2015-11-25T09:42:00 Start Install-NuPackage TigerUI
09:42:00.746 11/25/2015 09:42:00: Downloading package [TigerUI] from [http://10.18.7.148/nuget-server-tmp] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:42:01.180 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install TigerUI -version 1.3.6289 -source http://10.18.7.148/nuget-server-tmp -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:42:18.588 Package [TigerUI] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289].
09:42:18.594 2015-11-25T09:42:18 Start install.ps1 TigerUI
09:42:19.351 features to be installed: [change-hosts-file set-domain-name renew health-check]
09:42:19.359 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] starts
09:42:19.374 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] starts
09:42:19.386 
09:42:19.387 
09:42:19.387     Directory: C:\Users\ADMINI~1\AppData\Local\Temp\1
09:42:19.387 
09:42:19.387 
09:42:19.388 Mode                LastWriteTime     Length Name                              
09:42:19.389 ----                -------------     ------ ----                              
09:42:19.390 d----        11/25/2015   9:42 AM            635840413393783265                
09:42:19.390 
09:42:19.391 
09:42:21.553 Creatig new New-WebAppPool [TigerUI-local]
09:42:21.888 Creating new local user [TigerUI-local]
09:42:22.189 User [TigerUI-local] is ready.
09:42:27.207 Application pool [TigerUI-local] is ready.
09:42:29.821 
09:42:29.824 Name             ID   State      Physical Path                  Bindings       
09:42:29.826 ----             --   -----      -------------                  --------       
09:42:29.836 TigerUI-local    6    Started    C:\Users\ADMINI~1\AppData\Loca http *:10800:  
09:42:29.837                                  l\Temp\1\635840413393783265                   
09:42:29.837 
09:42:29.838 
09:42:29.843 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] starts
09:42:30.683 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] starts
09:42:34.614 WebAppPool[TigerUI-local] stopped
09:42:44.169 WebAppPool[TigerUI-local] started
09:42:44.380 Website [TigerUI-local] is ready.
09:42:44.382 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] ends
09:42:44.383 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] ends
09:42:44.387 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] ends
09:42:44.391 Source Package [ TigerUI : 1.3.6289 ]
09:42:44.957 Target HealthCheckUrl: [http://localhost:10800/health?check=all]
09:42:44.985 >>>>>>>>>>>>> Step Get content from url[http://localhost:10800/health?check=all] started...
09:42:49.044 >>>>>>>>>>>>> Step Get content from url[http://localhost:10800/health?check=all] done. (4055.4045 ms)
09:42:49.053 HealthCheckPage 
09:42:49.054 Name=TigerUI
09:42:49.054 Version=1.3.6289
09:42:49.054 ServerName=RBK8N0M
09:42:49.054 Status=Success
09:42:49.054 
09:42:49.055 Dependencies:
09:42:49.055 TigerAPI=Success
09:42:49.058 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\TigerUI.1.3.6289\tools\deploy-website\health-check.ns.ps1] ends
09:42:52.255 2015-11-25T09:42:52 End install.ps1 TigerUI
09:42:52.256 name                           TigerUI-local                                   
09:42:52.259 bindings                       {System.Collections.Hashtable, System.Collect...
09:42:52.782 2015-11-25T09:42:52 Start Install-NuPackage my-account
09:42:52.807 11/25/2015 09:42:52: Downloading package [my-account] from [http://10.18.7.148/nuget-server-integration] to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working]....
09:42:53.305 Executing: C:\go-agent\pipelines\Tiger.Core\tiger\build\tools\ps-gets\NScaffold.NuDeploy.0.0.115\tools\tools\nuget\nuget.exe install my-account -version 1.0.0.588 -source http://10.18.7.148/nuget-server-integration -OutputDirectory C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working 2>&1
09:42:54.171 Package [my-account] has been downloaded to [C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588].
09:42:54.179 2015-11-25T09:42:54 Start install.ps1 my-account
09:42:55.103 
09:42:55.103 
09:42:55.106 Name                        : demo-bridge
09:42:55.106 WantAuthnRequestSigned      : false
09:42:55.107 SignSAMLResponse            : true
09:42:55.107 SignAssertion               : false
09:42:55.107 EncryptAssertion            : false
09:42:55.107 AssertionConsumerServiceUrl : https://demo-bridge.pwc-tiger.com/login/callback
09:42:55.107 SingleLogoutServiceUrl      : 
09:42:55.108 CertificateFile             : pwc-test-public.crt
09:42:55.108 
09:42:55.110 Name                        : local-gsn-bridge
09:42:55.110 WantAuthnRequestSigned      : false
09:42:55.111 SignSAMLResponse            : true
09:42:55.111 SignAssertion               : false
09:42:55.111 EncryptAssertion            : false
09:42:55.111 AssertionConsumerServiceUrl : http://localhost/login/callback
09:42:55.111 SingleLogoutServiceUrl      : 
09:42:55.112 CertificateFile             : gsn-test-public.crt
09:42:55.112 
09:42:55.449 
09:42:55.449 
09:42:55.452 features to be installed: [change-hosts-file set-domain-name renew health-check]
09:42:55.460 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] starts
09:42:55.480 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] starts
09:42:55.495 
09:42:55.495 
09:42:55.496     Directory: C:\Users\ADMINI~1\AppData\Local\Temp\1
09:42:55.496 
09:42:55.496 
09:42:55.497 Mode                LastWriteTime     Length Name                              
09:42:55.498 ----                -------------     ------ ----                              
09:42:55.499 d----        11/25/2015   9:42 AM            635840413754863670                
09:42:55.499 
09:42:55.499 
09:42:58.344 User [my-account-local] is ready.
09:43:03.869 Application pool [my-account-local] is ready.
09:43:06.924 
09:43:06.928 Name             ID   State      Physical Path                  Bindings       
09:43:06.929 ----             --   -----      -------------                  --------       
09:43:06.939 my-account-local 7    Started    C:\Users\ADMINI~1\AppData\Loca http *:10700:  
09:43:06.939                                  l\Temp\1\635840413754863670                   
09:43:06.940 
09:43:06.940 
09:43:06.946 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] starts
09:43:07.312 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] starts
09:43:28.898 Website [my-account-local] is ready.
09:43:28.902 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] ends
09:43:28.906 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] ends
09:43:28.914 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] ends
09:43:28.925 Source Package [ my-account : 1.0.0.588 ]
09:43:29.655 Target HealthCheckUrl: [http://localhost:10700/health?check=all]
09:43:29.669 >>>>>>>>>>>>> Step Get content from url[http://localhost:10700/health?check=all] started...
09:43:36.957 >>>>>>>>>>>>> Step Get content from url[http://localhost:10700/health?check=all] done. (7285.6665 ms)
09:43:36.958 HealthCheckPage 
09:43:36.958 Name=my-account
09:43:36.959 Version=1.0.0.588
09:43:36.959 ServerName=RBK8N0M
09:43:36.959 Status=Success
09:43:36.959 
09:43:36.959 Dependencies:
09:43:36.959 TemplateService=Failure
09:43:36.959 ConsentService=Failure
09:43:36.959 NotificationService=Failure
09:43:36.959 AccountService=Success
09:43:36.959 MyMobilityPlatformAPI=Failure
09:43:36.964 WARNING: Health page reported there are some failures after the deployment!
09:43:36.966 install feature[C:\go-agent\pipelines\Tiger.Core\tiger\tmp\working\my-account.1.0.0.588\tools\deploy-website\health-check.ns.ps1] ends
09:43:41.738 2015-11-25T09:43:41 End install.ps1 my-account
09:43:41.742 name                           my-account-local                                
09:43:41.748 bindings                       {System.Collections.Hashtable, System.Collect...
09:43:42.636 source http://rubygems.org/ not present in cache
09:43:42.803 source https://ruby.taobao.org not present in cache
09:43:43.254 http://10.18.7.148:8808 added to sources
09:43:44.505 Successfully installed bundler-1.9.9
09:43:44.505 1 gem installed
09:43:47.950 Fetching source index from http://10.18.7.148:8808/
09:44:05.353 Resolving dependencies.........................
09:44:05.383 Using rake 0.8.7
09:44:05.565 
09:44:05.565 Gem::InstallError: i18n requires Ruby version >= 1.9.3.
09:44:05.565 An error occurred while installing i18n (0.7.0), and Bundler cannot continue.
09:44:05.565 Make sure that `gem install i18n -v '0.7.0'` succeeds before bundling.
09:44:10.150 Service http://localhost:10610 started.
09:44:14.191 Service http://localhost:10010 started.
09:44:18.236 Service http://localhost:10410 started.
09:44:22.285 Service http://localhost:11010 started.
09:44:26.333 Service http://localhost:10310 started.
09:44:30.369 Service http://localhost:16010 started.
09:44:30.422 
09:44:30.422 Build Succeeded!
09:44:30.423 
09:44:30.429 ----------------------------------------------------------------------
09:44:30.430 Build Time Report
09:44:30.430 ----------------------------------------------------------------------
09:44:30.481 Name                 Duration        
09:44:30.481 ----                 --------        
09:44:30.482 Deploy-RegressionEnv 00:07:13.4401584
09:44:30.482 Total:               00:07:14.4342884
09:44:30.507 
09:44:30.507 
09:44:31.146 [go] Current job status: passed.

09:44:31.362 [go] Start to create properties Tiger.Core/6289/Smoke-IE-By-Dispatching/4/deploy-regression on WIN-JHPGRBK8N0M [C:\go-agent]
09:44:31.362 [go] Start to upload Tiger.Core/6289/Smoke-IE-By-Dispatching/4/deploy-regression on WIN-JHPGRBK8N0M [C:\go-agent]
09:44:31.610 [go] Job completed Tiger.Core/6289/Smoke-IE-By-Dispatching/4/deploy-regression on WIN-JHPGRBK8N0M [C:\go-agent]
